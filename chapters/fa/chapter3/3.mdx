<FrameworkSwitchCourse {fw} />

<div dir="rtl">

# ฺฉูฺฉ ฺฉุฑุฏู ูุฏูโูุง ุจุง ุงุณุชูุงุฏู ุงุฒ API `Trainer`

<DocNotebookDropdown
  classNames="absolute z-10 right-0 top-0"
  options={[
    {label: "Google Colab", value: "https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter3/section3.ipynb"},
    {label: "Aws Studio", value: "https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/chapter3/section3.ipynb"},
]} />

<Youtube id="nvBXf7s7vTI"/>

ุชุฑูุณููุฑูุฑูุง ูุงฺฏูฺฏโููุณ ฺฉูุงุณ ุจู ูุงู `Trainer` ุฏุงุฑูุฏ ฺฉู ุจุฑุง ฺฉูฺฉ ุจู ฺฉูฺฉ ฺฉุฑุฏู ูุฑ ูุฏู ุงุฒ ูพุด ุชุนูู ุฏุฏูโุง ฺฉู ุฑู ุฏุงุฏู ุดูุง ุงุฑุงุฆู ูโุฏูุฏ ุจู ฺฉุงุฑ ูโุฑูุฏ. ุจู ูุญุถ ุงูฺฉู ููู ฺฉุงุฑูุง ูพุดโูพุฑุฏุงุฒุด ุฏุงุฏู ุฏุฑ ุจุฎุด ุขุฎุฑ ุฑุง ุงูุฌุงู ุฏุงุฏุฏุ ููุท ฺูุฏ ูุฑุญูู ุจุงูโูุงูุฏู ุชุง ุชุนุฑู `Trainer` ุฏุงุฑุฏ. ุณุฎุช ุชุฑู ูุณูุชุ ุงุญุชูุงูุง ุขูุงุฏูโุณุงุฒ ูุญุท ุฌูุช ุงุฌุฑุงู <span dir="ltr">`Trainer.train()`</span> ูโุจุงุดุฏุ ฺุฑุง ฺฉู ุงู ุชุงุจุน ุฑู CPU ุจุณุงุฑ ฺฉูุฏ ุงุฌุฑุง ูโุดูุฏ. ุงฺฏุฑ GPU ูุฏุงุฑุฏุ ูโุชูุงูุฏ ุงุฒ GPU ุง TPUูุง ูุฌุงู ุฑู [ฺฏูฺฏู ฺฉูููุจ](https://colab.research.google.com/) ุงุณุชูุงุฏู ฺฉูุฏ.

ููููู ฺฉุฏูุง ุฒุฑ ูุฑุถ ูโฺฉููุฏ ฺฉู ุดูุง ูุซุงูโูุง ุจุฎุด ูุจู ุฑุง ุงุฒ ูพุด ุงุฌุฑุง ฺฉุฑุฏูโุงุฏ. ุงู ฺฉ ุฎูุงุตู ฺฉูุชุงู ุงุณุช ุฌูุช ุงุฏุขูุฑ ุขูฺู ูุงุฒ ุฏุงุฑุฏ:


<div dir="ltr">

```py
from datasets import load_dataset
from transformers import AutoTokenizer, DataCollatorWithPadding

raw_datasets = load_dataset("glue", "mrpc")
checkpoint = "bert-base-uncased"
tokenizer = AutoTokenizer.from_pretrained(checkpoint)


def tokenize_function(example):
    return tokenizer(example["sentence1"], example["sentence2"], truncation=True)


tokenized_datasets = raw_datasets.map(tokenize_function, batched=True)
data_collator = DataCollatorWithPadding(tokenizer=tokenizer)
```

</div>

### ุชุนูู

ูุจู ุงุฒ ุงู ฺฉู ุจุชูุงูู `Trainer` ูุงู ุฑุง ุชุนุฑู ฺฉูู ุงููู ูุฑุญูู ุชุนุฑู ฺฉูุงุณ `TrainingArguments` ูโุจุงุดุฏ ฺฉู ุดุงูู ููู ูพุงุฑุงูุชุฑูุง ุณุทุญ ุจุงูุง ุงุณุช ฺฉู `Trainer` ุจุฑุง `Training` ู `Evaluation` ุงุณุชูุงุฏู ุฎูุงูุฏ ฺฉุฑุฏ. ุชููุง ุขุฑฺฏููุงู ฺฉู ุดูุง ุจุงุฏ ุงุฑุงุฆู ฺฉูุฏ ุขุฏุฑุณ ุงุณุช ฺฉู ูุฏู ุชุนูู ุฏุฏู ุจู ููุฑุงู ููุงุท ุชุนูู ุฏุฑ ุขู ุฐุฎุฑู ุฎูุงููุฏ ุดุฏ. ุจูู ูพุงุฑุงูุชุฑูุง ุฑุง ูโุชูุงูุฏ ุจู ุญุงูุช ูพุดโูุฑุถ ุฑูุง ฺฉูุฏุ ฺฉู ุจุฑุง ฺฉูฺฉ ฺฉุฑุฏู ูพุงู ุจู ุฎูุจ ฺฉุงุฑ ุฎูุงูุฏ ฺฉุฑุฏ. 


<div dir="ltr">

```py
from transformers import TrainingArguments

training_args = TrainingArguments("test-trainer")
```

</div>

<Tip>

๐ก ุงฺฏุฑ ูุงูุฏ ูุฏูโุชุงู ุฑุง ุจู ุตูุฑุช ุฎูุฏฺฉุงุฑ ุฏุฑ ุญู ุชุนูู ุฏุฑ ูุงุจ ุจุงุฑฺฏุฐุงุฑ ฺฉูุฏุ ูพุงุฑุงูุชุฑ `push_to_hub=True` ุฑุง ุฏุฑ `TrainingArguments` ุงุฑุณุงู ฺฉูุฏ. ุฏุฑ [ูุตู ด](/course/chapter4/3) ุฏุฑ ุงู ุจุงุฑู ุจุดุชุฑ ุฎูุงูู ุขููุฎุช.

</Tip>

ูุฑุญูู ุฏูู ุชุนุฑู ูุฏูโูุงู ูโุจุงุดุฏ. ูุงููุฏ [ูุตู ูุจู](/course/chapter2)ุ ุงุฒ ฺฉูุงุณ `AutoModelForSequenceClassification` ุจุง ุฏู ุจุฑฺุณุจ ฺฉูุงุณ ุงุณุชูุงุฏู ุฎูุงูู ฺฉุฑุฏ:

<div dir="ltr">

```py
from transformers import AutoModelForSequenceClassification

model = AutoModelForSequenceClassification.from_pretrained(checkpoint, num_labels=2)
```

</div>

ุดูุง ูุชูุฌู ุฎูุงูุฏ ุดุฏ ฺฉู ุจุฑุฎูุงู [ูุตู ฒ](/course/chapter2)ุ ุจุนุฏ ุงุฒ ุณุงุฎุชู ุงู ูุฏู ุงุฒ ูพุดโ ุชุนูู ุฏุฏู ฺฉ ูุดุฏุงุฑ ุฏุฑุงูุช ูโฺฉูุฏ. ุงู ุจู ุงู ุฎุงุทุฑ ุงุณุช ฺฉู BERT ุจุฑุง ุฏุณุชูโุจูุฏ ุฏู ุฌูููโูุง ุงุฒ ูพุดโ ุชุนูู ูุฏุฏู ุงุณุชุ ุจูุงุจุฑุงู ูุงู ุณูุฑ ูุฏู ุงุฒ ูพุดโ ุชุนูู ุฏุฏู ุญุฐู ุดุฏู ู ฺฉ ูุงู ุณูุฑ ููุงุณุจ ุฌูุช ุฏุณุชู ุจูุฏ ุฑุดุชูโโโูุง ุจู ุฌุง ุขู ูุฑุงุฑ ฺฏุฑูุชู ุงุณุช. ูุดุฏุงุฑูุง ูุดุงู ูโุฏููุฏ ฺฉู ุจุฑุฎ ุงุฒ ูุฒูโูุง ูุฏู ุงุณุชูุงุฏู ูุดุฏูโุงูุฏ (ุขููุง ฺฉู ูุฑุจูุท ุจู ูุงูโ ุณูุฑ ุญุฐู ุดุฏู ูุฏู ุงุฒ ูพุด ุชุนูู ุฏุฏู ูุณุชูุฏ) ู ุจุฑุฎ ุฏฺฏุฑ ุจู ุตูุฑุช ุชุตุงุฏู ููุฏุงุฑโ ุฏู ุดุฏูโโุงูุฏ (ุขููุง ฺฉู ูุฑุจูุท ุจู ูุงูโ ุณูุฑ ุฌุฏุฏ ูุณุชูุฏ). ุฏุฑ ูุชุฌู ุงู ุงูุฑ ุดูุง ุฑุง ุชุดูู ุจู ุชุนูู ูุฏู ูโฺฉูุฏุ ฺฉู ุฏููุง ููุงู ฺฉุงุฑ ุงุณุช ฺฉู ูโุฎูุงูู ุงฺฉููู ุงูุฌุงู ุฏูู.

ุจู ูุญุถ ุงูฺฉู ูุฏูโูุงู ูุดุฎุต ุดุฏ ูโุชูุงูู `Trainer` ุฑุง ุจุง ุงุฑุณุงู ููู ุงุดุงุฆ ฺฉู ุชุง ฺฉููู ุณุงุฎุชู ุดุฏูโุงูุฏ - <span dir="ltr">`model`</span>ุ <span dir="ltr">`training_args`</span>ุ ุฏุชุงุณูุชโูุง <span dir="ltr">`training`</span> ู <span dir="ltr">`validation`</span>ุ <span dir="ltr">`data_collator`</span> ู <span dir="ltr">`tokenizer`</span> ุจู ุฏุงุฎู ุขู ุชุนุฑู ฺฉูู:

<div dir="ltr">

```py
from transformers import Trainer

trainer = Trainer(
    model,
    training_args,
    train_dataset=tokenized_datasets["train"],
    eval_dataset=tokenized_datasets["validation"],
    data_collator=data_collator,
    tokenizer=tokenizer,
)
```

</div>

ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ุฒูุงู ฺฉู `tokenizer` ุฑุง ุงุฑุณุงู ูโฺฉูุฏุ ูุซู ฺฉุงุฑ ฺฉู ูุง ุฏุฑ ุงูุฌุง ุงูุฌุงู ุฏุงุฏูุ `data_collator` ูพุดโูุฑุถ ููุฑุฏ ุงุณุชูุงุฏู `Trainer`ุ ููุงูุทูุฑ ฺฉู ูุจูุง ุชุนุฑู ฺฉุฑุฏูุ `DataCollatorWithPadding` ุฎูุงูุฏ ุจูุฏุ ุฏุฑ ุชูุฌู ุดูุง ูโุชูุงูุฏ ุฎุท `data_collator=data_collator` ุฑุง ุฏุฑ ุงู ูุฑุงุฎูุงู ูุงุฏุฏู ุจฺฏุฑุฏ. ุงู ูููุฒ ููู ุจูุฏ ฺฉู ุงู ุจุฎุด ุงุฒ ูพุฑุฏุงุฒุด ุฑุง ุฏุฑ ุจุฎุด ฒ ุจู ุดูุง ูุดุงู ุฏูู!

ุจุฑุง ฺฉูฺฉ ฺฉุฑุฏู ูุฏู ุฑู ุฏุชุงุณูุชโูุงู ูุง ููุท ุจุงุฏ ุชุงุจุน <span dir="ltr">`train()`</span> ุงุฒ `Trainer`ูุงู ุฑุง ุตุฏุง ุจุฒูู:

<div dir="ltr">

```py
trainer.train()
```

</div>

ุงู ฺฉุงุฑุ ฺฉูฺฉ ฺฉุฑุฏู ุฑุง ุดุฑูุน ูโฺฉูุฏ (ฺฉู ุจุงุฏ ฺูุฏ ุฏููู ุฑู GPU ุทูู ุจฺฉุดุฏ) ู ูุฒูู ุชุนูู ุฑุง ูุฑ ตฐฐ ูุฑุญูู ฺฉโุจุงุฑ ฺฏุฒุงุฑุด ูโฺฉูุฏ. ุจุง ุงู ุญุงู ุจู ุดูุง ููโฺฏูุฏ ฺฉู ูุฏูโุชุงู ฺูุฏุฑ ุฎูุจ (ุง ุจุฏ) ุนูู ูโฺฉูุฏ. ุงู ุจู ุงู ุฎุงุทุฑ ุงุณุช ฺฉู:

ฑ. ูุง ุจู `Trainer` ูฺฏูุชู ฺฉู ุฏุฑ ุญู ุชุนูู ฺฉูุช ูุฏู ุฑุง ุงูุฏุงุฒูโฺฏุฑ ฺฉูุฏ. ฺฉุงุฑ ฺฉู ูโุชูุงูุณุชู ุจุง ููุฏุงุฑุฏู ูพุงุฑุงูุชุฑ `evaluation_strategy` ุจู `"steps"` (ุจุฑุง ุงุฑุฒุงุจ ุฏุฑ ูุฑ `eval_steps`) ุง ุจู `"epoch"` (ุจุฑุง ุงุฑุฒุงุจ ุฏุฑ ุงูุชูุง ูุฑ epoch) ุงูุฌุงู ุฏูู.

ฒ. ูุง ุชุงุจุน <span dir="ltr">`compute_metrics()`</span> ุฑุง ุจุฑุง `Trainer` ูุฑุงูู ูฺฉุฑุฏู ุชุง ุจุชูุงูุฏ ูุนุงุฑูุง ุฑุง ุฏุฑ ุญู ุงุตุทูุงุญุง ุงุฑุฒุงุจ ูุญุงุณุจู ฺฉูุฏ (ฺฉู ุฏุฑ ุบุฑ ุงู ุตูุฑุชุ ุงุฑุฒุงุจ ููุท ูุฒูู ุฑุง ฺุงูพ ูโฺฉูุฏ ฺฉู ุนุฏุฏ ฺูุฏุงู ฺฏูุง ูู ูุณุช) .

### ุงุฑุฒุงุจ

ุงุฌุงุฒู ุฏูุฏ ุจุจูู ฺฺฏููู ูโุชูุงูู ุชุงุจุน <span dir="ltr">`compute_metrics()`</span> ููุฏ ุจุณุงุฒู ู ุฏุฑ ุชุนูู ุจุนุฏ ุงุฒ ุขู ุงุณุชูุงุฏู ฺฉูู. ุชุงุจุน ุจุงุฏ ฺฉ ุดุก `EvalPrediction` ุฏุฑุงูุช ฺฉูุฏ (ฺฉู ุชุงูพู ุงุณุช ุดุงูู ููุฏูุง `predictions` ู `label_ids`) ู ฺฉ ุฏฺฉุดูุฑ ุจุงุฒ ฺฏุฑุฏุงูุฏ ฺฉู ุฑุดุชูโูุง ูุชู ุฑุง ุจู ุงุนุฏุงุฏ ุญูู ุชุจุฏู ูโฺฉูุฏ (ุฑุดุชูโูุง ูุชู ูุงู ูุนุงุฑูุง ุจุงุฒฺฏุฑุฏุงูุฏู ุดููุฏู ู ุงุนุฏุงุฏ ุญูู ููุงุฏุฑ ุขูโูุง ู ุจุงุดูุฏ). ุจุฑุง ุงุณุชุฎุฑุงุฌ ฺูุฏ ูพุดโุจูโ ุงุฒ ูุฏูโูุงูุ ูโุชูุงูู ุงุฒ ุฏุณุชูุฑ <span dir="ltr">`Trainer.predict()`</span> ุงุณุชูุงุฏู ฺฉูู:

<div dir="ltr">

```py
predictions = trainer.predict(tokenized_datasets["validation"])
print(predictions.predictions.shape, predictions.label_ids.shape)
```

```python out
(408, 2) (408,)
```

</div>

ุฎุฑูุฌ ุชุงุจุน <span dir="ltr">`predict()`</span> ุชุงูพู ูุงู ฺฏุฐุงุฑ ุดุฏู ุฏฺฏุฑ ุดุงูู ุณู ููุฏ: `predictions`ุ `label_ids` ู `metrics` ูโุจุงุดุฏ. ููุฏ `metrics` ููุท ุดุงูู ูุฒูู ุฏุงุฏู ุนุจูุฑ ฺฉุฑุฏู ู ุจุฑุฎ ูุนุงุฑูุง ุฒูุงู (ูพุดโุจูโุ ุฏุฑ ูุฌููุน ู ุจู ุทูุฑ ูุงูฺฏูุ ฺูุฏุฑ ุทูู ฺฉุดุฏู) ูโุจุงุดุฏ. ุจู ูุญุถ ุงู ฺฉู ุชุงุจุน <span dir="ltr">`compute_metrics()`</span> ุฑุง ฺฉุงูู ฺฉุฑุฏู ู ุขู ุฑุง ุจู `Trainer` ุงุฑุณุงู ฺฉููุ ุขู ููุฏ ูุชุฑฺฉโูุง ุจุงุฒฺฏุดุช ุงุฒ <span dir="ltr">`compute_metrics()`</span> ุฑุง ูุฒ ุฏุฑ ุจุฑ ุฎูุงูุฏ ุฏุงุดุช.

ููุงูุทูุฑ ฺฉู ูโุจูุฏุ `predictions` ุขุฑุงูโุง ุฏู ุจุนุฏ ุงุณุช ุจุง ุดฺฉู <span dir="ltr">ดฐธ x ฒ</span> (ฺฉู ดฐธ ุชุนุฏุงุฏ ุนูุงุตุฑ ุฏุฑ ุฏุชุงุณูุช ููุฑุฏ ุงุณุชูุงุฏูโ ูุง ูโุจุงุดุฏ). ุงู ูุง logits ูุฑุจูุท ุจู ูุฑฺฉ ุงุฒ ุนูุงุตุฑ ุฏุชุงุณูุช ูุณุชูุฏ ฺฉู ูุง ุจู ุชุงุจุน <span dir="ltr">`predict()`</span> ุงุฑุณุงู ฺฉุฑุฏู (ููุงูุทูุฑ ฺฉู ุฏุฑ [ูุตู ูุจู](/course/chapter2) ุฏุฏุฏุ ููู ูุฏูโูุง ุชุฑููุณููุฑููุฑ logits ุฑุง ุจุงุฒ ูโฺฏุฑุฏุงููุฏ). ุจุฑุง ุชุจุฏู logits ุจู ูพุดโุจูโโูุง ฺฉู ุจุชูุงูู ุจุง ุจุฑฺุณุจโูุงูุงู ููุงุณู ฺฉููุ ูุงุฒ ุฏุงุฑู ุงูุฏุณ ููุฏุงุฑ ุจุดูู ุฑู ุจุนุฏ ุฏูู ุฑุง ุจุฑุฏุงุฑู: 

<div dir="ltr">

```py
import numpy as np

preds = np.argmax(predictions.predictions, axis=-1)
```

</div>

ุงฺฉููู ูโุชูุงูู `preds` ุฑุง ุจุง ุจุฑฺุณุจโูุง ููุงุณู ฺฉูู. ุจุฑุง ุณุงุฎุชู ุชุงุจุน <span dir="ltr">`compute_metric()`</span>ุ ุจู ูุชุฑฺฉโูุง ฺฉุชุงุจุฎุงูู ุฏุงุฏูโูุง ูุงฺฏูฺฏโููุณ ุชฺฉู ุฎูุงูู ฺฉุฑุฏ. ูุง ูโุชูุงูู ูุชุฑฺฉโูุง ูุงุจุณุชู ุจู ุฏุชุงุณูุช MRPC ุฑุง ุจู ุฑุงุญุช ุฎูุฏ ุฏุชุงุณูุชุ ุงูุง ุงู ุจุงุฑ ุจุง ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน <span dir="ltr">`load_metric()`</span>ุ ุจุงุฑฺฏุฐุงุฑ ฺฉูู. ุดุก ุจุงุฒฺฏุฑุฏุงูุฏู ุดุฏู ุชุงุจุน ุจู ูุงู <span dir="ltr">`compute()`</span> ุฏุงุฑุฏ ฺฉู ูโุชูุงูู ุจุฑุง ูุญุงุณุจู ูุชุฑฺฉ ุงุฒ ุขู ุงุณุชูุงุฏู ฺฉูู:

<div dir="ltr">

```py
from datasets import load_metric

metric = load_metric("glue", "mrpc")
metric.compute(predictions=preds, references=predictions.label_ids)
```

```python out
{'accuracy': 0.8578431372549019, 'f1': 0.8996539792387542}
```

</div>

ุงุฒ ุขูุฌุง ฺฉู ููุฏุงุฑุฏู ุชุตุงุฏู ุงููู ูุฏู ูโุชูุงูุฏ ูุชุฑฺฉโูุง ููุง ุฑุง ุชุบุฑ ุฏูุฏุ ูุชุงุฌ ุฏูู ฺฉู ุดูุง ุจุฏุณุช ูโุขูุฑุฏ ููฺฉู ุงุณุช ูุชูุงูุช ุจุงุดุฏ. ุฏุฑ ุงูุฌุง ูโุชูุงูู ุจุจูู ฺฉู ูุฏู ูุง `accuracy` ูุนุงุฏู ธต.ทธูช ู `F1 Score` ูุนุงุฏู ธน.นทูช ุฑู ูุฌููุนู `validation` ุจุฏุณุช ูโุขูุฑุฏ. ุขููุง ุฏู ูุชุฑฺฉ ุจุฑุง ุงุฑุฒุงุจ ูุชุงุฌ ูุญฺฉ GLUE ุฑู ุฏุชุงุณูุช MRPC ูุณุชูุฏ. ุฌุฏูู ูุชุงุฌ ุฏุฑ ููุงูู [BERT](https://arxiv.org/pdf/1810.04805.pdf)ุ ุจุฑุง ูุฏู ูพุงูุ  `F1 Score` ูุนุงุฏู ธธ.น ุฑุง ฺฏุฒุงุฑุด ูโฺฉูุฏ. ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ุขู ูุฏู `uncased` ุจูุฏุ ุญุงู ุขู ฺฉู ุฏุฑ ุงูุฌุง ูุง ุงุฒ ูุฏู `cased` ุงุณุชูุงุฏู ูโฺฉููุ ฺฉู ุฏุณุชุงุจ ุจู ูุชุงุฌ ุจูุชุฑ ุฑุง ุชูุถุญ ูโุฏูุฏ.

ุงฺฉููู ุจุง ูุฑุงุฑ ุฏุงุฏู ููู ฺุฒ ฺฉูุงุฑูู ุชุงุจุน <span dir="ltr">`compute_metrics()`</span> ุฑุง ุจุฏุณุช ุฎูุงูู ุขูุฑุฏ:

<div dir="ltr">

```py
def compute_metrics(eval_preds):
    metric = load_metric("glue", "mrpc")
    logits, labels = eval_preds
    predictions = np.argmax(logits, axis=-1)
    return metric.compute(predictions=predictions, references=labels)
```

</div>

ู ุฏุฑ ุงูุฌุง ูุดุงู ูโุฏูู ฺฉู ฺฺฏููู ฺฉ `Trainer` ุฌุฏุฏ ุจุง ุงุณุชูุงุฏู ุงุฒ ุชุงุจุน <span dir="ltr">`compute_metrics()`</span> ุชุนุฑู ูโฺฉููุ ุชุง ุจุชูุงูู ุนููฺฉุฑุฏ ุขู ุฑุง ุฏุฑ ุญู ฺฏุฒุงุฑุด ูุชุฑฺฉโูุง ุฏุฑ ูพุงุงู ูุฑ epoch ูุดุงูุฏู ฺฉูู:  

<div dir="ltr">

```py
training_args = TrainingArguments("test-trainer", evaluation_strategy="epoch")
model = AutoModelForSequenceClassification.from_pretrained(checkpoint, num_labels=2)

trainer = Trainer(
    model,
    training_args,
    train_dataset=tokenized_datasets["train"],
    eval_dataset=tokenized_datasets["validation"],
    data_collator=data_collator,
    tokenizer=tokenizer,
    compute_metrics=compute_metrics,
)
```

</div>

ุชูุฌู ุฏุงุดุชู ุจุงุดุฏ ฺฉู ูุง ูุฏู ุฌุฏุฏ ู `TrainingArguments` ุฌุฏุฏ ฺฉู `evaluation_strategy` ุขู `"epoch"` ุงุณุช ูโุณุงุฒู - ุฏุฑ ุบุฑ ุงู ุตูุฑุช ููุท ุชุนูู ูุฏู ฺฉู ุงุฒ ูพุด ุชุนูู ุฏุฏู ุจูุฏ ุฑุง ุงุฏุงูู ูโุฏุงุฏู. ุจุฑุง ุฑุงูโุงูุฏุงุฒ ุฏูุฑ ุฌุฏุฏ ุชุนููุ ุฏุณุชูุฑ ุฒุฑ ุฑุง ุงุฌุฑุง ูโฺฉูู:

<div dir="ltr">

```
trainer.train()
```

</div>

ุงู ุจุงุฑ ูุฒูู validation ู ูุชุฑฺฉโูุง ุฑุง ุฏุฑ ูพุงุงู ูุฑ epoch ู ุฏุฑ ุจุงูุง ูุฒูู ุชุนูู ฺฏุฒุงุฑุด ูโฺฉูู. ุฏูุจุงุฑูุ ุจู ุฎุงุทุฑ ููุฏุงุฑ ุฏู ุชุตุงุฏู ุงููู ูุงู ุณุฑ ูุฏูุ ููุงุฏุฑ ุฏูู <span dir="ltr">accuracy/F1 score</span> ฺฉู ุดูุง ุจุฏุณุช ูโุขูุฑุฏ ููฺฉู ุงุณุช ฺฉู ูุชูุงูุช ุงุฒ ุขูฺู ูุง ุจุฏุณุช ุขูุฑุฏูโุงู ุจุงุดุฏุ ุงูุง ุงู ููุงุฏุฑ ุจุงุฏ ุฏุฑ ูุญุฏูุฏู ุชุฎูู ฺฉุณุงู ุจุงุดูุฏ.  

ุจู ุตูุฑุช ูพุด ูุฑุถุ `Trainer` ุฑู ฺูุฏู GPU ุง TPU ฺฉุงุฑ ุฎูุงูุฏ ฺฉุฑุฏ ู ฺฏุฒููโูุง ูุฑุงูุงูุ ูุซู ุชุนูู mixed-precision (ุงุฒ ููุฏุงุฑ `fp16 = True` ุฏุฑ ุขุฑฺฏููุงูโูุง ุชุนูู ุงุณุชูุงุฏู ฺฉูุฏ) ูุฑุงูู ูโฺฉูุฏ. ุฏุฑ ูุตู ฑฐ ููู ุญุงูุชโูุง ฺฉู ูพุดุชุจุงู ูโฺฉูุฏ ุฑุง ูุฑูุฑ ุฎูุงูู ฺฉุฑุฏ. 

ุงู ูพุงุงู ููุฏููโุง ุจุฑ ฺฉูฺฉ ฺฉุฑุฏู ุจุง ุงุณุชูุงุฏู ุงุฒ `Trainer` API ูโุจุงุดุฏ. ุฏุฑ [ูุตู ท](/course/chapter7) ูุซุงู ุจุฑุง ูุดุงู ุฏุงุฏู ฺฺฏููฺฏ ุงูุฌุงู ุงู ฺฉุงุฑ ุจุฑุง ูุนูููโุชุฑู ูุณุฆููโูุง NLP ุงุฑุงุฆู ุฎูุงูู ฺฉุฑุฏุ ุงูุง ุงฺฉููู ุงุฌุงุฒู ุฏูุฏ ุจุจูู ฺฺฏููู ููู ฺฉุงุฑ ุฑุง ุตุฑูุง ุจุง ุงุณุชูุงุฏู ุงุฒ PyTorch ุงูุฌุงู ุฏูู. 

<Tip>

โ๏ธ **ุงุชุญุงู ฺฉูุฏ!** ุจุง ุงุณุชูุงุฏู ุงุฒ ูพุฑุฏุงุฒุด ุฏุงุฏูโุง ฺฉู ุฏุฑ ุจุฎุด ฒ ุงูุฌุงู ุฏุงุฏุฏุ ูุฏู ุฑุง ุฑู ุฏุชุงุณูุช GLUE SST-2 ฺฉูฺฉ ฺฉูุฏ.

</Tip>

</div>