# Big data? ü§ó Datasets —Å–ø–µ—à–∞—Ç –Ω–∞ –ø–æ–º–æ—â—å!

<CourseFloatingBanner chapter={5}
  classNames="absolute z-10 right-0 top-0"
  notebooks={[
    {label: "Google Colab", value: "https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/en/chapter5/section4.ipynb"},
    {label: "Aws Studio", value: "https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/en/chapter5/section4.ipynb"},
]} />

–í –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –Ω–µ—Ä–µ–¥–∫–æ –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —Å –º–Ω–æ–≥–æ–≥–∏–≥–∞–±–∞–π—Ç–Ω—ã–º–∏ –Ω–∞–±–æ—Ä–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö, –æ—Å–æ–±–µ–Ω–Ω–æ –µ—Å–ª–∏ –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–∏—Ç—å —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä, —Ç–∞–∫–æ–π –∫–∞–∫ BERT –∏–ª–∏ GPT-2, —Å –Ω—É–ª—è. –í —ç—Ç–∏—Ö —Å–ª—É—á–∞—è—Ö –¥–∞–∂–µ _–∑–∞–≥—Ä—É–∑–∫–∞_ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –ø—Ä–æ–±–ª–µ–º–æ–π. –ù–∞–ø—Ä–∏–º–µ—Ä, –∫–æ—Ä–ø—É—Å WebText, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–∏—è GPT-2, —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –±–æ–ª–µ–µ —á–µ–º 8 –º–∏–ª–ª–∏–æ–Ω–æ–≤ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ 40 –ì–ë —Ç–µ–∫—Å—Ç–∞ ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —ç—Ç–æ–≥–æ –≤ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–º—è—Ç—å –≤–∞—à–µ–≥–æ –Ω–æ—É—Ç–±—É–∫–∞ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Å–µ—Ä–¥–µ—á–Ω–æ–º—É –ø—Ä–∏—Å—Ç—É–ø—É!

–ö —Å—á–∞—Å—Ç—å—é, ü§ó Datasets —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∞ —Ç–∞–∫, —á—Ç–æ –ø–æ–∑–≤–æ–ª–∏—Ç –∏–∑–±–µ–∂–∞—Ç—å —Ç–∞–∫–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –∏–∑–±–∞–≤–ª—è–µ—Ç –≤–∞—Å –æ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —É–ø—Ä–∞–≤–ª—è—Ç—å –ø–∞–º—è—Ç—å—é –∏ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç –¥–∞—Ç–∞—Å–µ—Ç—ã –∫–∞–∫ [—Ñ–∞–π–ª—ã, –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º—ã–µ –≤ –ø–∞–º—è—Ç—å](https://habr.com/ru/post/55716/) (memory-mapped files, MMF), —Ç–∞–∫–∂–µ –æ–±—Ö–æ–¥–∏—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∂–µ—Å—Ç–∫–∏—Ö –¥–∏—Å–∫–æ–≤ –ø—É—Ç–µ–º —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤ –∑–∞–ø–∏—Å–µ–π –∏–∑ –∫–æ—Ä–ø—É—Å–∞ —Ç–µ–∫—Å—Ç–æ–≤. 

<Youtube id="JwISwTCPPWo"/>

–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —ç—Ç–∏ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ ü§ó Datasets —Å –æ–≥—Ä–æ–º–Ω—ã–º –∫–æ—Ä–ø—É—Å–æ–º –æ–±—ä–µ–º–æ–º 825 –ì–ë, –∏–∑–≤–µ—Å—Ç–Ω—ã–º –∫–∞–∫ [Pile] (https://pile.eleuther.ai). –î–∞–≤–∞–π—Ç–µ –Ω–∞—á–Ω–µ–º!

## –ß—Ç–æ —Ç–∞–∫–æ–µ the Pile?

The Pile ‚Äî —ç—Ç–æ –∫–æ—Ä–ø—É—Å —Ç–µ–∫—Å—Ç–æ–≤ –Ω–∞ –∞–Ω–≥–ª–∏–π—Å–∫–æ–º —è–∑—ã–∫–µ, —Å–æ–∑–¥–∞–Ω–Ω—ã–π [EleutherAI] (https://www.eleuther.ai) –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∫—Ä—É–ø–Ω–æ–º–∞—Å—à—Ç–∞–±–Ω—ã—Ö —è–∑—ã–∫–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π. –û–Ω –≤–∫–ª—é—á–∞–µ—Ç –≤ —Å–µ–±—è —à–∏—Ä–æ–∫–∏–π —Å–ø–µ–∫—Ç—Ä –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö, –≤–∫–ª—é—á–∞—è –Ω–∞—É—á–Ω—ã–µ —Å—Ç–∞—Ç—å–∏, —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –∫–æ–¥–∞ GitHub –∏ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–µ–±-—Ç–µ–∫—Å—Ç. –£—á–µ–±–Ω—ã–π –∫–æ—Ä–ø—É—Å –¥–æ—Å—Ç—É–ø–µ–Ω –≤ –≤–∏–¥–µ [—Ñ—Ä–∞–≥–º–µ–Ω—Ç–æ–≤ –ø–æ 14 –ì–ë] (https://mystic.the-eye.eu/public/AI/pile/), –∏ –≤—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ [–æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤] (https://mystic .the-eye.eu/public/AI/pile_preliminary_components/). –ù–∞—á–Ω–µ–º —Å –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö PubMed Abstracts, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —Å–≤–æ–¥ –∞–Ω–Ω–æ—Ç–∞—Ü–∏–π –∏–∑ 15 –º–∏–ª–ª–∏–æ–Ω–æ–≤ –±–∏–æ–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –ø—É–±–ª–∏–∫–∞—Ü–∏–π –≤ [PubMed] (https://pubmed.ncbi.nlm.nih.gov/). –ù–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ [—Ñ–æ—Ä–º–∞—Ç–µ JSON Lines] (https://jsonlines.org) –∏ —Å–∂–∞—Ç —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ `zstandard`, –ø–æ—ç—Ç–æ–º—É —Å–Ω–∞—á–∞–ª–∞ –Ω–∞–º –Ω—É–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É `zstandart`:

```py
!pip install zstandard
```

–ó–∞—Ç–µ–º –º—ã –º–æ–∂–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É—è –º–µ—Ç–æ–¥ –¥–ª—è –ø–æ–¥–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –º—ã –∏–∑—É—á–∏–ª–∏ –≤ [—Ä–∞–∑–¥–µ–ª–µ 2](../chapter5/2):

```py
from datasets import load_dataset

# –≠—Ç–æ–π –∑–∞–π–º–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–∏–Ω—É—Ç, –ø–æ–∫–∞ –æ–∂–∏–¥–∞–µ—Ç–µ ‚Äì —Å–¥–µ–ª–∞–π—Ç–µ –∫–æ—Ñ–µ –∏–ª–∏ —á–∞–π :)
data_files = "https://mystic.the-eye.eu/public/AI/pile_preliminary_components/PUBMED_title_abstracts_2019_baseline.jsonl.zst"
pubmed_dataset = load_dataset("json", data_files=data_files, split="train")
pubmed_dataset
```

```python out
Dataset({
    features: ['meta', 'text'],
    num_rows: 15518009
})
```

–ú—ã –≤–∏–¥–∏–º, —á—Ç–æ –≤ –Ω–∞—à–µ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö 15¬†518¬†009 —Å—Ç—Ä–æ–∫ –∏ 2 —Å—Ç–æ–ª–±—Ü–∞ ‚Äî —ç—Ç–æ –æ—á–µ–Ω—å –º–Ω–æ–≥–æ!

<Tip>

‚úé –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é ü§ó Datasets —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç —Ñ–∞–π–ª—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö. –ï—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–µ—Å—Ç–æ –Ω–∞ –∂–µ—Å—Ç–∫–æ–º –¥–∏—Å–∫–µ, –≤—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–¥–∞—Ç—å `DownloadConfig(delete_extracted=True)` –≤ –∞—Ä–≥—É–º–µ–Ω—Ç `download_config` —Ñ—É–Ω–∫—Ü–∏–∏ `load_dataset()`. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–≤–µ–¥–µ–Ω–∏—è —Å–º. –≤ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏](https://huggingface.co/docs/datasets/package_reference/builder_classes#datasets.DownloadConfig).

</Tip>

–î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –ø–µ—Ä–≤–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞: 

```py
pubmed_dataset[0]
```

```python out
{'meta': {'pmid': 11409574, 'language': 'eng'},
 'text': 'Epidemiology of hypoxaemia in children with acute lower respiratory infection.\nTo determine the prevalence of hypoxaemia in children aged under 5 years suffering acute lower respiratory infections (ALRI), the risk factors for hypoxaemia in children under 5 years of age with ALRI, and the association of hypoxaemia with an increased risk of dying in children of the same age ...'}
```

–û—Ç–ª–∏—á–Ω–æ, –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π —Å—Ç–∞—Ç—å–∏. –¢–µ–ø–µ—Ä—å –¥–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –æ–±—ä–µ–º –ø–∞–º—è—Ç–∏, –∫–æ—Ç–æ—Ä—ã–π –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö:

## –ú–∞–≥–∏—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –ø–∞–º—è—Ç—å

–ü—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –∏–∑–º–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ –≤ Python ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–±–ª–∏–æ—Ç–µ–∫—É [`psutil`](https://psutil.readthedocs.io/en/latest/), –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Å –ø–æ–º–æ—â—å—é `pip` —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```python
!pip install psutil
```

–û–Ω–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∫–ª–∞—Å—Å Process, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏ —Ç–µ–∫—É—â–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```py
import psutil

# Process.memory_info –≤–æ–≤–∑—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–º –≤ –±–∞–π—Ç–∞—Ö, –º—ã –ø–µ—Ä–µ—Å—á–∏—Ç–∞–µ–º –≤ –º–µ–≥–∞–±–∞–π—Ç—ã
print(f"RAM used: {psutil.Process().memory_info().rss / (1024 * 1024):.2f} MB")
```

```python out
RAM used: 5678.33 MB
```

–ó–¥–µ—Å—å –∞—Ç—Ä–∏–±—É—Ç `rss` –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ _—Ä–µ–∑–∏–¥–µ–Ω—Ç–Ω–æ–º—É —Ä–∞–∑–º–µ—Ä—É –Ω–∞–±–æ—Ä–∞_, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –¥–æ–ª—é –ø–∞–º—è—Ç–∏, –∫–æ—Ç–æ—Ä—É—é –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–Ω–∏–º–∞–µ—Ç –≤ –û–ó–£. –≠—Ç–æ –∏–∑–º–µ—Ä–µ–Ω–∏–µ —Ç–∞–∫–∂–µ –≤–∫–ª—é—á–∞–µ—Ç –ø–∞–º—è—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–µ–º—É—é –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä–æ–º Python –∏ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–º–∏ –Ω–∞–º–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º–∏, –ø–æ—ç—Ç–æ–º—É —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –æ–±—ä–µ–º –ø–∞–º—è—Ç–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –Ω–µ–º–Ω–æ–≥–æ –º–µ–Ω—å—à–µ. –î–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –¥–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –Ω–∞—Å–∫–æ–ª—å–∫–æ –≤–µ–ª–∏–∫ –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –¥–∏—Å–∫–µ, –∏—Å–ø–æ–ª—å–∑—É—è –∞—Ç—Ä–∏–±—É—Ç `dataset_size`. –ü–æ—Å–∫–æ–ª—å–∫—É —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –∫–∞–∫ –∏ —Ä–∞–Ω—å—à–µ, –≤—ã—Ä–∞–∂–∞–µ—Ç—Å—è –≤ –±–∞–π—Ç–∞—Ö, –Ω–∞–º –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –µ–≥–æ –≤ –≥–∏–≥–∞–±–∞–π—Ç—ã:

```py
print(f"Number of files in dataset : {pubmed_dataset.dataset_size}")
size_gb = pubmed_dataset.dataset_size / (1024**3)
print(f"Dataset size (cache file) : {size_gb:.2f} GB")
```

```python out
Number of files in dataset : 20979437051
Dataset size (cache file) : 19.54 GB
```

–ü—Ä–∏—è—Ç–Ω–æ ‚Äî –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —Ç–æ, —á—Ç–æ –æ–Ω –≤–µ—Å–∏—Ç –ø–æ—á—Ç–∏ 20 –ì–ë, –º—ã –º–æ–∂–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç—å –∏ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –Ω–∞–±–æ—Ä—É –¥–∞–Ω–Ω—ã—Ö —Å –≥–æ—Ä–∞–∑–¥–æ –º–µ–Ω—å—à–∏–º –æ–±—ä–µ–º–æ–º –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏!

<Tip>

‚úèÔ∏è **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ!** –í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ [–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤](https://mystic.the-eye.eu/public/AI/pile_preliminary_components/) –∏–∑ Pile, –∫–æ—Ç–æ—Ä—ã–π –±–æ–ª—å—à–µ, —á–µ–º –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–º—è—Ç—å –≤–∞—à–µ–≥–æ –Ω–æ—É—Ç–±—É–∫–∞ –∏–ª–∏ –Ω–∞—Å—Ç–æ–ª—å–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞, –∑–∞–≥—Ä—É–∑–∏—Ç–µ –µ–≥–æ —Å ü§ó Datasets –∏ –∏–∑–º–µ—Ä—å—Ç–µ –æ–±—ä–µ–º –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–æ—á–Ω—ã—Ö –∏–∑–º–µ—Ä–µ–Ω–∏–π –≤–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –≤ –Ω–æ–≤–æ–º –ø—Ä–æ—Ü–µ—Å—Å–µ. –í—ã –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –≤ –¢–∞–±–ª–∏—Ü–µ 1 [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Pile] (https://arxiv.org/abs/2101.00027).

</Tip>

–ï—Å–ª–∏ –≤—ã –∑–Ω–∞–∫–æ–º—ã —Å Pandas, —ç—Ç–æ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ—Å—Ç—å—é –∏–∑-–∑–∞ –∑–Ω–∞–º–µ–Ω–∏—Ç–æ–≥–æ [—ç–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞] –£—ç—Å–∞ –ö–∏–Ω–Ω–∏ (https://wesmckinney.com/blog/apache-arrow-pandas-internals/), —Å–æ–≥–ª–∞—Å–Ω–æ –∫–æ—Ç–æ—Ä–æ–º—É –≤–∞–º –æ–±—ã—á–Ω–æ —Ç—Ä–µ–±—É–µ—Ç—Å—è 5 –¥–æ 10 —Ä–∞–∑ –±–æ–ª—å—à–µ –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç–∏, —á–µ–º —Ä–∞–∑–º–µ—Ä –≤–∞—à–µ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö. –¢–∞–∫ –∫–∞–∫ –∂–µ ü§ó Datasets —Ä–µ—à–∞—é—Ç —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é? ü§ó Datasets —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—é—Ç –∫–∞–∂–¥—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∫–∞–∫ [—Ñ–∞–π–ª —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –≤ –ø–∞–º—è—Ç—å] (https://en.wikipedia.org/wiki/Memory-mapped_file), –∫–æ—Ç–æ—Ä—ã–π –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–µ–∂–¥—É –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø–∞–º—è—Ç—å—é –∏ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ–º —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –ø–æ–ª—É—á–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º –∏ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–∏–º–∏ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–æ–ª–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –µ–≥–æ –≤ –ø–∞–º—è—Ç—å.

Memory-mapped —Ñ–∞–π–ª—ã —Ç–∞–∫–∂–µ –º–æ–≥—É—Ç —Å–æ–≤–º–µ—Å—Ç–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–∞—Å–ø–∞—Ä–∞–ª–ª–µ–ª–∏–≤–∞—Ç—å —Ç–∞–∫–∏–µ –º–µ—Ç–æ–¥—ã, –∫–∞–∫ `Dataset.map()`, –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ–º–µ—â–∞—Ç—å –∏–ª–∏ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö. –ü–æ–¥ –∫–∞–ø–æ—Ç–æ–º –≤—Å–µ —ç—Ç–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ [Apache Arrow](https://arrow.apache.org) –∏ [`pyarrow`](https://arrow.apache.org/docs/python/index. .html), –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–ª–∞—é—Ç –∑–∞–≥—Ä—É–∑–∫—É –∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –¥–∞–Ω–Ω—ã—Ö –º–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω–æ–π. (–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± Apache Arrow –∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å Pandas –æ–∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å —Å [–ø—É–±–ª–∏–∫–∞—Ü–∏–µ–π –≤ –±–ª–æ–≥–µ –î–µ—è–Ω–∞ –°–∏–º–∏–∫–∞] (https://towardsdatascience.com/apache-arrow-read-dataframe-with-zero-memory-69634092b1a). –ß—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å —ç—Ç–æ –≤ –¥–µ–π—Å—Ç–≤–∏–∏ –¥–∞–≤–∞–π—Ç–µ –ø—Ä–æ–≤–µ–¥–µ–º –Ω–µ–±–æ–ª—å—à–æ–π —Ç–µ—Å—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏, –ø–µ—Ä–µ–±–∏—Ä–∞—è –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö PubMed Abstracts:

```py
import timeit

code_snippet = """batch_size = 1000

for idx in range(0, len(pubmed_dataset), batch_size):
    _ = pubmed_dataset[idx:idx + batch_size]
"""

time = timeit.timeit(stmt=code_snippet, number=1, globals=globals())
print(
    f"Iterated over {len(pubmed_dataset)} examples (about {size_gb:.1f} GB) in "
    f"{time:.1f}s, i.e. {size_gb/time:.3f} GB/s"
)
```

```python out
'Iterated over 15518009 examples (about 19.5 GB) in 64.2s, i.e. 0.304 GB/s'
```

–ó–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –º–æ–¥—É–ª—å `timeit` Python –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è `code_snippet`. –û–±—ã—á–Ω–æ –≤—ã —Å–º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–±–∏—Ä–∞—Ç—å –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —Å–æ —Å–∫–æ—Ä–æ—Å—Ç—å—é –æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–µ—Å—è—Ç—ã—Ö –¥–æ–ª–µ–π –ì–ë/—Å –¥–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ì–ë/—Å. –≠—Ç–æ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –ø–æ–¥–∞–≤–ª—è—é—â–µ–≥–æ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π, –Ω–æ –∏–Ω–æ–≥–¥–∞ –≤–∞–º –ø—Ä–∏–¥–µ—Ç—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å —Å –Ω–∞–±–æ—Ä–æ–º –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–π —Å–ª–∏—à–∫–æ–º –≤–µ–ª–∏–∫ –¥–∞–∂–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞ –∂–µ—Å—Ç–∫–æ–º –¥–∏—Å–∫–µ –≤–∞—à–µ–≥–æ –Ω–æ—É—Ç–±—É–∫–∞. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –±—ã –º—ã –ø–æ–ø—ã—Ç–∞–ª–∏—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤–µ—Å—å Pile, –Ω–∞–º –ø–æ—Ç—Ä–µ–±–æ–≤–∞–ª–æ—Å—å –±—ã 825 –ì–ë —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ! –ß—Ç–æ–±—ã —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å —Ç–∞–∫–∏–º–∏ —Å–ª—É—á–∞—è–º–∏ ü§ó Datasets –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–æ–∫–æ–≤–æ–π –ø–µ—Ä–µ–¥–∞—á–∏, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞–º –∑–∞–≥—Ä—É–∂–∞—Ç—å –∏ –ø–æ–ª—É—á–∞—Ç—å –¥–æ—Å—Ç—É–ø –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º –Ω–∞ –ª–µ—Ç—É, –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∑–∞–≥—Ä—É–∂–∞—Ç—å –≤–µ—Å—å –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö. –î–∞–≤–∞–π—Ç–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç.

<Tip>

üí° –í Jupyter notebooks –≤—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –∏–∑–º–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è —è—á–µ–π–∫–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º  [`%%timeit` magic function](https://ipython.readthedocs.io/en/stable/interactive/magics.html#magic-timeit).

</Tip>

## –ü–æ—Ç–æ–∫–æ–≤–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞

–ß—Ç–æ–±—ã –≤–∫–ª—é—á–∏—Ç—å –ø–æ—Ç–æ–∫–æ–≤—É—é –ø–µ—Ä–µ–¥–∞—á—É –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –≤–∞–º –ø—Ä–æ—Å—Ç–æ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç `streaming=True` –≤ —Ñ—É–Ω–∫—Ü–∏—é `load_dataset()`. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–∞–≤–∞–π—Ç–µ —Å–Ω–æ–≤–∞ –∑–∞–≥—Ä—É–∑–∏–º –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö PubMed Abstracts, –Ω–æ –≤ –ø–æ—Ç–æ–∫–æ–≤–æ–º —Ä–µ–∂–∏–º–µ:

```py
pubmed_dataset_streamed = load_dataset(
    "json", data_files=data_files, split="train", streaming=True
)
```

–í–º–µ—Å—Ç–æ –∑–Ω–∞–∫–æ–º–æ–≥–æ `Dataset`, —Å –∫–æ—Ç–æ—Ä—ã–º –º—ã —É–∂–µ –≤—Å—Ç—Ä–µ—á–∞–ª–∏—Å—å –≤ –¥—Ä—É–≥–∏—Ö –º–µ—Å—Ç–∞—Ö —ç—Ç–æ–π –≥–ª–∞–≤—ã, –æ–±—ä–µ–∫—Ç, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º—ã–π —Å `streaming=True`, —è–≤–ª—è–µ—Ç—Å—è `IterableDataset`. –ö–∞–∫ —Å–ª–µ–¥—É–µ—Ç –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —ç–ª–µ–º–µ–Ω—Ç–∞–º `IterableDataset`, –Ω–∞–º –Ω—É–∂–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∏—Ç–µ—Ä–∞—Ü–∏—é –ø–æ –Ω–µ–º—É. –ú—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø–µ—Ä–≤–æ–º—É —ç–ª–µ–º–µ–Ω—Ç—É –Ω–∞—à–µ–≥–æ –Ω–∞–±–æ—Ä–∞ –ø–æ—Ç–æ–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```py
next(iter(pubmed_dataset_streamed))
```

```python out
{'meta': {'pmid': 11409574, 'language': 'eng'},
 'text': 'Epidemiology of hypoxaemia in children with acute lower respiratory infection.\nTo determine the prevalence of hypoxaemia in children aged under 5 years suffering acute lower respiratory infections (ALRI), the risk factors for hypoxaemia in children under 5 years of age with ALRI, and the association of hypoxaemia with an increased risk of dying in children of the same age ...'}
```

–≠–ª–µ–º–µ–Ω—Ç—ã –∏–∑ –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ –ª–µ—Ç—É —Å –ø–æ–º–æ—â—å—é `IterableDataset.map()`, —á—Ç–æ –ø–æ–ª–µ–∑–Ω–æ –≤–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è, –µ—Å–ª–∏ –≤–∞–º –Ω—É–∂–Ω–æ —Ç–æ–∫–µ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ. –ü—Ä–æ—Ü–µ—Å—Å —Ç–æ—á–Ω–æ —Ç–∞–∫–æ–π –∂–µ, –∫–∞–∫ —Ç–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –¥–ª—è —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏–∏ –Ω–∞—à–µ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –≤ [–ì–ª–∞–≤–µ 3](../chapter3/1), —Å —Ç–æ–π –ª–∏—à—å —Ä–∞–∑–Ω–∏—Ü–µ–π, —á—Ç–æ –≤—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –æ–¥–∏–Ω –∑–∞ –¥—Ä—É–≥–∏–º:

```py
from transformers import AutoTokenizer

tokenizer = AutoTokenizer.from_pretrained("distilbert-base-uncased")
tokenized_dataset = pubmed_dataset_streamed.map(lambda x: tokenizer(x["text"]))
next(iter(tokenized_dataset))
```

```python out
{'input_ids': [101, 4958, 5178, 4328, 6779, ...], 'attention_mask': [1, 1, 1, 1, 1, ...]}
```

<Tip>

üí° –ß—Ç–æ–±—ã —É—Å–∫–æ—Ä–∏—Ç—å —Ç–æ–∫–µ–Ω–∏–∑–∞—Ü–∏—é —Å –ø–æ—Ç–æ–∫–æ–≤–æ–π –ø–µ—Ä–µ–¥–∞—á–µ–π, –≤—ã –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–¥–∞—Ç—å `batched=True`, –∫–∞–∫ –º—ã –¥–µ–ª–∞–ª–∏ –≤ –ø–æ—Å–ª–µ–¥–Ω–µ–º —Ä–∞–∑–¥–µ–ª–µ. –û–Ω –±—É–¥–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ø—Ä–∏–º–µ—Ä—ã –±–∞—Ç—á–∞–º–∏; —Ä–∞–∑–º–µ—Ä –±–∞—Ç—á–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç 1000 –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å —É–∫–∞–∑–∞–Ω –≤ –∞—Ä–≥—É–º–µ–Ω—Ç–µ `batch_size`.

</Tip>

–í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–º–µ—à–∞—Ç—å –ø–æ—Ç–æ–∫–æ–≤—ã–µ –Ω–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É—è `IterableDataset.shuffle()`, –Ω–æ –≤ –æ—Ç–ª–∏—á–∏–µ –æ—Ç `Dataset.shuffle()`, —ç—Ç–æ —Ç–æ–ª—å–∫–æ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–µ—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –≤ –ø—Ä–µ–¥–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º `buffer_size`:

```py
shuffled_dataset = pubmed_dataset_streamed.shuffle(buffer_size=10_000, seed=42)
next(iter(shuffled_dataset))
```

```python out
{'meta': {'pmid': 11410799, 'language': 'eng'},
 'text': 'Randomized study of dose or schedule modification of granulocyte colony-stimulating factor in platinum-based chemotherapy for elderly patients with lung cancer ...'}
```

–í —ç—Ç–æ–º –ø—Ä–∏–º–µ—Ä–µ –º—ã –≤—ã–±—Ä–∞–ª–∏ —Å–ª—É—á–∞–π–Ω—ã–π –ø—Ä–∏–º–µ—Ä –∏–∑ –ø–µ—Ä–≤—ã—Ö 10 000 –ø—Ä–∏–º–µ—Ä–æ–≤ –≤ –±—É—Ñ–µ—Ä–µ. –ü–æ—Å–ª–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ –ø—Ä–∏–º–µ—Ä—É –µ–≥–æ –º–µ—Å—Ç–æ –≤ –±—É—Ñ–µ—Ä–µ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º –ø—Ä–∏–º–µ—Ä–æ–º –≤ –∫–æ—Ä–ø—É—Å–µ (—Ç. –µ. 10¬†001-–º –ø—Ä–∏–º–µ—Ä–æ–º –≤ –ø—Ä–∏–≤–µ–¥–µ–Ω–Ω–æ–º –≤—ã—à–µ —Å–ª—É—á–∞–µ). –í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –≤—ã–±–∏—Ä–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑ –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –∏—Å–ø–æ–ª—å–∑—É—è —Ñ—É–Ω–∫—Ü–∏–∏ `IterableDataset.take()` –∏ `IterableDataset.skip()`, –∫–æ—Ç–æ—Ä—ã–µ –¥–µ–π—Å—Ç–≤—É—é—Ç –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ `Dataset.select()`. –ù–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å –ø–µ—Ä–≤—ã–µ 5 –ø—Ä–∏–º–µ—Ä–æ–≤ –≤ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö PubMed Abstracts, –º—ã –º–æ–∂–µ–º —Å–¥–µ–ª–∞—Ç—å —Å–ª–µ–¥—É—é—â–µ–µ:

```py
dataset_head = pubmed_dataset_streamed.take(5)
list(dataset_head)
```

```python out
[{'meta': {'pmid': 11409574, 'language': 'eng'},
  'text': 'Epidemiology of hypoxaemia in children with acute lower respiratory infection ...'},
 {'meta': {'pmid': 11409575, 'language': 'eng'},
  'text': 'Clinical signs of hypoxaemia in children with acute lower respiratory infection: indicators of oxygen therapy ...'},
 {'meta': {'pmid': 11409576, 'language': 'eng'},
  'text': "Hypoxaemia in children with severe pneumonia in Papua New Guinea ..."},
 {'meta': {'pmid': 11409577, 'language': 'eng'},
  'text': 'Oxygen concentrators and cylinders ...'},
 {'meta': {'pmid': 11409578, 'language': 'eng'},
  'text': 'Oxygen supply in rural africa: a personal experience ...'}]
```

–¢–æ—á–Ω–æ —Ç–∞–∫ –∂–µ –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `IterableDataset.skip()` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –æ–±—É—á–∞—é—â–∏—Ö –∏ –ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã—Ö —Å–ø–ª–∏—Ç–æ–≤ –∏–∑ –ø–µ—Ä–µ–º–µ—à–∞–Ω–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```py
# –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–≤—ã–µ 1000 –æ–±—ä–µ–∫—Ç–æ–≤ –∏ –≤–∫–ª—é—á–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≤ –æ–±—É—á–∞—é—â—É—é –≤—ã–±–æ—Ä–∫—É
train_dataset = shuffled_dataset.skip(1000)
# –í–∑—è—Ç—å –ø–µ—Ä–≤—ã–µ 1000 –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—É—é –≤—ã–±–æ—Ä–∫—É
validation_dataset = shuffled_dataset.take(1000)
```

–î–∞–≤–∞–π—Ç–µ –∑–∞–≤–µ—Ä—à–∏–º –Ω–∞—à–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –ø–æ—Ç–æ–∫–æ–≤–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö –æ–±—â–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º: –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö –≤–º–µ—Å—Ç–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –µ–¥–∏–Ω–æ–≥–æ –∫–æ—Ä–ø—É—Å–∞. ü§ó Datasets –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç —Ñ—É–Ω–∫—Ü–∏—é `interleave_datasets()`, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Å–ø–∏—Å–æ–∫ –æ–±—ä–µ–∫—Ç–æ–≤ `IterableDataset` –≤ –æ–¥–∏–Ω `IterableDataset`, –≥–¥–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–æ–≤–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—É—á–∞—é—Ç—Å—è –ø—É—Ç–µ–º —á–µ—Ä–µ–¥–æ–≤–∞–Ω–∏—è –∏—Å—Ö–æ–¥–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤. –≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –æ—Å–æ–±–µ–Ω–Ω–æ –ø–æ–ª–µ–∑–Ω–∞, –∫–æ–≥–¥–∞ –≤—ã –ø—ã—Ç–∞–µ—Ç–µ—Å—å –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –±–æ–ª—å—à–∏–µ –Ω–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö, –ø–æ—ç—Ç–æ–º—É –≤ –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–µ—Ä–∞ –¥–∞–≤–∞–π—Ç–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç FreeLaw –∏–∑ Pile, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö —é—Ä–∏–¥–∏—á–µ—Å–∫–∏—Ö –∑–∞–∫–ª—é—á–µ–Ω–∏–π —Å—É–¥–æ–≤ –°–®–ê –æ–±—ä–µ–º–æ–º 51 –ì–ë:

```py
law_dataset_streamed = load_dataset(
    "json",
    data_files="https://mystic.the-eye.eu/public/AI/pile_preliminary_components/FreeLaw_Opinions.jsonl.zst",
    split="train",
    streaming=True,
)
next(iter(law_dataset_streamed))
```

```python out
{'meta': {'case_ID': '110921.json',
  'case_jurisdiction': 'scotus.tar.gz',
  'date_created': '2010-04-28T17:12:49Z'},
 'text': '\n461 U.S. 238 (1983)\nOLIM ET AL.\nv.\nWAKINEKONA\nNo. 81-1581.\nSupreme Court of United States.\nArgued January 19, 1983.\nDecided April 26, 1983.\nCERTIORARI TO THE UNITED STATES COURT OF APPEALS FOR THE NINTH CIRCUIT\n*239 Michael A. Lilly, First Deputy Attorney General of Hawaii, argued the cause for petitioners. With him on the brief was James H. Dannenberg, Deputy Attorney General...'}
```

–≠—Ç–æ—Ç –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤–µ–ª–∏–∫, —á—Ç–æ–±—ã –Ω–∞–≥—Ä—É–∂–∞—Ç—å –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω—É—é –ø–∞–º—è—Ç—å –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –Ω–æ—É—Ç–±—É–∫–æ–≤, –Ω–æ –º—ã —Å–º–æ–≥–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å –µ–≥–æ –∏ –ø–æ–ª—É—á–∏—Ç—å –∫ –Ω–µ–º—É –¥–æ—Å—Ç—É–ø! –î–∞–≤–∞–π—Ç–µ —Ç–µ–ø–µ—Ä—å –æ–±—ä–µ–¥–∏–Ω–∏–º –ø—Ä–∏–º–µ—Ä—ã –∏–∑ –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö FreeLaw –∏ PubMed Abstracts —Å —Ñ—É–Ω–∫—Ü–∏–µ–π `interleave_datasets()`:

```py
from itertools import islice
from datasets import interleave_datasets

combined_dataset = interleave_datasets([pubmed_dataset_streamed, law_dataset_streamed])
list(islice(combined_dataset, 2))
```

```python out
[{'meta': {'pmid': 11409574, 'language': 'eng'},
  'text': 'Epidemiology of hypoxaemia in children with acute lower respiratory infection ...'},
 {'meta': {'case_ID': '110921.json',
   'case_jurisdiction': 'scotus.tar.gz',
   'date_created': '2010-04-28T17:12:49Z'},
  'text': '\n461 U.S. 238 (1983)\nOLIM ET AL.\nv.\nWAKINEKONA\nNo. 81-1581.\nSupreme Court of United States.\nArgued January 19, 1983.\nDecided April 26, 1983.\nCERTIORARI TO THE UNITED STATES COURT OF APPEALS FOR THE NINTH CIRCUIT\n*239 Michael A. Lilly, First Deputy Attorney General of Hawaii, argued the cause for petitioners. With him on the brief was James H. Dannenberg, Deputy Attorney General...'}]
```

–ó–¥–µ—Å—å –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Ñ—É–Ω–∫—Ü–∏—é `islice()` –∏–∑ –º–æ–¥—É–ª—è `itertools` Python, —á—Ç–æ–±—ã –≤—ã–±—Ä–∞—Ç—å –ø–µ—Ä–≤—ã–µ –¥–≤–∞ –æ–±—ä–µ–∫—Ç–∞ –∏–∑ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –∏ –º—ã –≤–∏–¥–∏–º, —á—Ç–æ –æ–Ω–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –ø–µ—Ä–≤—ã–º –ø—Ä–∏–º–µ—Ä–∞–º –∏–∑ –∫–∞–∂–¥–æ–≥–æ –∏–∑ –¥–≤—É—Ö –∏—Å—Ö–æ–¥–Ω—ã—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö.

–ù–∞–∫–æ–Ω–µ—Ü, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –≤ –ø–æ—Ç–æ–∫–æ–≤–æ–º —Ä–µ–∂–∏–º–µ –≤–µ—Å—å Pile —Ü–µ–ª–∏–∫–æ–º (825 –ì–ë), –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```py
base_url = "https://mystic.the-eye.eu/public/AI/pile/"
data_files = {
    "train": [base_url + "train/" + f"{idx:02d}.jsonl.zst" for idx in range(30)],
    "validation": base_url + "val.jsonl.zst",
    "test": base_url + "test.jsonl.zst",
}
pile_dataset = load_dataset("json", data_files=data_files, streaming=True)
next(iter(pile_dataset["train"]))
```

```python out
{'meta': {'pile_set_name': 'Pile-CC'},
 'text': 'It is done, and submitted. You can play ‚ÄúSurvival of the Tastiest‚Äù on Android, and on the web...'}
```

<Tip>

‚úèÔ∏è **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ!** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–¥–∏–Ω –∏–∑ –±–æ–ª—å—à–∏—Ö –∫–æ—Ä–ø—É—Å–æ–≤ Common Crawl, –Ω–∞–ø—Ä–∏–º–µ—Ä [`mc4`](https://huggingface.co/datasets/mc4) –∏–ª–∏ [`oscar`](https://huggingface.co/ datasets/oscar) –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Ç–æ–∫–æ–≤–æ–≥–æ –º–Ω–æ–≥–æ—è–∑—ã—á–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω—ã—Ö —è–∑—ã–∫–æ–≤ –≤ —Å—Ç—Ä–∞–Ω–µ –ø–æ –≤–∞—à–µ–º—É –≤—ã–±–æ—Ä—É. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ –®–≤–µ–π—Ü–∞—Ä–∏–∏ –µ—Å—Ç—å —á–µ—Ç—ã—Ä–µ –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —è–∑—ã–∫–∞: –Ω–µ–º–µ—Ü–∫–∏–π, —Ñ—Ä–∞–Ω—Ü—É–∑—Å–∫–∏–π, –∏—Ç–∞–ª—å—è–Ω—Å–∫–∏–π –∏ —Ä–µ—Ç–æ-—Ä–æ–º–∞–Ω—Å–∫–∏–π, –ø–æ—ç—Ç–æ–º—É –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–æ–∑–¥–∞—Ç—å —à–≤–µ–π—Ü–∞—Ä—Å–∫–∏–π –∫–æ—Ä–ø—É—Å, –≤—ã–±—Ä–∞–≤ –ø–æ–¥–º–Ω–æ–∂–µ—Å—Ç–≤–∞ –û—Å–∫–∞—Ä–æ–≤ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –∏—Ö —Ä–∞–∑–≥–æ–≤–æ—Ä–Ω–æ–π –ø—Ä–æ–ø–æ—Ä—Ü–∏–µ–π.

</Tip>

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å –≤—Å–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö –≤—Å–µ—Ö —Ñ–æ—Ä–º –∏ —Ä–∞–∑–º–µ—Ä–æ–≤, –Ω–æ, –µ—Å–ª–∏ —Ç–æ–ª—å–∫–æ –≤–∞–º –Ω–µ –ø–æ–≤–µ–∑–µ—Ç, –≤ –≤–∞—à–µ–º –ø—É—Ç–µ—à–µ—Å—Ç–≤–∏–∏ –ø–æ –ù–õ–ü –Ω–∞—Å—Ç—É–ø–∏—Ç –º–æ–º–µ–Ω—Ç, –∫–æ–≥–¥–∞ –≤–∞–º –ø—Ä–∏–¥–µ—Ç—Å—è —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º—ã. –≠—Ç–æ —Ç–µ–º–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Ä–∞–∑–¥–µ–ª–∞!
