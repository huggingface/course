# родро░ро╡рпИроЪрпН роЪрпЖропро▓ро╛роХрпНроХрпБродро▓рпН[[processing-the-data]]

<CourseFloatingBanner chapter={3}
  classNames="absolute z-10 right-0 top-0"
  notebooks={[
    {label: "Google Colab", value: "https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/en/chapter3/section2.ipynb"},
    {label: "Aws Studio", value: "https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/en/chapter3/section2.ipynb"},
]} />

[роорпБроирпНродрпИроп роЕродрпНродро┐ропро╛ропродрпНродро┐ро▓рпН](/course/ta/chapter2) роЙро│рпНро│ роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпИродрпН родрпКроЯро░рпНроирпНродрпБ, роТро░рпБ рокрпЗроЯрпНроЪро┐ро▓рпН (batch) роТро░рпБ роЪрпАроХрпНро╡рпЖройрпНро╕рпН роХро┐ро│ро╛роЪро┐роГрокрпИропро░рпИ (sequence classifier) роОрокрпНрокроЯро┐рокрпН рокропро┐ро▒рпНро▒рпБро╡ро┐рокрпНрокродрпБ роОройрпНрокродрпБ роЗроЩрпНроХрпЗ:

```python
import torch
from torch.optim import AdamW
from transformers import AutoTokenizer, AutoModelForSequenceClassification

# роорпБройрпНрокрпБ рокрпЛро▓ро╡рпЗ
checkpoint = "bert-base-uncased"
tokenizer = AutoTokenizer.from_pretrained(checkpoint)
model = AutoModelForSequenceClassification.from_pretrained(checkpoint)
sequences = [
    "роиро╛ройрпН роОройрпН ро╡ро╛ро┤рпНроиро╛ро│рпН роорпБро┤рпБро╡родрпБроорпН роТро░рпБ HuggingFace рокро╛роЯроирпЖро▒ро┐роХрпНроХро╛роХ роХро╛родрпНродро┐ро░рпБроирпНродрпЗройрпН.",
    "роЗроирпНрод рокро╛роЯроирпЖро▒ро┐ роЕро░рпБроорпИропро╛роХ роЙро│рпНро│родрпБ!",
]
batch = tokenizer(sequences, padding=True, truncation=True, return_tensors="pt")

# роЗродрпБ рокрпБродро┐ропродрпБ
batch["labels"] = torch.tensor([1, 1])

optimizer = AdamW(model.parameters())
loss = model(**batch).loss
loss.backward()
optimizer.step()
```

роиро┐роЪрпНроЪропрооро╛роХ, роЗро░рогрпНроЯрпБ ро╡ро╛роХрпНроХро┐ропроЩрпНроХро│ро┐ро▓рпН роороЯрпНроЯрпБроорпН рооро╛роЯро▓рпИрокрпН рокропро┐ро▒рпНро▒рпБро╡ро┐рокрпНрокродрпБ роиро▓рпНро▓ роорпБроЯро┐ро╡рпБроХро│рпИродрпН родро░ро╛родрпБ. роЪро┐ро▒роирпНрод роорпБроЯро┐ро╡рпБроХро│рпИрокрпН рокрпЖро▒, роирпАроЩрпНроХро│рпН роТро░рпБ рокрпЖро░ро┐роп роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯрпИродрпН родропро╛ро░ро┐роХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН.

роЗроирпНродрокрпН рокро┐ро░ро┐ро╡ро┐ро▓рпН, ро╡ро┐ро▓рпНро▓ро┐ропроорпН рокро┐. роЯрпЛро▓ройрпН рооро▒рпНро▒рпБроорпН роХро┐ро▒ро┐ро╕рпН рокрпНро░рпЛроХрпНроХрпЖроЯрпН роЖроХро┐ропрпЛро░ро┐ройрпН [роХроЯрпНроЯрпБро░рпИропро┐ро▓рпН](https://www.aclweb.org/anthology/I05-5002.pdf) роЕро▒ро┐роорпБроХрокрпНрокроЯрпБродрпНродрокрпНрокроЯрпНроЯ MRPC (Microsoft Research Paraphrase Corpus) роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯрпИ роЙродро╛ро░рогрооро╛роХрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡рпЛроорпН. роЗроирпНрод роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпН 5,801 ро╡ро╛роХрпНроХро┐роп роЬрпЛроЯро┐роХро│рпИроХрпН роХрпКрогрпНроЯрпБро│рпНро│родрпБ, роЕро╡рпИ рокро╛ро░ро╛рокро┐ро░рпЗро╕рпНроХро│ро╛ (paraphrases) роЗро▓рпНро▓рпИропро╛ роОройрпНрокродрпИроХрпН роХрпБро▒ро┐роХрпНроХрпБроорпН роТро░рпБ ро▓рпЗрокро┐ро│рпБроЯройрпН (роЕродро╛ро╡родрпБ, роЗро░рогрпНроЯрпБ ро╡ро╛роХрпНроХро┐ропроЩрпНроХро│рпБроорпН роТро░рпЗ роЕро░рпНродрпНродродрпНродрпИроХрпН роХрпКрогрпНроЯро┐ро░рпБроирпНродро╛ро▓рпН). роЗродрпБ [GLUE рокрпЖроЮрпНроЪрпНрооро╛ро░рпНроХрпН](https://gluebenchmark.com/)-роР роЙро░рпБро╡ро╛роХрпНроХрпБроорпН 10 роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроХро│ро┐ро▓рпН роТройрпНро▒ро╛роХрпБроорпН, роЗродрпБ 10 ро╡рпЖро╡рпНро╡рпЗро▒рпБ роЙро░рпИ ро╡роХрпИрокрпНрокро╛роЯрпНроЯрпБрокрпН рокрогро┐роХро│ро┐ро▓рпН ML рооро╛роЯро▓рпНроХро│ро┐ройрпН роЪрпЖропро▓рпНродро┐ро▒ройрпИ роЕро│ро╡ро┐роЯрокрпН рокропройрпНрокроЯрпБроорпН роТро░рпБ роХро▓рпНро╡ро┐ рокрпЖроЮрпНроЪрпНрооро╛ро░рпНроХрпН роЖроХрпБроорпН.

### ро╣рокрпНрокро┐ро▓ро┐ро░рпБроирпНродрпБ роТро░рпБ роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯрпИ роПро▒рпНро▒рпБродро▓рпН[[loading-a-dataset-from-the-hub]]

<Youtube id="_BZearw7f0w"/>

ро╣рокрпНрокро┐ро▓рпН рооро╛роЯро▓рпНроХро│рпН роороЯрпНроЯрпБрооро▓рпНро▓; рокро▓ роорпКро┤ро┐роХро│ро┐ро▓рпН рокро▓ роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроХро│рпБроорпН роЙро│рпНро│рой. роирпАроЩрпНроХро│рпН роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроХро│рпИ [роЗроЩрпНроХрпЗ](https://huggingface.co/datasets) роЙро▓ро╛ро╡ро▓ро╛роорпН, роорпЗро▓рпБроорпН роЗроирпНродрокрпН рокроХрпБродро┐ропрпИрокрпН рокроЯро┐родрпНродро╡рпБроЯройрпН роТро░рпБ рокрпБродро┐роп роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯрпИ роПро▒рпНро▒ро┐ роЪрпЖропро▓ро╛роХрпНроХ роорпБропро▒рпНроЪро┐роХрпНроХрпБрооро╛ро▒рпБ рокро░ро┐роирпНродрпБро░рпИроХрпНроХро┐ро▒рпЛроорпН (рокрпКродрпБро╡ро╛рой роЖро╡рогроЩрпНроХро│рпИ [роЗроЩрпНроХрпЗ](https://huggingface.co/docs/datasets/) рокро╛ро░рпНроХрпНроХро╡рпБроорпН). роЖройро╛ро▓рпН роЗрокрпНрокрпЛродрпИроХрпНроХрпБ, MRPC роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯро┐ро▓рпН роХро╡ройроорпН роЪрпЖро▓рпБродрпНродрпБро╡рпЛроорпН! роЗродрпБ [GLUE рокрпЖроЮрпНроЪрпНрооро╛ро░рпНроХрпН](https://gluebenchmark.com/)-роР роЙро░рпБро╡ро╛роХрпНроХрпБроорпН 10 роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроХро│ро┐ро▓рпН роТройрпНро▒ро╛роХрпБроорпН, роЗродрпБ 10 ро╡рпЖро╡рпНро╡рпЗро▒рпБ роЙро░рпИ ро╡роХрпИрокрпНрокро╛роЯрпНроЯрпБрокрпН рокрогро┐роХро│ро┐ро▓рпН ML рооро╛роЯро▓рпНроХро│ро┐ройрпН роЪрпЖропро▓рпНродро┐ро▒ройрпИ роЕро│ро╡ро┐роЯрокрпН рокропройрпНрокроЯрпБроорпН роТро░рпБ роХро▓рпНро╡ро┐ рокрпЖроЮрпНроЪрпНрооро╛ро░рпНроХрпН роЖроХрпБроорпН.

ЁЯдЧ Datasets ро▓рпИрокрпНро░ро░ро┐, ро╣рокрпНрокро┐ро▓рпН роЙро│рпНро│ роТро░рпБ роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯрпИрокрпН рокродро┐ро╡ро┐ро▒роХрпНроХроорпН роЪрпЖропрпНродрпБ роХрпЗроЪрпН (cache) роЪрпЖропрпНроп рооро┐роХро╡рпБроорпН роОро│ро┐роорпИропро╛рой роХроЯрпНроЯро│рпИропрпИ ро╡ро┤роЩрпНроХрпБроХро┐ро▒родрпБ. роиро╛роорпН MRPC роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯрпИ роЗрокрпНрокроЯро┐рокрпН рокродро┐ро╡ро┐ро▒роХрпНроХроорпН роЪрпЖропрпНропро▓ро╛роорпН:

<Tip>

ЁЯТб **роХрпВроЯрпБродро▓рпН ро╡ро│роЩрпНроХро│рпН**: роорпЗро▓рпБроорпН роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпН роПро▒рпНро▒рпБродро▓рпН роирпБроЯрпНрокроЩрпНроХро│рпН рооро▒рпНро▒рпБроорпН роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпБроХро│рпБроХрпНроХрпБ, [ЁЯдЧ Datasets роЖро╡рогроЩрпНроХро│рпИ](https://huggingface.co/docs/datasets/) рокро╛ро░рпНроХрпНроХро╡рпБроорпН.

</Tip> 

```py
from datasets import load_dataset

raw_datasets = load_dataset("glue", "mrpc")
raw_datasets
```

```python out
DatasetDict({
    train: Dataset({
        features: ['sentence1', 'sentence2', 'label', 'idx'],
        num_rows: 3668
    })
    validation: Dataset({
        features: ['sentence1', 'sentence2', 'label', 'idx'],
        num_rows: 408
    })
    test: Dataset({
        features: ['sentence1', 'sentence2', 'label', 'idx'],
        num_rows: 1725
    })
})
```

роирпАроЩрпНроХро│рпН рокро╛ро░рпНрокрпНрокродрпБ рокрпЛро▓рпН, рокропро┐ро▒рпНроЪро┐родрпН родрпКроХрпБрокрпНрокрпБ, роЪро░ро┐рокро╛ро░рпНрокрпНрокрпБродрпН родрпКроХрпБрокрпНрокрпБ рооро▒рпНро▒рпБроорпН роЪрпЛродройрпИродрпН родрпКроХрпБрокрпНрокрпБ роЖроХро┐ропро╡ро▒рпНро▒рпИроХрпН роХрпКрогрпНроЯ роТро░рпБ `DatasetDict` роЖрокрпНроЬрпЖроХрпНроЯрпН роироороХрпНроХрпБроХрпН роХро┐роЯрпИроХрпНроХро┐ро▒родрпБ. роЕро╡ро▒рпНро▒рпБро│рпН роТро╡рпНро╡рпКройрпНро▒рпБроорпН рокро▓ рокродрпНродро┐роХро│рпИроХрпН (`sentence1`, `sentence2`, `label`, рооро▒рпНро▒рпБроорпН `idx`) рооро▒рпНро▒рпБроорпН рооро╛ро▒рпБрокроЯрпНроЯ роОрогрпНрогро┐роХрпНроХрпИропро┐ро▓ро╛рой ро╡ро░ро┐роЪрпИроХро│рпИроХрпН роХрпКрогрпНроЯрпБро│рпНро│родрпБ, роЕро╡рпИ роТро╡рпНро╡рпКро░рпБ родрпКроХрпБрокрпНрокро┐ро▓рпБроорпН роЙро│рпНро│ роХрпВро▒рпБроХро│ро┐ройрпН роОрогрпНрогро┐роХрпНроХрпИропро╛роХрпБроорпН (роОройро╡рпЗ, рокропро┐ро▒рпНроЪро┐родрпН родрпКроХрпБрокрпНрокро┐ро▓рпН 3,668 ро╡ро╛роХрпНроХро┐роп роЬрпЛроЯро┐роХро│рпН, роЪро░ро┐рокро╛ро░рпНрокрпНрокрпБродрпН родрпКроХрпБрокрпНрокро┐ро▓рпН 408, рооро▒рпНро▒рпБроорпН роЪрпЛродройрпИродрпН родрпКроХрпБрокрпНрокро┐ро▓рпН 1,725 роЙро│рпНро│рой).

<Tip>

роЗроирпНродроХрпН роХроЯрпНроЯро│рпИ роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯрпИрокрпН рокродро┐ро╡ро┐ро▒роХрпНроХроорпН роЪрпЖропрпНродрпБ роХрпЗроЪрпН роЪрпЖропрпНроХро┐ро▒родрпБ, роЗропро▓рпНрокро╛роХ *~/.cache/huggingface/datasets*-ро▓рпН. роиро┐ройрпИро╡ро┐ро░рпБроХрпНроХроЯрпНроЯрпБроорпН, роЕродрпНродро┐ропро╛ропроорпН 2-ро▓рпН рокро╛ро░рпНродрпНродродрпБ рокрпЛро▓, `HF_HOME` роЪрпВро┤ро▓рпН рооро╛ро▒ро┐ропрпИ роЕроорпИрокрпНрокродройрпН роорпВро▓роорпН роЙроЩрпНроХро│рпН роХрпЗроЪрпН роХрпЛрокрпНрокрпБро▒рпИропрпИродрпН родройро┐рокрпНрокропройро╛роХрпНроХро▓ро╛роорпН.

</Tip>

роироородрпБ `raw_datasets` роЖрокрпНроЬрпЖроХрпНроЯрпНроЯро┐ро▓рпН роЙро│рпНро│ роТро╡рпНро╡рпКро░рпБ ро╡ро╛роХрпНроХро┐роп роЬрпЛроЯро┐ропрпИропрпБроорпН роТро░рпБ роЕроХро░ро╛родро┐ропрпИрокрпН рокрпЛро▓ роХрпБро▒ро┐ропрпАроЯрпНроЯрпБ роорпВро▓роорпН роЕрогрпБроХро▓ро╛роорпН:

```py
raw_train_dataset = raw_datasets["train"]
raw_train_dataset[0]
```

```python out
{'idx': 0,
 'label': 1,
 'sentence1': 'Amrozi accused his brother , whom he called " the witness " , of deliberately distorting his evidence .',
 'sentence2': 'Referring to him as only " the witness " , Amrozi accused his brother of deliberately distorting his evidence .'}
```

роОроирпНрод роорпБро┤рпБ роОрогрпН роОроирпНродро▓рпЗрокро┐ро│рпБроХрпНроХрпБ роТродрпНродро┐ро░рпБроХрпНроХро┐ро▒родрпБ роОройрпНрокродрпИ роЕро▒ро┐роп, роироородрпБ `raw_train_dataset`-ройрпН `features`-роР роЖропрпНро╡рпБ роЪрпЖропрпНропро▓ро╛роорпН. роЗродрпБ роТро╡рпНро╡рпКро░рпБ рокродрпНродро┐ропро┐ройрпН ро╡роХрпИропрпИропрпБроорпН роироороХрпНроХрпБродрпН родрпЖро░ро┐ро╡ро┐роХрпНроХрпБроорпН:

```py
raw_train_dataset.features
```

```python out
{'idx': Value(dtype='int32', id=None),
 'label': ClassLabel(num_classes=2, names=['not_equivalent', 'equivalent'], id=None),
 'sentence1': Value(dtype='string', id=None),
 'sentence2': Value(dtype='string', id=None)}
```

роЗроЩрпНроХрпЗ, `label` `ClassLabel` ро╡роХрпИропрпИроЪрпН роЪрпЗро░рпНроирпНродродрпБ, рооро▒рпНро▒рпБроорпН роорпБро┤рпБ роОрогрпНроХро│рпИ ро▓рпЗрокро┐ро│рпН рокрпЖропро░рпБроЯройрпН рокрпКро░рпБродрпНродрпБро╡родрпБ `names` роХрпЛрокрпНрокрпБро▒рпИропро┐ро▓рпН роЪрпЗрооро┐роХрпНроХрокрпНрокроЯрпНроЯрпБро│рпНро│родрпБ. `0` роОройрпНрокродрпБ `not_equivalent`-роХрпНроХрпБ роТродрпНродро┐ро░рпБроХрпНроХро┐ро▒родрпБ, рооро▒рпНро▒рпБроорпН `1` роОройрпНрокродрпБ `equivalent`-роХрпНроХрпБ роТродрпНродро┐ро░рпБроХрпНроХро┐ро▒родрпБ.

<Tip>

тЬПя╕П **роорпБропро▒рпНроЪро┐родрпНродрпБрокрпН рокро╛ро░рпБроЩрпНроХро│рпН!** рокропро┐ро▒рпНроЪро┐родрпН родрпКроХрпБрокрпНрокро┐ройрпН 15-ро╡родрпБ роЙро▒рпБрокрпНрокрпИропрпБроорпН, роЪро░ро┐рокро╛ро░рпНрокрпНрокрпБродрпН родрпКроХрпБрокрпНрокро┐ройрпН 87-ро╡родрпБ роЙро▒рпБрокрпНрокрпИропрпБроорпН рокро╛ро░рпБроЩрпНроХро│рпН. роЕро╡ро▒рпНро▒ро┐ройрпН ро▓рпЗрокро┐ро│рпНроХро│рпН роОройрпНрой?

</Tip>

### родро░ро╡рпИ роорпБройрпНродропро╛ро░ро┐родрпНродро▓рпН[[preprocessing-a-dataset]]

<Youtube id="0u3ioSwev3s"/>

родро░ро╡рпИ роорпБройрпНродропро╛ро░ро┐роХрпНроХ, роЙро░рпИропрпИ рооро╛роЯро▓рпН рокрпБро░ро┐роирпНродрпБроХрпКро│рпНро│роХрпНроХрпВроЯро┐роп роОрогрпНроХро│ро╛роХ рооро╛ро▒рпНро▒ ро╡рпЗрогрпНроЯрпБроорпН. [роЕродрпНродро┐ропро╛ропроорпН 2](/course/ta/chapter2)-ро▓рпН роирпАроЩрпНроХро│рпН рокро╛ро░рпНродрпНродродрпБ рокрпЛро▓рпН, роЗродрпБ роТро░рпБ роЯрпЛроХрпНроХройрпИроЪро░рпН роорпВро▓роорпН роЪрпЖропрпНропрокрпНрокроЯрпБроХро┐ро▒родрпБ. роиро╛роорпН роЯрпЛроХрпНроХройрпИроЪро░рпБроХрпНроХрпБ роТро░рпБ ро╡ро╛роХрпНроХро┐ропродрпНродрпИропрпЛ роЕро▓рпНро▓родрпБ ро╡ро╛роХрпНроХро┐ропроЩрпНроХро│ро┐ройрпН рокроЯрпНроЯро┐ропро▓рпИропрпЛ роХрпКроЯрпБроХрпНроХро▓ро╛роорпН, роОройро╡рпЗ роТро╡рпНро╡рпКро░рпБ роЬрпЛроЯро┐ропро┐ройрпН роЕройрпИродрпНродрпБ роорпБродро▓рпН ро╡ро╛роХрпНроХро┐ропроЩрпНроХро│рпИропрпБроорпН рооро▒рпНро▒рпБроорпН роЕройрпИродрпНродрпБ роЗро░рогрпНроЯро╛ро╡родрпБ ро╡ро╛роХрпНроХро┐ропроЩрпНроХро│рпИропрпБроорпН роирпЗро░роЯро┐ропро╛роХ роЯрпЛроХрпНроХройрпИро╕рпН роЪрпЖропрпНропро▓ро╛роорпН:

```python
from transformers import AutoTokenizer

checkpoint = "bert-base-uncased"
tokenizer = AutoTokenizer.from_pretrained(checkpoint)
tokenized_sentences_1 = tokenizer(raw_datasets["train"]["sentence1"])
tokenized_sentences_2 = tokenizer(raw_datasets["train"]["sentence2"])
```

роЗро░рпБрокрпНрокро┐ройрпБроорпН, роиро╛роорпН роЗро░рогрпНроЯрпБ роЪрпАроХрпНро╡рпЖройрпНро╕рпНроХро│рпИ рооро╛роЯро▓рпБроХрпНроХрпБ роЕройрпБрокрпНрок роорпБроЯро┐ропро╛родрпБ; роЕро╡ро▒рпНро▒рпИ роТро░рпБ роЬрпЛроЯро┐ропро╛роХроХрпН роХрпИропро╛ро│ ро╡рпЗрогрпНроЯрпБроорпН, рооро▒рпНро▒рпБроорпН рокрпКро░рпБродрпНродрооро╛рой роорпБройрпНродропро╛ро░ро┐рокрпНрокрпИрокрпН рокропройрпНрокроЯрпБродрпНрод ро╡рпЗрогрпНроЯрпБроорпН. роЕродро┐ро░рпНро╖рпНроЯро╡роЪрооро╛роХ, роЯрпЛроХрпНроХройрпИроЪро░рпН роТро░рпБ роЬрпЛроЯро┐ роЪрпАроХрпНро╡рпЖройрпНро╕рпНроХро│рпИропрпБроорпН роОроЯрпБродрпНродрпБ, роТро░рпБ BERT-рокрпЛройрпНро▒ рооро╛роЯро▓рпН роОродро┐ро░рпНрокро╛ро░рпНроХрпНроХрпБроорпН ро╡ро┤ро┐ропро┐ро▓рпН роЕродрпИродрпН родропро╛ро░ро┐роХрпНроХ роорпБроЯро┐ропрпБроорпН:

```python
inputs = tokenizer("This is the first sentence.", "This is the second one.")
inputs
```

```python out
{ 
  'input_ids': [101, 2023, 2003, 1996, 2034, 6251, 1012, 102, 2023, 2003, 1996, 2117, 2028, 1012, 102],
  'token_type_ids': [0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1],
  'attention_mask': [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1]
}
```

`input_ids` рооро▒рпНро▒рпБроорпН `attention_mask` рокрпБро▓роЩрпНроХро│рпН рокро▒рпНро▒ро┐ роЕродрпНродро┐ропро╛ропроорпН 2-ро▓рпН ро╡ро┐ро╡ро╛родро┐родрпНродрпЛроорпН, роЖройро╛ро▓рпН `token_type_ids` рокрпБродро┐ропродрпБ. роорпЗро▓рпЗ роЙро│рпНро│ роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯро┐ро▓рпН, роЙро│рпНро│рпАроЯрпНроЯро┐ройрпН роОроирпНродрокрпН рокроХрпБродро┐ роорпБродро▓рпН ро╡ро╛роХрпНроХро┐ропроорпН рооро▒рпНро▒рпБроорпН роОроирпНродрокрпН рокроХрпБродро┐ роЗро░рогрпНроЯро╛ро╡родрпБ ро╡ро╛роХрпНроХро┐ропроорпН роОройрпНрокродрпИ рооро╛роЯро▓рпБроХрпНроХрпБ роЗродрпБродро╛ройрпН роЪрпКро▓рпНроХро┐ро▒родрпБ. роЯрпЛроХрпНроХройрпИроЪро░рпН роироороХрпНроХро╛роХ `[CLS]` рооро▒рпНро▒рпБроорпН `[SEP]` роОройрпНро▒ роЪро┐ро▒рокрпНрокрпБ роЯрпЛроХрпНроХройрпНроХро│рпИроЪрпН роЪрпЗро░рпНродрпНродро┐ро░рпБрокрпНрокродрпИ роХро╡ройро┐ропрпБроЩрпНроХро│рпН:

```python
tokenizer.convert_ids_to_tokens(inputs["input_ids"])
```

```python out
['[CLS]', 'this', 'is', 'the', 'first', 'sentence', '.', '[SEP]', 'this', 'is', 'the', 'second', 'one', '.', '[SEP]']
[      0,      0,    0,     0,       0,          0,   0,       0,      1,    1,     1,        1,     1,   1,       1]
```
роирпАроЩрпНроХро│рпН рокро╛ро░рпНрокрпНрокродрпБ рокрпЛро▓рпН, `[CLS] sentence1 [SEP]`-роХрпНроХрпБ роТродрпНрод роЙро│рпНро│рпАроЯрпНроЯро┐ройрпН рокроХрпБродро┐роХро│рпН роЕройрпИродрпНродрпБроорпН `0` роОройрпНро▒ роЯрпЛроХрпНроХройрпН ро╡роХрпИ роРроЯро┐ропрпИроХрпН роХрпКрогрпНроЯрпБро│рпНро│рой, роЕродрпЗ роирпЗро░родрпНродро┐ро▓рпН `sentence2 [SEP]`-роХрпНроХрпБ роТродрпНрод рооро▒рпНро▒ рокроХрпБродро┐роХро│рпН роЕройрпИродрпНродрпБроорпН `1` роОройрпНро▒ роЯрпЛроХрпНроХройрпН ро╡роХрпИ роРроЯро┐ропрпИроХрпН роХрпКрогрпНроЯрпБро│рпНро│рой.

роирпАроЩрпНроХро│рпН ро╡рпЗро▒рпБ роТро░рпБ роЪрпЖроХрпНрокро╛ропро┐рогрпНроЯрпНроЯрпИродрпН родрпЗро░рпНроирпНродрпЖроЯрпБродрпНродро╛ро▓рпН, роЙроЩрпНроХро│рпН роЯрпЛроХрпНроХройрпИро╕рпН роЪрпЖропрпНропрокрпНрокроЯрпНроЯ роЙро│рпНро│рпАроЯрпБроХро│ро┐ро▓рпН `token_type_ids` роЗро░рпБроХрпНроХ ро╡рпЗрогрпНроЯро┐роп роЕро╡роЪро┐ропрооро┐ро▓рпНро▓рпИ (роЙродро╛ро░рогрооро╛роХ, роирпАроЩрпНроХро│рпН роТро░рпБ DistilBERT рооро╛роЯро▓рпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ройро╛ро▓рпН роЕро╡рпИ родро┐ро░рпБроорпНрокрокрпН рокрпЖро▒рокрпНрокроЯро╛родрпБ). рооро╛роЯро▓рпН роЕро╡ро▒рпНро▒рпИроХрпН роХрпКрогрпНроЯрпБ роОройрпНрой роЪрпЖропрпНро╡родрпБ роОройрпНро▒рпБ родрпЖро░ро┐роирпНродро╛ро▓рпН роороЯрпНроЯрпБроорпЗ роЕро╡рпИ родро┐ро░рпБроорпНрокрокрпН рокрпЖро▒рокрпНрокроЯрпБроорпН, роПройрпЖройро┐ро▓рпН роЕродрпБ роЕродройрпН роорпБройрпНродропро╛ро░ро┐рокрпНрокро┐ройрпН рокрпЛродрпБ роЕро╡ро▒рпНро▒рпИрокрпН рокро╛ро░рпНродрпНродро┐ро░рпБроХрпНроХрпБроорпН.

BERT рооро╛роЯро▓рпНроХро│рпБроХрпНроХрпБ, роЗродрпБ роОродро┐ро░рпНрокро╛ро░рпНроХрпНроХрокрпНрокроЯрпБроорпН роЙро│рпНро│рпАроЯрпНроЯрпБ ро╡роЯро┐ро╡роорпН. роироорпНрооро┐роЯроорпН `sentences1` рооро▒рпНро▒рпБроорпН `sentences2` роОройрпНро▒ роЗро░рогрпНроЯрпБ ро╡ро╛роХрпНроХро┐ропрокрпН рокроЯрпНроЯро┐ропро▓рпНроХро│рпН роЗро░рпБроирпНродро╛ро▓рпН, роЕро╡ро▒рпНро▒рпИ роТройрпНро▒ро╛роХ роЯрпЛроХрпНроХройрпИро╕рпН роЪрпЖропрпНропро▓ро╛роорпН:

```python
tokenizer(sentences1, sentences2)
```

роироородрпБ роорпБро┤рпБ роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯрпИ роорпБройрпНродропро╛ро░ро┐роХрпНроХ, роиро╛роорпН роЕройрпИродрпНродрпБ ро╡ро╛роХрпНроХро┐роп роЬрпЛроЯро┐роХро│рпИропрпБроорпН роЯрпЛроХрпНроХройрпИро╕рпН роЪрпЖропрпНроп ро╡рпЗрогрпНроЯрпБроорпН. `raw_datasets`-роР роорпАрогрпНроЯрпБроорпН роорпАрогрпНроЯрпБроорпН роЪрпЖропрпНро╡родройрпН роорпВро▓роорпН роЕродрпИроЪрпН роЪрпЖропрпНропро▓ро╛роорпН, роЖройро╛ро▓рпН ЁЯдЧ Datasets ро▓рпИрокрпНро░ро░ро┐ роТро░рпБ `map()` роорпБро▒рпИропрпИ ро╡ро┤роЩрпНроХрпБроХро┐ро▒родрпБ, роЗродрпБ роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯро┐ройрпН роТро╡рпНро╡рпКро░рпБ роЙро▒рпБрокрпНрокро┐ро▓рпБроорпН роТро░рпБ роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБроорпН.

```py
def tokenize_function(example):
    return tokenizer(example["sentence1"], example["sentence2"], truncation=True)


tokenized_datasets = raw_datasets.map(tokenize_function, batched=True)
tokenized_datasets
```

```python out
DatasetDict({
    train: Dataset({
        features: ['attention_mask', 'idx', 'input_ids', 'label', 'sentence1', 'sentence2', 'token_type_ids'],
        num_rows: 3668
    })
    validation: Dataset({
        features: ['attention_mask', 'idx', 'input_ids', 'label', 'sentence1', 'sentence2', 'token_type_ids'],
        num_rows: 408
    })
    test: Dataset({
        features: ['attention_mask', 'idx', 'input_ids', 'label', 'sentence1', 'sentence2', 'token_type_ids'],
        num_rows: 1725
    })
})
```
роЙроЩрпНроХро│рпН роорпБройрпНродропро╛ро░ро┐рокрпНрокрпБроЪрпН роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБроорпНрокрпЛродрпБ `num_proc` роОройрпНро▒ роЖро░рпНроХрпБроорпЖрогрпНроЯрпНроЯрпИ роЕройрпБрокрпНрокрпБро╡родройрпН роорпВро▓роорпН роирпАроЩрпНроХро│рпН рооро▓рпНроЯро┐рокро┐ро░ро╛роЪроЪро┐роЩрпНроХрпИрокрпН рокропройрпНрокроЯрпБродрпНродро▓ро╛роорпН. ЁЯдЧ Tokenizers ро▓рпИрокрпНро░ро░ро┐ роПро▒рпНроХройро╡рпЗ роироородрпБ рооро╛родро┐ро░ро┐роХро│рпИ ро╡рпЗроХрооро╛роХ роЯрпЛроХрпНроХройрпИро╕рпН роЪрпЖропрпНроп рокро▓ родрпНро░рпЖроЯрпНроХро│рпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡родро╛ро▓рпН роиро╛роЩрпНроХро│рпН роЗроЩрпНроХрпЗ роЗродрпИроЪрпН роЪрпЖропрпНропро╡ро┐ро▓рпНро▓рпИ, роЖройро╛ро▓рпН роирпАроЩрпНроХро│рпН ро░ро╕рпНроЯрпН роЖродро░ро╡рпБ роХрпКрогрпНроЯ ро╡рпЗроХрооро╛рой роЯрпЛроХрпНроХройрпИроЪро░рпИрокрпН рокропройрпНрокроЯрпБродрпНродро╡ро┐ро▓рпНро▓рпИ роОройрпНро▒ро╛ро▓рпН, роЗродрпБ роЙроЩрпНроХро│рпН роорпБройрпНродропро╛ро░ро┐рокрпНрокрпИ ро╡рпЗроХрокрпНрокроЯрпБродрпНродроХрпНроХрпВроЯрпБроорпН.

роиро╛роорпН роЪрпЖропрпНроп ро╡рпЗрогрпНроЯро┐роп роХроЯрпИроЪро┐ ро╡ро┐ро╖ропроорпН, роиро╛роорпН рокрпЗроЯрпНроЪрпН роХрпВро▒рпБроХро│рпИ роТройрпНро▒ро╛роХ роЗрогрпИроХрпНроХрпБроорпНрокрпЛродрпБ роЕройрпИродрпНродрпБ роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпБроХро│рпИропрпБроорпН рооро┐роХ роирпАро│рооро╛рой роЙро▒рпБрокрпНрокро┐ройрпН роирпАро│родрпНродро┐ро▒рпНроХрпБ рокрпЗроЯрпН (pad) роЪрпЖропрпНро╡родрпБ тАФ роЗроирпНрод роирпБроЯрпНрокродрпНродрпИ роиро╛роорпН *роЯрпИройрооро┐роХрпН рокрпЗроЯро┐роЩрпН* (dynamic padding) роОройрпНро▒рпБ роХрпБро▒ро┐рокрпНрокро┐роЯрпБроХро┐ро▒рпЛроорпН.

##### роЯрпИройрооро┐роХрпН рокрпЗроЯро┐роЩрпН[[dynamic-padding]]

<Youtube id="7q5NyFT8REg"/>

роТро░рпБ рокрпЗроЯрпНроЪрпНроЪро┐ро▓рпН роЙро│рпНро│ рооро╛родро┐ро░ро┐роХро│рпИ роТройрпНро▒ро╛роХ ро╡рпИрокрпНрокродро▒рпНроХрпБрокрпН рокрпКро▒рпБрокрпНрокро╛рой роЪрпЖропро▓рпНрокро╛роЯрпБ *роЯрпЗроЯрпНроЯро╛ роХрпЛро▓рпЗроЯрпНроЯро░рпН* (data collator) роОройрпНро▒рпБ роЕро┤рпИроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ. роЗродрпБ роирпАроЩрпНроХро│рпН роТро░рпБ `DataLoader`-роР роЙро░рпБро╡ро╛роХрпНроХрпБроорпНрокрпЛродрпБ роЕройрпБрокрпНрокроХрпНроХрпВроЯро┐роп роТро░рпБ роЖро░рпНроХрпБроорпЖрогрпНроЯрпН роЖроХрпБроорпН, роЗропро▓рпНрокро╛роХ роЗродрпБ роЙроЩрпНроХро│рпН рооро╛родро┐ро░ро┐роХро│рпИ PyTorch роЯрпЖройрпНроЪро░рпНроХро│ро╛роХ рооро╛ро▒рпНро▒ро┐ роЕро╡ро▒рпНро▒рпИ роЗрогрпИроХрпНроХрпБроорпН роТро░рпБ роЪрпЖропро▓рпНрокро╛роЯро╛роХрпБроорпН (роЙроЩрпНроХро│рпН роХрпВро▒рпБроХро│рпН рокроЯрпНроЯро┐ропро▓рпНроХро│рпН, роЯрпВрокрпНрокро┐ро│рпНроХро│рпН роЕро▓рпНро▓родрпБ роЕроХро░ро╛родро┐роХро│ро╛роХ роЗро░рпБроирпНродро╛ро▓рпН роорпАрогрпНроЯрпБроорпН роорпАрогрпНроЯрпБроорпН).

<Tip>

ЁЯУЦ **роорпЗро▓рпБроорпН роЕро▒ро┐роХ**: роЯрпЗроЯрпНроЯро╛ роХрпЛро▓рпЗроЯрпНроЯро░рпНроХро│рпН рокро▒рпНро▒ро┐роп роЖро┤рооро╛рой родроХро╡ро▓рпНроХро│рпБроХрпНроХрпБ, роОроЩрпНроХро│рпН [роЖро╡рогроЩрпНроХро│рпИрокрпН](https://huggingface.co/docs/transformers/main/en/main_classes/data_collator) рокро╛ро░рпНроХрпНроХро╡рпБроорпН.

</Tip>

роироородрпБ ро╡ро┐ро╖ропродрпНродро┐ро▓рпН, роЙро│рпНро│рпАроЯрпБроХро│рпН роЕройрпИродрпНродрпБроорпН роТро░рпЗ роЕро│ро╡ро┐ро▓рпН роЗро▓рпНро▓рпИ. роТро╡рпНро╡рпКро░рпБ рокрпЗроЯрпНроЪрпНроЪро┐ро▓рпБроорпН родрпЗро╡рпИроХрпНроХрпЗро▒рпНрок рокрпЗроЯро┐роЩрпНроХрпИрокрпН рокропройрпНрокроЯрпБродрпНрод ро╡рпЗрогрпНроЯрпБроорпН, роорпЗро▓рпБроорпН рокрпКро░рпБродрпНродрооро╛рой роорпБройрпНродропро╛ро░ро┐рокрпНрокрпИрокрпН рокропройрпНрокроЯрпБродрпНрод ро╡рпЗрогрпНроЯрпБроорпН. роЕродро┐ро░рпНро╖рпНроЯро╡роЪрооро╛роХ, роЯрпЛроХрпНроХройрпИроЪро░рпН роТро░рпБ роЬрпЛроЯро┐ роЪрпАроХрпНро╡рпЖройрпНро╕рпНроХро│рпИропрпБроорпН роОроЯрпБродрпНродрпБ, роТро░рпБ BERT-рокрпЛройрпНро▒ рооро╛роЯро▓рпН роОродро┐ро░рпНрокро╛ро░рпНроХрпНроХрпБроорпН ро╡ро┤ро┐ропро┐ро▓рпН роЕродрпИродрпН родропро╛ро░ро┐роХрпНроХ роорпБроЯро┐ропрпБроорпН.

```py
from transformers import DataCollatorWithPadding

data_collator = DataCollatorWithPadding(tokenizer=tokenizer)
```

роЗроирпНродроЪрпН роЪрпЖропро▓рпНрокро╛роЯрпБ роироородрпБ рокродрокрпНрокроЯрпБродрпНродрокрпНрокроЯрпНроЯ рооро╛родро┐ро░ро┐роХро│рпИ роОроЯрпБродрпНродрпБ, роироороХрпНроХрпБродрпН родрпЗро╡рпИропро╛рой роЕройрпИродрпНродрпИропрпБроорпН роЪрпЖропрпНропрпБроорпН:

```py
samples = tokenized_datasets["train"][:8]
samples = {k: v for k, v in samples.items() if k not in ["idx", "sentence1", "sentence2"]}
batch = data_collator(samples)
{k: v.shape for k, v in batch.items()}
```

```python out
{'attention_mask': torch.Size([8, 67]),
 'input_ids': torch.Size([8, 67]),
 'labels': torch.Size([8]),
 'token_type_ids': torch.Size([8, 67])}
```

роЕро╡рпНро╡ро│ро╡рпБродро╛ройрпН! роиро╛роорпН роорпВро▓ роЙро░рпИропро┐ро▓ро┐ро░рпБроирпНродрпБ роироородрпБ рооро╛роЯро▓рпБроХрпНроХрпБ ро╡ро┤роЩрпНроХродрпН родропро╛ро░ро╛роХ роЙро│рпНро│ рокрпЗроЯрпНроЪрпНроХро│рпБроХрпНроХрпБ ро╡роирпНродрпБро╡ро┐роЯрпНроЯрпЛроорпН. роЕроЯрпБродрпНрод рокроХрпБродро┐ропро┐ро▓рпН, роТро░рпБ рооро╛роЯро▓рпИ роГрокрпИройрпН-роЯро┐ропрпВройрпН роЪрпЖропрпНроп роЗродрпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡рпЛроорпН.

<Tip>

ЁЯУЦ **роХрпВроЯрпБродро▓рпН рокропро┐ро▒рпНроЪро┐**: [ЁЯдЧ Transformers роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпБроХро│ро┐ро▓ро┐ро░рпБроирпНродрпБ](https://huggingface.co/docs/transformers/main/en/notebooks) роЗроирпНрод роироЯрпИроорпБро▒рпИ роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпБроХро│рпИрокрпН рокро╛ро░рпБроЩрпНроХро│рпН.

</Tip>

### 1. `Dataset.map()` роЪрпЖропро▓рпНрокро╛роЯрпНроЯро┐ро▓рпН `batched=True` роРрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡родройрпН роорпБроХрпНроХро┐роп роиройрпНроорпИ роОройрпНрой?

<Question
	choices={[
		{
			text: "роЗродрпБ рокро▓ CPU-роХро│ро┐ро▓рпН роЗрогрпИроЪрпН роЪрпЖропро▓ро╛роХрпНроХродрпНродрпИ роЕройрпБроородро┐роХрпНроХро┐ро▒родрпБ.",
			explain: "роЗрогрпИроЪрпН роЪрпЖропро▓ро╛роХрпНроХродрпНродро┐ро▒рпНроХрпБ `num_proc` роЕро│ро╡рпБро░рпБро╡рпИрокрпН рокропройрпНрокроЯрпБродрпНрод ро╡рпЗрогрпНроЯрпБроорпН."
		},
		{
			text: "роЗродрпБ роЯрпЛроХрпНроХройрпИроЪро░ро┐ройрпН ро╡рпЗроХрооро╛рой (ро░ро╕рпНроЯрпН роЕроЯро┐рокрпНрокроЯрпИропро┐ро▓ро╛рой) рокродро┐рокрпНрокрпБроХро│рпИрокрпН рокропройрпНрокроЯрпБродрпНрод роЕройрпБроородро┐роХрпНроХро┐ро▒родрпБ.",
			explain: "роЪро░ро┐! `batched=True` роЙроЯройрпН `map` роРрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡родрпБ ро╡рпЗроХрооро╛рой роЯрпЛроХрпНроХройрпИроЪро░рпИ роорпБро┤рпБроорпИропро╛роХрокрпН рокропройрпНрокроЯрпБродрпНрод роЕройрпБроородро┐роХрпНроХро┐ро▒родрпБ.",
            correct: true
		},
		{
			text: "роЗродрпБ родро╛ройро╛роХро╡рпЗ роЙроЩрпНроХро│рпБроХрпНроХро╛роХ рокрпЗроЯро┐роЩрпНроХрпИроХрпН роХрпИропро╛ро│рпБроХро┐ро▒родрпБ.",
			explain: "рокрпЗроЯрпНроЪрпНроЪро┐роЩрпН родро╛ройро╛роХ рокрпЗроЯро┐роЩрпНроХрпИроХрпН роХрпИропро╛ро│ро╛родрпБ - роЕродрпБ роЯрпЗроЯрпНроЯро╛ роХрпЛро▓рпЗроЯрпНроЯро░рпН роорпВро▓роорпН роЪрпЖропрпНропрокрпНрокроЯрпБроХро┐ро▒родрпБ."
		},
        {
			text: "роЗродрпБ родро░ро╡рпИ PyTorch роЯрпЖройрпНроЪро░рпНроХро│ро╛роХ рооро╛ро▒рпНро▒рпБроХро┐ро▒родрпБ.",
			explain: "роЯрпЖройрпНроЪро░рпН рооро╛ро▒рпНро▒роорпН роирпАроЩрпНроХро│рпН ро╡роЯро┐ро╡родрпНродрпИ роЕроорпИроХрпНроХрпБроорпНрокрпЛродрпБ роиро┐роХро┤рпНроХро┐ро▒родрпБ, рокрпЗроЯрпНроЪрпН роорпЗрокрпНрокро┐роЩрпНроХро┐ройрпН рокрпЛродрпБ роЕро▓рпНро▓."
		}
	]}
/>

### 2. роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯро┐ро▓рпН роЙро│рпНро│ роЕродро┐роХрокроЯрпНроЪ роирпАро│родрпНродро┐ро▒рпНроХрпБ роЕройрпИродрпНродрпБ роЪрпАроХрпНро╡рпЖройрпНро╕рпНроХро│рпИропрпБроорпН рокрпЗроЯрпН роЪрпЖропрпНро╡родро▒рпНроХрпБрокрпН рокродро┐ро▓ро╛роХ роЯрпИройрооро┐роХрпН рокрпЗроЯро┐роЩрпНроХрпИ роПройрпН рокропройрпНрокроЯрпБродрпНродрпБроХро┐ро▒рпЛроорпН?

<Question
	choices={[
		{
			text: "роЯрпИройрооро┐роХрпН рокрпЗроЯро┐роЩрпН рооро╛роЯро▓рпН роХроЯрпНроЯроорпИрокрпНрокро╛ро▓рпН родрпЗро╡рпИрокрпНрокроЯрпБроХро┐ро▒родрпБ.",
			explain: "роЗро▓рпНро▓рпИ, рооро╛роЯро▓рпНроХро│рпН роиро┐ро▓рпИропро╛рой рооро▒рпНро▒рпБроорпН роЯрпИройрооро┐роХрпН рокрпЗроЯро┐роЩрпН роЗро░рогрпНроЯрпИропрпБроорпН роХрпИропро╛ро│ роорпБроЯро┐ропрпБроорпН."
		},
		{
			text: "роЗродрпБ роТро╡рпНро╡рпКро░рпБ рокрпЗроЯрпНроЪрпНроЪро┐ро▓рпБроорпН роЕродро┐роХрокроЯрпНроЪ роирпАро│родрпНродро┐ро▒рпНроХрпБ роороЯрпНроЯрпБроорпЗ рокрпЗроЯрпН роЪрпЖропрпНро╡родройрпН роорпВро▓роорпН роХрогроХрпНроХрпАроЯрпНроЯрпБроЪрпН роЪрпБроорпИропрпИроХрпН роХрпБро▒рпИроХрпНроХро┐ро▒родрпБ.",
			explain: "роЪро░ро┐! роЯрпИройрооро┐роХрпН рокрпЗроЯро┐роЩрпН рокрпЗроЯрпНроЪрпН роЕродро┐роХрокроЯрпНроЪродрпНродро┐ро▒рпНроХрпБ роороЯрпНроЯрпБроорпЗ рокрпЗроЯрпН роЪрпЖропрпНро╡родройрпН роорпВро▓роорпН рокрпЗроЯро┐роЩрпН роЯрпЛроХрпНроХройрпНроХро│ро┐ро▓рпН родрпЗро╡рпИропро▒рпНро▒ роХрогроХрпНроХрпАроЯрпНроЯрпИродрпН родро╡ро┐ро░рпНроХрпНроХро┐ро▒родрпБ, роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпН роЕродро┐роХрокроЯрпНроЪродрпНродро┐ро▒рпНроХрпБ роЕро▓рпНро▓.",
            correct: true
		},
		{
			text: "роЗродрпБ рооро╛роЯро▓рпН родрпБро▓рпНро▓ро┐ропродрпНродрпИ роорпЗроорпНрокроЯрпБродрпНродрпБроХро┐ро▒родрпБ.",
			explain: "рокрпЗроЯро┐роЩрпН роЙродрпНродро┐ роирпЗро░роЯро┐ропро╛роХ рооро╛роЯро▓рпН родрпБро▓рпНро▓ро┐ропродрпНродрпИрокрпН рокро╛родро┐роХрпНроХро╛родрпБ."
		},
        {
			text: "DataCollatorWithPadding-роРрокрпН рокропройрпНрокроЯрпБродрпНродрпБроорпНрокрпЛродрпБ роЗродрпБ родрпЗро╡рпИрокрпНрокроЯрпБроХро┐ро▒родрпБ.",
			explain: "DataCollatorWithPadding роЯрпИройрооро┐роХрпН рокрпЗроЯро┐роЩрпНроХрпИ роЪрпЖропро▓рпНрокроЯрпБродрпНродрпБроХро┐ро▒родрпБ, роЖройро╛ро▓рпН роирпАроЩрпНроХро│рпН ро╡ро┐ро░рпБроорпНрокро┐ройро╛ро▓рпН роиро┐ро▓рпИропро╛рой рокрпЗроЯро┐роЩрпНроХрпИрокрпН рокропройрпНрокроЯрпБродрпНродро▓ро╛роорпН."
		}
	]}
/>

### 3. BERT роЯрпЛроХрпНроХройрпИроЪрпЗро╖ройро┐ро▓рпН `token_type_ids` рокрпБро▓роорпН роОродрпИроХрпН роХрпБро▒ро┐роХрпНроХро┐ро▒родрпБ?

<Question
	choices={[
		{
			text: "роЪрпАроХрпНро╡рпЖройрпНро╕ро┐ро▓рпН роЙро│рпНро│ роТро╡рпНро╡рпКро░рпБ роЯрпЛроХрпНроХройро┐ройрпН роиро┐ро▓рпИ.",
			explain: "роЕродрпБ роиро┐ро▓рпИ роЙроЯрпНрокрпКродро┐ро╡рпБроХро│ро╛роХ роЗро░рпБроХрпНроХрпБроорпН, token_type_ids роЕро▓рпНро▓."
		},
		{
			text: "ро╡ро╛роХрпНроХро┐роп роЬрпЛроЯро┐роХро│рпИроЪрпН роЪрпЖропро▓ро╛роХрпНроХрпБроорпНрокрпЛродрпБ роТро╡рпНро╡рпКро░рпБ роЯрпЛроХрпНроХройрпБроорпН роОроирпНрод ро╡ро╛роХрпНроХро┐ропродрпНродрпИроЪрпН роЪрпЗро░рпНроирпНродродрпБ.",
			explain: "роЪро░ро┐! token_type_ids роорпБродро▓рпН ро╡ро╛роХрпНроХро┐ропроорпН (0) рооро▒рпНро▒рпБроорпН роЗро░рогрпНроЯро╛ро╡родрпБ ро╡ро╛роХрпНроХро┐ропроорпН (1) роЖроХро┐ропро╡ро▒рпНро▒рпБроХрпНроХрпБ роЗроЯрпИропрпЗ ро╡ро╛роХрпНроХро┐роп роЬрпЛроЯро┐рокрпН рокрогро┐роХро│ро┐ро▓рпН ро╡рпЗро▒рпБрокроЯрпБродрпНродрпБроХро┐ройрпНро▒рой.",
            correct: true
		},
		{
			text: "роТро╡рпНро╡рпКро░рпБ роЯрпЛроХрпНроХройрпБроХрпНроХро╛рой роХро╡ройроХрпН роХро╡роЪроорпН.",
			explain: "роХро╡ройроХрпН роХро╡роЪроорпН роОройрпНрокродрпБ роОроирпНрод роЯрпЛроХрпНроХройрпНроХро│рпБроХрпНроХрпБроХрпН роХро╡ройроорпН роЪрпЖро▓рпБродрпНрод ро╡рпЗрогрпНроЯрпБроорпН роОройрпНрокродрпИроХрпН роХрпБро▒ро┐роХрпНроХрпБроорпН роТро░рпБ родройро┐рокрпН рокрпБро▓рооро╛роХрпБроорпН."
		},
        {
			text: "роТро╡рпНро╡рпКро░рпБ роЯрпЛроХрпНроХройро┐ройрпН роЪрпКро▓рпНро▓роХро░ро╛родро┐ роРроЯро┐.",
			explain: "роЕродрпБ input_ids рокрпБро▓роорпН, token_type_ids роЕро▓рпНро▓."
		}
{{ ... }}
/>

### 4. `load_dataset('glue', 'mrpc')` роЙроЯройрпН роТро░рпБ роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯрпИ роПро▒рпНро▒рпБроорпНрокрпЛродрпБ, роЗро░рогрпНроЯро╛ро╡родрпБ роЖро░рпНроХрпБроорпЖрогрпНроЯрпН роОродрпИроХрпН роХрпБро▒ро┐рокрпНрокро┐роЯрпБроХро┐ро▒родрпБ?

<Question
	choices={[
		{
			text: "роПро▒рпНро▒ ро╡рпЗрогрпНроЯро┐роп роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯро┐ройрпН рокродро┐рокрпНрокрпБ.",
			explain: "рокродро┐рокрпНрокрпБ ро╡ро┐ро╡ро░роХрпНроХрпБро▒ро┐рокрпНрокрпБ ро╡рпЖро╡рпНро╡рпЗро▒рпБ роЕро│ро╡рпБро░рпБроХрпНроХро│рпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБроХро┐ро▒родрпБ."
		},
		{
			text: "GLUE рокрпЖроЮрпНроЪрпНрооро╛ро░рпНроХрпНроХро┐ро▒рпНроХрпБро│рпН роЙро│рпНро│ роХрпБро▒ро┐рокрпНрокро┐роЯрпНроЯ рокрогро┐ роЕро▓рпНро▓родрпБ родрпБрогрпИроХрпНроХрпБро┤рпБ.",
			explain: "роЪро░ро┐! MRPC роОройрпНрокродрпБ рокрпЖро░ро┐роп GLUE рокрпЖроЮрпНроЪрпНрооро╛ро░рпНроХрпН роЪрпЗроХро░ро┐рокрпНрокро┐ро▒рпНроХрпБро│рпН роЙро│рпНро│ роХрпБро▒ро┐рокрпНрокро┐роЯрпНроЯ рокрогро┐роХро│ро┐ро▓рпН роТройрпНро▒ро╛роХрпБроорпН.",
            correct: true
		},
		{
			text: "роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯро┐ройрпН рокро┐ро░ро┐ро╡рпБ (train/validation/test).",
			explain: "рокро┐ро░ро┐ро╡рпБроХро│рпН роПро▒рпНро▒рокрпНрокроЯрпНроЯ рокро┐ро▒роХрпБ роЕрогрпБроХрокрпНрокроЯрпБроХро┐ройрпНро▒рой, load_dataset роЕро┤рпИрокрпНрокро┐ро▓рпН роХрпБро▒ро┐рокрпНрокро┐роЯрокрпНрокроЯро╡ро┐ро▓рпНро▓рпИ."
		},
        {
			text: "родро░ро╡рпИродрпН родро┐ро░рпБрокрпНрокро┐ропро│ро┐роХрпНроХ ро╡рпЗрогрпНроЯро┐роп ро╡роЯро┐ро╡роорпН.",
			explain: "ро╡роЯро┐ро╡роорпН роПро▒рпНро▒рокрпНрокроЯрпНроЯ рокро┐ро▒роХрпБ set_format() роорпБро▒рпИропрпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ роЕроорпИроХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ."
		}
	]}
/>

### 5. рокропро┐ро▒рпНроЪро┐роХрпНроХрпБ роорпБройрпН 'sentence1' рооро▒рпНро▒рпБроорпН 'sentence2' рокрпЛройрпНро▒ рокродрпНродро┐роХро│рпИ роЕроХро▒рпНро▒рпБро╡родройрпН роирпЛроХрпНроХроорпН роОройрпНрой?

<Question
	choices={[
		{
			text: "рокропро┐ро▒рпНроЪро┐ропро┐ройрпН рокрпЛродрпБ роиро┐ройрпИро╡роХродрпНродрпИроЪрпН роЪрпЗрооро┐роХрпНроХ.",
			explain: "роЗродрпБ роХрпКроЮрпНроЪроорпН роиро┐ройрпИро╡роХродрпНродрпИроЪрпН роЪрпЗрооро┐родрпНродро╛ро▓рпБроорпН, роЗродрпБ роорпБроХрпНроХро┐роп роХро╛ро░рогроорпН роЕро▓рпНро▓."
		},
		{
			text: "рооро╛роЯро▓рпН роЗроирпНрод роорпВро▓ роЙро░рпИрокрпН рокродрпНродро┐роХро│рпИ роОродро┐ро░рпНрокро╛ро░рпНроХрпНроХро╛родрпБ рооро▒рпНро▒рпБроорпН роТро░рпБ рокро┐ро┤рпИропрпИ роПро▒рпНрокроЯрпБродрпНродрпБроорпН.",
			explain: "роЪро░ро┐! рооро╛роЯро▓рпНроХро│рпН роОрогрпН роЯрпЖройрпНроЪро░рпНроХро│рпИ роОродро┐ро░рпНрокро╛ро░рпНроХрпНроХро┐ройрпНро▒рой, роорпВро▓ роЙро░рпИ роЪро░роЩрпНроХро│рпИ роЕро▓рпНро▓. роЙро░рпИрокрпН рокродрпНродро┐роХро│рпИ ро╡рпИродрпНродро┐ро░рпБрокрпНрокродрпБ рокро┐ро┤рпИроХро│рпИ роПро▒рпНрокроЯрпБродрпНродрпБроорпН.",
            correct: true
		},
		{
			text: "роородро┐рокрпНрокрпАроЯрпНроЯро┐ро▒рпНроХрпБ роЗроирпНродрокрпН рокродрпНродро┐роХро│рпН родрпЗро╡рпИропро┐ро▓рпНро▓рпИ.",
			explain: "роЙрогрпНроорпИропро╛роХ роЗро░рпБроирпНродро╛ро▓рпБроорпН, роорпБроХрпНроХро┐роп роХро╛ро░рогроорпН рооро╛роЯро▓рпН роорпВро▓ роЙро░рпИропрпИроЪрпН роЪрпЖропро▓ро╛роХрпНроХ роорпБроЯро┐ропро╛родрпБ роОройрпНрокродрпБродро╛ройрпН."
		},
        {
			text: "роЗродрпБ рокропро┐ро▒рпНроЪро┐ ро╡рпЗроХродрпНродрпИ роХрогро┐роЪрооро╛роХ роорпЗроорпНрокроЯрпБродрпНродрпБроХро┐ро▒родрпБ.",
			explain: "рокрпКро░рпБроирпНродро╛род родро░ро╡рпБ ро╡роХрпИроХро│ро┐ро▓ро┐ро░рпБроирпНродрпБ рокро┐ро┤рпИроХро│рпИродрпН родро╡ро┐ро░рпНрокрпНрокродрпЛроЯрпБ роТрокрпНрокро┐роЯрпБроорпНрокрпЛродрпБ ро╡рпЗроХ роорпЗроорпНрокро╛роЯрпБ рооро┐роХроХрпН роХрпБро▒рпИро╡рпБ."
		}
	]}
/>

<Tip>

ЁЯТб **роорпБроХрпНроХро┐роп роХрпБро▒ро┐рокрпНрокрпБроХро│рпН:**
- роХрогро┐роЪрооро╛роХ ро╡рпЗроХрооро╛рой роорпБройрпНродропро╛ро░ро┐рокрпНрокрпБроХрпНроХрпБ `Dataset.map()` роЙроЯройрпН `batched=True` роРрокрпН рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН
- `DataCollatorWithPadding` роЙроЯройрпН роЯрпИройрооро┐роХрпН рокрпЗроЯро┐роЩрпН роиро┐ро▓рпИропро╛рой роирпАро│ рокрпЗроЯро┐роЩрпНроХрпИ ро╡ро┐роЯ родро┐ро▒роорпИропро╛ройродрпБ
- роЙроЩрпНроХро│рпН рооро╛роЯро▓рпН роОродро┐ро░рпНрокро╛ро░рпНрокрпНрокро╡ро▒рпНро▒рпБроЯройрпН рокрпКро░рпБроирпНродрпБроорпНрокроЯро┐ роЙроЩрпНроХро│рпН родро░ро╡рпИ роОрокрпНрокрпЛродрпБроорпН роорпБройрпНродропро╛ро░ро┐роХрпНроХро╡рпБроорпН (роОрогрпН роЯрпЖройрпНроЪро░рпНроХро│рпН, роЪро░ро┐ропро╛рой рокродрпНродро┐рокрпН рокрпЖропро░рпНроХро│рпН)
- ЁЯдЧ Datasets ро▓рпИрокрпНро░ро░ро┐ рокрпЖро░ро┐роп роЕро│ро╡ро┐ро▓рпН родро┐ро▒роорпИропро╛рой родро░ро╡рпБ роЪрпЖропро▓ро╛роХрпНроХродрпНродро┐ро▒рпНроХро╛рой роЪроХрпНродро┐ро╡ро╛ропрпНроирпНрод роХро░рпБро╡ро┐роХро│рпИ ро╡ро┤роЩрпНроХрпБроХро┐ро▒родрпБ

</Tip>
