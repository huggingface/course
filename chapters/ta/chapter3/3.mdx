<FrameworkSwitchCourse {fw} />

# Trainer API-роРрокрпН рокропройрпНрокроЯрпБродрпНродро┐ роТро░рпБ рооро╛роЯро▓рпИ Fine-tuning роЪрпЖропрпНродро▓рпН[[fine-tuning-a-model-with-the-trainer-api]]

<CourseFloatingBanner chapter={3}
  classNames="absolute z-10 right-0 top-0"
  notebooks={[
    {label: "Google Colab", value: "https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/ta/chapter3/section3.ipynb"},
    {label: "Aws Studio", value: "https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/ta/chapter3/section3.ipynb"},
]} />

<Youtube id="nvBXf7s7vTI"/>

ЁЯдЧ Transformers, `Trainer` роОройрпНро▒ роТро░рпБ class-роР ро╡ро┤роЩрпНроХрпБроХро┐ро▒родрпБ. роЗродрпБ, роиро╡рпАрой роЪро┐ро▒роирпНрод роироЯрпИроорпБро▒рпИроХро│рпБроЯройрпН роЙроЩрпНроХро│рпН роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯро┐ро▓рпН роЙро│рпНро│ роОроирпНродро╡рпКро░рпБ pretrained рооро╛роЯро▓рпНроХро│рпИропрпБроорпН fine-tune роЪрпЖропрпНроп роЙродро╡рпБроХро┐ро▒родрпБ. роХроЯроирпНрод рокроХрпБродро┐ропро┐ро▓рпН роЙро│рпНро│ роЕройрпИродрпНродрпБ родро░ро╡рпБ роорпБройрпНродропро╛ро░ро┐рокрпНрокрпБ ро╡рпЗро▓рпИроХро│рпИропрпБроорпН роирпАроЩрпНроХро│рпН роЪрпЖропрпНродро╡рпБроЯройрпН, `Trainer`-роР ро╡ро░рпИропро▒рпБроХрпНроХ роЪро┐ро▓ рокроЯро┐роХро│рпН роороЯрпНроЯрпБроорпЗ роЙро│рпНро│рой. `Trainer.train()`-роР роЗропроХрпНроХ роЪрпВро┤ро▓рпИродрпН родропро╛ро░ро┐рокрпНрокродрпБ роХроЯро┐ройрооро╛рой рокроХрпБродро┐ропро╛роХ роЗро░рпБроХрпНроХро▓ро╛роорпН, роПройрпЖройро┐ро▓рпН роЗродрпБ роТро░рпБ CPU-ро╡ро┐ро▓рпН рооро┐роХ роорпЖродрпБро╡ро╛роХ роЗропроЩрпНроХрпБроорпН. роЙроЩрпНроХро│ро┐роЯроорпН GPU роЗро▓рпНро▓рпИ роОройрпНро▒ро╛ро▓рпН, [Google Colab](https://colab.research.google.com/)-роЗро▓рпН роЗро▓ро╡роЪ GPU-роХро│рпН роЕро▓рпНро▓родрпБ TPU-роХро│рпИрокрпН рокрпЖро▒ро▓ро╛роорпН.

<Tip>

ЁЯУЪ **рокропро┐ро▒рпНроЪро┐ роЖродро╛ро░роЩрпНроХро│рпН (Training Resources)**: рокропро┐ро▒рпНроЪро┐ропрпИродрпН родрпКроЯроЩрпНроХрпБро╡родро▒рпНроХрпБ роорпБройрпН, ро╡ро┐ро░ро┐ро╡ро╛рой [ЁЯдЧ Transformers рокропро┐ро▒рпНроЪро┐ ро╡ро┤ро┐роХро╛роЯрпНроЯро┐](https://huggingface.co/docs/transformers/main/en/training)-роРрокрпН рокроЯро┐родрпНродрпБ, [fine-tuning cookbook](https://huggingface.co/learn/cookbook/en/fine_tuning_code_llm_on_single_gpu)-роЗро▓рпН роЙро│рпНро│ роироЯрпИроорпБро▒рпИ роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпБроХро│рпИ роЖро░ро╛ропрпБроЩрпНроХро│рпН.

</Tip>

роХрпАро┤рпЗропрпБро│рпНро│ роХрпБро▒ро┐ропрпАроЯрпБ роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпБроХро│рпН, роорпБроирпНродрпИроп рокро┐ро░ро┐ро╡ро┐ро▓рпН роЙро│рпНро│ роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпБроХро│рпИ роирпАроЩрпНроХро│рпН роПро▒рпНроХройро╡рпЗ роЗропроХрпНроХро┐ро╡ро┐роЯрпНроЯрпАро░рпНроХро│рпН роОройрпНро▒рпБ роХро░рпБродрпБроХро┐ройрпНро▒рой. роЙроЩрпНроХро│рпБроХрпНроХрпБродрпН родрпЗро╡рпИропро╛ройро╡ро▒рпНро▒ро┐ройрпН роЪрпБро░рпБроХрпНроХрооро╛рой рооро▒рпБрокро░ро┐роЪрпАро▓ройрпИ роЗроЩрпНроХрпЗ:

```py
from datasets import load_dataset
from transformers import AutoTokenizer, DataCollatorWithPadding

{{...}}

tokenized_datasets = raw_datasets.map(tokenize_function, batched=True)
data_collator = DataCollatorWithPadding(tokenizer=tokenizer)
```

### рокропро┐ро▒рпНроЪро┐ (Training)[[training]]

роироородрпБ `Trainer`-роР ро╡ро░рпИропро▒рпБрокрпНрокродро▒рпНроХрпБ роорпБройрпН, роорпБродро▓рпН рокроЯро┐ропро╛роХ `TrainingArguments` роОройрпНро▒ class-роР ро╡ро░рпИропро▒рпБроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН. роЗродрпБ, `Trainer` рокропро┐ро▒рпНроЪро┐ рооро▒рпНро▒рпБроорпН роородро┐рокрпНрокрпАроЯрпНроЯро┐ро▒рпНроХрпБрокрпН рокропройрпНрокроЯрпБродрпНродрпБроорпН роЕройрпИродрпНродрпБ ро╣рпИрокрпНрокро░рпНрокро╛ро░ро╛роорпАроЯрпНроЯро░рпНроХро│рпИропрпБроорпН роХрпКрогрпНроЯро┐ро░рпБроХрпНроХрпБроорпН. роирпАроЩрпНроХро│рпН ро╡ро┤роЩрпНроХ ро╡рпЗрогрпНроЯро┐роп роТро░рпЗ роТро░рпБ argument, рокропро┐ро▒рпНроЪро┐ роЪрпЖропрпНропрокрпНрокроЯрпНроЯ рооро╛роЯро▓рпН роЪрпЗрооро┐роХрпНроХрокрпНрокроЯрпБроорпН роТро░рпБ роЯрпИро░роХрпНроЯро░ро┐ рооро▒рпНро▒рпБроорпН ро╡ро┤ро┐ропро┐ро▓рпН роЙро│рпНро│ роЪрпЖроХрпНрокро╛ропро┐рогрпНроЯрпНроХро│рпН роЖроХрпБроорпН. рооро▒рпНро▒ роЕройрпИродрпНродро┐ро▒рпНроХрпБроорпН, роирпАроЩрпНроХро│рпН роЗропро▓рпНрокрпБроиро┐ро▓рпИ роЕроорпИрокрпНрокрпБроХро│рпИрокрпН рокропройрпНрокроЯрпБродрпНродро▓ро╛роорпН, роЗродрпБ роТро░рпБ роЕроЯро┐рокрпНрокроЯрпИ fine-tuning-роХрпНроХрпБ роиройрпНро▒ро╛роХ ро╡рпЗро▓рпИ роЪрпЖропрпНропрпБроорпН.

```py
from transformers import TrainingArguments

training_args = TrainingArguments("test-trainer")
```

рокропро┐ро▒рпНроЪро┐ропро┐ройрпН рокрпЛродрпБ роЙроЩрпНроХро│рпН рооро╛роЯро▓рпИ Hub-роХрпНроХрпБ родро╛ройро╛роХро╡рпЗ рокродро┐ро╡рпЗро▒рпНро▒ ро╡ро┐ро░рпБроорпНрокро┐ройро╛ро▓рпН, `TrainingArguments`-роЗро▓рпН `push_to_hub=True` роОройрпНрокродрпИ роЕройрпБрокрпНрокро╡рпБроорпН. роЗродрпИрокрпНрокро▒рпНро▒ро┐ [роЕродрпНродро┐ропро╛ропроорпН 4](/course/ta/chapter4/3)-роЗро▓рпН роорпЗро▓рпБроорпН роЕро▒ро┐роирпНродрпБ роХрпКро│рпНро╡рпЛроорпН.

<Tip>

ЁЯЪА **роорпЗроорпНрокроЯрпНроЯ роХроЯрпНроЯроорпИрокрпНрокрпБ (Advanced Configuration)**: роХро┐роЯрпИроХрпНроХроХрпНроХрпВроЯро┐роп роЕройрпИродрпНродрпБ рокропро┐ро▒рпНроЪро┐ arguments рооро▒рпНро▒рпБроорпН родрпЗро░рпНро╡рпБроорпБро▒рпИ роЙродрпНродро┐роХро│рпН рокро▒рпНро▒ро┐роп ро╡ро┐ро░ро┐ро╡ро╛рой родроХро╡ро▓рпБроХрпНроХрпБ, [TrainingArguments роЖро╡рогроЩрпНроХро│рпН](https://huggingface.co/docs/transformers/main/en/main_classes/trainer#transformers.TrainingArguments) рооро▒рпНро▒рпБроорпН [рокропро┐ро▒рпНроЪро┐ роХроЯрпНроЯроорпИрокрпНрокрпБ cookbook](https://huggingface.co/learn/cookbook/en/fine_tuning_code_llm_on_single_gpu)-роРрокрпН рокро╛ро░рпНроХрпНроХро╡рпБроорпН.

</Tip>

роЗро░рогрпНроЯро╛ро╡родрпБ рокроЯро┐, роироородрпБ рооро╛роЯро▓рпИ ро╡ро░рпИропро▒рпБрокрпНрокродрпБ. [роорпБроирпНродрпИроп роЕродрпНродро┐ропро╛ропродрпНродро┐ро▓рпН](/course/ta/chapter2) роЙро│рпНро│родрпИрокрпН рокрпЛро▓ро╡рпЗ, `AutoModelForSequenceClassification` class-роР роЗро░рогрпНроЯрпБ ро▓рпЗрокро┐ро│рпНроХро│рпБроЯройрпН рокропройрпНрокроЯрпБродрпНродрпБро╡рпЛроорпН:

```py
from transformers import AutoModelForSequenceClassification

model = AutoModelForSequenceClassification.from_pretrained(checkpoint, num_labels=2)
```

роЗрокрпНрокрпЛродрпБ роироорпНрооро┐роЯроорпН рооро╛роЯро▓рпН роЙро│рпНро│родрпБ, роЗродрпБро╡ро░рпИ роХроЯрпНроЯроорпИроХрпНроХрокрпНрокроЯрпНроЯ роЕройрпИродрпНродрпБ роЖрокрпНроЬрпЖроХрпНроЯрпНроХро│рпИропрпБроорпН (рооро╛роЯро▓рпН, `training_args`, рокропро┐ро▒рпНроЪро┐ рооро▒рпНро▒рпБроорпН роЪро░ро┐рокро╛ро░рпНрокрпНрокрпБ роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроХро│рпН, роироородрпБ `data_collator`, рооро▒рпНро▒рпБроорпН роироородрпБ `tokenizer`) роЕройрпБрокрпНрокро┐ роТро░рпБ `Trainer`-роР ро╡ро░рпИропро▒рпБроХрпНроХро▓ро╛роорпН.

```py
from transformers import Trainer

trainer = Trainer(
    model,
    training_args,
    train_dataset=tokenized_datasets["train"],
    eval_dataset=tokenized_datasets["validation"],
    data_collator=data_collator,
    tokenizer=tokenizer,
)
```

<Tip>

роирпАроЩрпНроХро│рпН `tokenizer`-роР `Trainer`-роХрпНроХрпБ роЕройрпБрокрпНрокрпБроорпНрокрпЛродрпБ, роирпАроЩрпНроХро│рпН ро╡рпЗро▒рпБ роТройрпНро▒рпИ ро╡ро┤роЩрпНроХро╡ро┐ро▓рпНро▓рпИ роОройрпНро▒ро╛ро▓рпН, `Trainer` роЕроирпНрод `tokenizer`-роЗройрпН `data_collator`-роРрокрпН рокропройрпНрокроЯрпБродрпНродрпБроорпН. роЗроирпНрод ро╡ро┐ро╖ропродрпНродро┐ро▓рпН, роиро╛роорпН роироородрпБ `data_collator`-роРродрпН родройро┐рокрпНрокропройро╛роХрпНроХро┐ропрпБро│рпНро│рпЛроорпН, роЕродрпБ роЗропро▓рпНрокрпБроиро┐ро▓рпИропро┐ро▓ро┐ро░рпБроирпНродрпБ ро╡рпЗро▒рпБрокроЯрпНроЯродрпБ, роОройро╡рпЗ роиро╛роорпН роЕродрпИ ро╡рпЖро│ро┐рокрпНрокроЯрпИропро╛роХ роЕройрпБрокрпНрок ро╡рпЗрогрпНроЯрпБроорпН.

</Tip>

роироородрпБ роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯро┐ро▓рпН рооро╛роЯро▓рпИ fine-tune роЪрпЖропрпНроп, роироородрпБ `Trainer`-роЗройрпН `train()` роорпЖродрпНродроЯрпИ роЕро┤рпИроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН:

```py
trainer.train()
```

роЗродрпБ fine-tuning-роРродрпН родрпКроЯроЩрпНроХрпБроорпН (роЗродрпБ роТро░рпБ GPU-ро╡ро┐ро▓рпН роЪро┐ро▓ роиро┐рооро┐роЯроЩрпНроХро│рпН роЖроХро▓ро╛роорпН) рооро▒рпНро▒рпБроорпН роТро╡рпНро╡рпКро░рпБ 500 ро╕рпНроЯрпЖрокрпНроХро│ро┐ро▓рпБроорпН рокропро┐ро▒рпНроЪро┐ роЗро┤рокрпНрокрпИрокрпН (training loss) рокрпБроХро╛ро░ро│ро┐роХрпНроХрпБроорпН. роЗро░рпБрокрпНрокро┐ройрпБроорпН, роЙроЩрпНроХро│рпН рооро╛роЯро▓рпН роОро╡рпНро╡ро│ро╡рпБ роЪро┐ро▒рокрпНрокро╛роХ (роЕро▓рпНро▓родрпБ роорпЛроЪрооро╛роХ) роЪрпЖропро▓рпНрокроЯрпБроХро┐ро▒родрпБ роОройрпНрокродрпИ роЗродрпБ роЙроЩрпНроХро│рпБроХрпНроХрпБроЪрпН роЪрпКро▓рпНро▓ро╛родрпБ. роЗродро▒рпНроХрпБроХрпН роХро╛ро░рогроорпН:

1.  `evaluation_strategy`-роР `"steps"` (роТро╡рпНро╡рпКро░рпБ `eval_steps`-роХрпНроХрпБроорпН роородро┐рокрпНрокрпАроЯрпБ) роЕро▓рпНро▓родрпБ `"epoch"` (роТро╡рпНро╡рпКро░рпБ epoch-роЗройрпН роорпБроЯро┐ро╡ро┐ро▓рпБроорпН роородро┐рокрпНрокрпАроЯрпБ) роОрой роЕроорпИрокрпНрокродройрпН роорпВро▓роорпН рокропро┐ро▒рпНроЪро┐ропро┐ройрпН рокрпЛродрпБ роородро┐рокрпНрокрпАроЯрпБ роЪрпЖропрпНроп роиро╛роЩрпНроХро│рпН роХрпВро▒ро╡ро┐ро▓рпНро▓рпИ.
2.  роТро░рпБ роорпЖроЯрпНро░ро┐роХрпНроХрпИ роХрогроХрпНроХро┐роЯрпНроЯрпБ роЕродрпИрокрпН рокрпБроХро╛ро░ро│ро┐роХрпНроХ `Trainer`-роХрпНроХрпБ `compute_metrics()` роОройрпНро▒ роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИ роиро╛роЩрпНроХро│рпН ро╡ро┤роЩрпНроХро╡ро┐ро▓рпНро▓рпИ (роЗро▓рпНро▓рпИропрпЖройро┐ро▓рпН роородро┐рокрпНрокрпАроЯрпБ роЗро┤рокрпНрокрпИ роороЯрпНроЯрпБроорпН роЕроЪрпНроЪро┐роЯрпНроЯро┐ро░рпБроХрпНроХрпБроорпН, роЗродрпБ рооро┐роХро╡рпБроорпН роЙро│рпНро│рпБрогро░рпНро╡рпБ роОрогрпН роЕро▓рпНро▓).

### роородро┐рокрпНрокрпАроЯрпБ (Evaluation)[[evaluation]]

роТро░рпБ роЪро░ро┐ропро╛рой роородро┐рокрпНрокрпАроЯрпНроЯрпБроЪрпН роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИ роОро╡рпНро╡ро╛ро▒рпБ роЙро░рпБро╡ро╛роХрпНроХрпБро╡родрпБ роОройрпНро▒рпБ рокро╛ро░рпНрокрпНрокрпЛроорпН. `Trainer` роородро┐рокрпНрокрпАроЯрпНроЯро┐ройрпН рокрпЛродрпБ роТро░рпБ `EvalPrediction` роЖрокрпНроЬрпЖроХрпНроЯрпИ роЙро░рпБро╡ро╛роХрпНроХрпБроорпН, роЕродро┐ро▓рпН `predictions` рооро▒рпНро▒рпБроорпН `label_ids` рокрпБро▓роЩрпНроХро│рпН роЙро│рпНро│рой. роЗроирпНрод роЖрокрпНроЬрпЖроХрпНроЯрпИрокрпН рокрпЖро▒ `predict()` роорпЖродрпНродроЯро┐ройрпН рокропройрпНрокроЯрпБродрпНродро▓ро╛роорпН:

```py
predictions = trainer.predict(tokenized_datasets["validation"])
print(predictions.predictions.shape, predictions.label_ids.shape)
```

```python out
(408, 2) (408,)
```

`predict()` роорпЖродрпНродроЯро┐ройрпН ро╡рпЖро│ро┐ропрпАроЯрпБ роорпВройрпНро▒рпБ рокрпБро▓роЩрпНроХро│рпИроХрпН роХрпКрогрпНроЯ роТро░рпБ рокрпЖропро░ро┐роЯрокрпНрокроЯрпНроЯ tuple роЖроХрпБроорпН: `predictions`, `label_ids`, рооро▒рпНро▒рпБроорпН `metrics`. `metrics` рокрпБро▓роорпН, роЕройрпБрокрпНрокрокрпНрокроЯрпНроЯ роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯро┐ро▓рпН роЙро│рпНро│ роЗро┤рокрпНрокрпБ рооро▒рпНро▒рпБроорпН роЪро┐ро▓ роирпЗро░ роорпЖроЯрпНро░ро┐роХрпНроХрпБроХро│рпИ (роорпКродрпНродрооро╛роХро╡рпБроорпН роЪро░ро╛роЪро░ро┐ропро╛роХро╡рпБроорпН роХрогро┐роХрпНроХ роОро╡рпНро╡ро│ро╡рпБ роирпЗро░роорпН роЖройродрпБ) роороЯрпНроЯрпБроорпЗ роХрпКрогрпНроЯро┐ро░рпБроХрпНроХрпБроорпН. роироородрпБ `compute_metrics()` роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИ роорпБроЯро┐родрпНродрпБ роЕродрпИ `Trainer`-роХрпНроХрпБ роЕройрпБрокрпНрокро┐ропро╡рпБроЯройрпН, роЕроирпНродрокрпН рокрпБро▓роорпН `compute_metrics()` роорпВро▓роорпН родро┐ро░рпБрокрпНрокро┐ропро│ро┐роХрпНроХрокрпНрокроЯрпНроЯ роорпЖроЯрпНро░ро┐роХрпНроХрпБроХро│рпИропрпБроорпН роХрпКрогрпНроЯро┐ро░рпБроХрпНроХрпБроорпН.

роирпАроЩрпНроХро│рпН рокро╛ро░рпНрокрпНрокродрпБ рокрпЛро▓рпН, `predictions` роОройрпНрокродрпБ 408 x 2 ро╡роЯро┐ро╡родрпНродро┐ро▓рпН роЙро│рпНро│ роЗро░рпБ рокро░ро┐рооро╛рог ро╡ро░ро┐роЪрпИ роЖроХрпБроорпН (408 роОройрпНрокродрпБ роородро┐рокрпНрокрпАроЯрпНроЯро┐ро▒рпНроХрпБ роиро╛роорпН рокропройрпНрокроЯрпБродрпНродро┐роп роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯро┐ро▓рпН роЙро│рпНро│ роХрпВро▒рпБроХро│ро┐ройрпН роОрогрпНрогро┐роХрпНроХрпИ). роЗро╡рпИ `predict()`-роХрпНроХрпБ роиро╛роорпН роЕройрпБрокрпНрокро┐роп роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯро┐ройрпН роТро╡рпНро╡рпКро░рпБ роЙро▒рпБрокрпНрокрпБроХрпНроХрпБрооро╛рой logits роЖроХрпБроорпН ([роорпБроирпНродрпИроп роЕродрпНродро┐ропро╛ропроорпН](/course/ta/chapter2/2)-роЗро▓рпН роирпАроЩрпНроХро│рпН рокро╛ро░рпНродрпНродродрпБ рокрпЛро▓рпН, роЕройрпИродрпНродрпБ ЁЯдЧ Transformers рооро╛роЯро▓рпНроХро│рпБроорпН logits-роРродрпН родро┐ро░рпБрокрпНрокрпБроХро┐ройрпНро▒рой).

роЕро╡ро▒рпНро▒рпИ роироородрпБ ро▓рпЗрокро┐ро│рпНроХро│рпБроЯройрпН роТрокрпНрокро┐роЯроХрпНроХрпВроЯро┐роп роХрогро┐рокрпНрокрпБроХро│ро╛роХ рооро╛ро▒рпНро▒, роЗро░рогрпНроЯро╛ро╡родрпБ роЕроЪрпНроЪро┐ро▓рпН роЕродро┐роХрокроЯрпНроЪ роородро┐рокрпНрокрпБро│рпНро│ роХрпБро▒ро┐ропрпАроЯрпНроЯрпИ роОроЯрпБроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН:

```py
import numpy as np

preds = np.argmax(predictions.predictions, axis=-1)
```

роЗрокрпНрокрпЛродрпБ роЗроирпНрод `preds`-роР `labels`-роЙроЯройрпН роТрокрпНрокро┐роЯро▓ро╛роорпН. роироородрпБ `compute_metrics()` роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпИ роЙро░рпБро╡ро╛роХрпНроХ, `evaluate` ро▓рпИрокрпНро░ро░ро┐ропрпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡рпЛроорпН. MRPC роЯрпЗроЯрпНроЯро╛роЪрпЖроЯрпНроЯрпБроЯройрпН родрпКроЯро░рпНрокрпБроЯрпИроп роорпЖроЯрпНро░ро┐роХрпНроХрпБроХро│рпИ (родрпБро▓рпНро▓ро┐ропроорпН рооро▒рпНро▒рпБроорпН F1 ро╕рпНроХрпЛро░рпН) роЗро╡рпНро╡ро╛ро▒рпБ роПро▒рпНро▒ро▓ро╛роорпН:

```py
import evaluate

metric = evaluate.load("glue", "mrpc")
metric.compute(predictions=preds, references=predictions.label_ids)
```

```python out
{'accuracy': 0.8578431372549019, 'f1': 0.8996539792387542}
```

<Tip>

ЁЯТб **роорпЖроЯрпНро░ро┐роХрпНроХрпБроХро│рпИ роЖро░ро╛ропрпБроЩрпНроХро│рпН (Explore Metrics)**: [ЁЯдЧ Evaluate ро▓рпИрокрпНро░ро░ро┐](https://huggingface.co/evaluate-metric)-роЗро▓рпН 80-роХрпНроХрпБроорпН роорпЗро▒рпНрокроЯрпНроЯ роорпЖроЯрпНро░ро┐роХрпНроХрпБроХро│рпИ роирпАроЩрпНроХро│рпН роЖро░ро╛ропро▓ро╛роорпН. роЕро╡ро▒рпНро▒рпИ роОро╡рпНро╡ро╛ро▒рпБ рокропройрпНрокроЯрпБродрпНродрпБро╡родрпБ роОройрпНрокродрпБ рокро▒рпНро▒ро┐роп роХрпВроЯрпБродро▓рпН ро╡ро┐ро╡ро░роЩрпНроХро│рпБроХрпНроХрпБ, [Evaluate роЖро╡рогроЩрпНроХро│рпН](https://huggingface.co/docs/evaluate/index)-роРрокрпН рокро╛ро░рпНроХрпНроХро╡рпБроорпН.

</Tip>

роЗрокрпНрокрпЛродрпБ роЕройрпИродрпНродрпИропрпБроорпН роТро░рпЗ роЪрпЖропро▓рпНрокро╛роЯрпНроЯро┐ро▓рпН роЗрогрпИрокрпНрокрпЛроорпН:

```py
def compute_metrics(eval_preds):
    metric = evaluate.load("glue", "mrpc")
    logits, labels = eval_preds
    predictions = np.argmax(logits, axis=-1)
    return metric.compute(predictions=predictions, references=labels)
```

роТро╡рпНро╡рпКро░рпБ epoch-роЗройрпН роорпБроЯро┐ро╡ро┐ро▓рпБроорпН роорпЖроЯрпНро░ро┐роХрпНроХрпБроХро│рпИрокрпН рокрпБроХро╛ро░ро│ро┐роХрпНроХ, роЗроирпНрод `compute_metrics()` роЪрпЖропро▓рпНрокро╛роЯрпНроЯрпБроЯройрпН роТро░рпБ рокрпБродро┐роп `Trainer`-роР роОро╡рпНро╡ро╛ро▒рпБ ро╡ро░рпИропро▒рпБрокрпНрокродрпБ роОройрпНрокродрпБ роЗроЩрпНроХрпЗ:

```py
training_args = TrainingArguments("test-trainer", eval_strategy="epoch")
model = AutoModelForSequenceClassification.from_pretrained(checkpoint, num_labels=2)

trainer = Trainer(
    model,
    training_args,
    train_dataset=tokenized_datasets["train"],
    eval_dataset=tokenized_datasets["validation"],
    tokenizer=tokenizer,
    compute_metrics=compute_metrics,
)
trainer.train()
```

роЗроирпНрод роорпБро▒рпИ, `Trainer` роТро╡рпНро╡рпКро░рпБ epoch-роЗройрпН роорпБроЯро┐ро╡ро┐ро▓рпБроорпН роЪро░ро┐рокро╛ро░рпНрокрпНрокрпБ роЗро┤рокрпНрокрпБ (validation loss) рооро▒рпНро▒рпБроорпН роорпЖроЯрпНро░ро┐роХрпНроХрпБроХро│рпИрокрпН рокрпБроХро╛ро░ро│ро┐роХрпНроХрпБроорпН. роорпЗро▓рпБроорпН родрпЗро░рпНро╡рпБроорпБро▒рпИроХро│рпИ роЗропроХрпНроХ `TrainingArguments`-роРродрпН родройро┐рокрпНрокропройро╛роХрпНроХро▓ро╛роорпН.

<Tip>

тЪбя╕П **рокропро┐ро▒рпНроЪро┐ родрпЗро░рпНро╡рпБроорпБро▒рпИроХро│рпН (Training Optimizations)**: роирпАроЩрпНроХро│рпН роЗропроХрпНроХроХрпНроХрпВроЯро┐роп роЪро┐ро▓ рокрпКродрпБро╡ро╛рой родрпЗро░рпНро╡рпБроорпБро▒рпИроХро│рпН роЗроЩрпНроХрпЗ:

**роХро▓рокрпНрокрпБ родрпБро▓рпНро▓ро┐ропроорпН (Mixed Precision)**: роиро╡рпАрой GPU-роХро│ро┐ро▓рпН ро╡рпЗроХрооро╛рой рокропро┐ро▒рпНроЪро┐роХрпНроХрпБ, `fp16=True` роЙроЯройрпН роХро▓рокрпНрокрпБ родрпБро▓рпНро▓ро┐ропродрпНродрпИ роЗропроХрпНроХро╡рпБроорпН.

```py
training_args = TrainingArguments(
    "test-trainer",
    eval_strategy="epoch",
    fp16=True,  # Enable mixed precision
)
```

**роХро┐ро░рпЗроЯро┐ропройрпНроЯрпН родро┐ро░роЯрпНроЯро▓рпН (Gradient Accumulation)**: GPU роиро┐ройрпИро╡роХроорпН роХрпБро▒рпИро╡ро╛роХ роЗро░рпБроХрпНроХрпБроорпНрокрпЛродрпБ рокрпБродрпБрокрпНрокро┐рокрпНрокродро▒рпНроХрпБ рокрпЖро░ро┐роп batch роЕро│ро╡рпБроХро│рпИ роЙро░рпБро╡ро╛роХрпНроХ:

```py
training_args = TrainingArguments(
    "test-trainer",
    eval_strategy="epoch",
    per_device_train_batch_size=4,
    gradient_accumulation_steps=4,  # Effective batch size = 4 * 4 = 16
)
```

**роХро▒рпНро▒ро▓рпН ро╡ро┐роХро┐род родро┐роЯрпНроЯрооро┐роЯро▓рпН (Learning Rate Scheduling)**: роЗропро▓рпНрокрпБроиро┐ро▓рпИ роХро▒рпНро▒ро▓рпН ро╡ро┐роХро┐род родро┐роЯрпНроЯрооро┐роЯрпБрокро╡ро░рпН, роЖро░роорпНрок роХро▒рпНро▒ро▓рпН ро╡ро┐роХро┐родродрпНродро┐ро▓ро┐ро░рпБроирпНродрпБ роТро░рпБ роирпЗро░ро┐ропро▓рпН роЪро┐родрпИро╡рпБ роЖроХрпБроорпН. `lr_scheduler_type` роорпВро▓роорпН роЕродрпИродрпН родройро┐рокрпНрокропройро╛роХрпНроХро▓ро╛роорпН.

```py
training_args = TrainingArguments(
    "test-trainer",
    eval_strategy="epoch",
    lr_scheduler_type="cosine",  # e.g., 'cosine', 'linear', 'constant'
)
```

</Tip>

<Tip>

ЁЯУЭ **роорпЗро▓рпБроорпН роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпБроХро│рпН**: [ЁЯдЧ Transformers роирпЛроЯрпНрокрпБроХрпНроХрпБроХро│ро┐ройрпН](https://huggingface.co/docs/transformers/main/en/notebooks) ро╡ро┐ро░ро┐ро╡ро╛рой родрпКроХрпБрокрпНрокрпИрокрпН рокро╛ро░рпНроХрпНроХро╡рпБроорпН.

</Tip>

## рокро┐ро░ро┐ро╡рпБ ро╡ро┐ройро╛роЯро┐ ро╡ро┐ройро╛ (Section Quiz)[[section-quiz]]

Trainer API рооро▒рпНро▒рпБроорпН fine-tuning роХро░рпБродрпНродрпБроХро│рпН рокро▒рпНро▒ро┐роп роЙроЩрпНроХро│рпН рокрпБро░ро┐родро▓рпИ роЪрпЛродро┐роХрпНроХро╡рпБроорпН:

### 1. Trainer-роЗро▓рпН <code>processing_class</code> рокро╛ро░ро╛роорпАроЯрпНроЯро░ро┐ройрпН роирпЛроХрпНроХроорпН роОройрпНрой?

<Question
	choices={[
		{
			text: "роЗродрпБ роОроирпНрод рооро╛роЯро▓рпН роХроЯрпНроЯроорпИрокрпНрокрпИрокрпН рокропройрпНрокроЯрпБродрпНрод ро╡рпЗрогрпНроЯрпБроорпН роОройрпНрокродрпИроХрпН роХрпБро▒ро┐рокрпНрокро┐роЯрпБроХро┐ро▒родрпБ.",
			explain: "рооро╛роЯро▓рпН роХроЯрпНроЯроорпИрокрпНрокрпБ `model` рокро╛ро░ро╛роорпАроЯрпНроЯро░ро╛ро▓рпН родрпАро░рпНрооро╛ройро┐роХрпНроХрокрпНрокроЯрпБроХро┐ро▒родрпБ."
		},
		{
			text: "роЗродрпБ роорпБройрпНродропро╛ро░ро┐рокрпНрокрпБроХрпНроХро╛роХ роЯрпЛроХрпНроХройрпИроЪро░рпН рооро▒рпНро▒рпБроорпН роЯрпЗроЯрпНроЯро╛ роХрпЛро▓рпЗроЯрпНроЯро░рпИ ро╡ро░рпИропро▒рпБроХрпНроХро┐ро▒родрпБ.",
			explain: "`processing_class` роЯрпЛроХрпНроХройрпИроЪро░рпН рооро▒рпНро▒рпБроорпН роЯрпЗроЯрпНроЯро╛ роХрпЛро▓рпЗроЯрпНроЯро░рпИ роЗрогрпИроХрпНроХрокрпН рокропройрпНрокроЯрпБроХро┐ро▒родрпБ.",
            correct: true
		},
		{
			text: "роЗродрпБ роЖрокрпНроЯро┐роорпИроЪро░рпБроХрпНроХро╛рой роХро▒рпНро▒ро▓рпН ро╡ро┐роХро┐родродрпНродрпИ роЕроорпИроХрпНроХро┐ро▒родрпБ.",
			explain: "роХро▒рпНро▒ро▓рпН ро╡ро┐роХро┐родроорпН TrainingArguments-роЗро▓рпН роЕроорпИроХрпНроХрокрпНрокроЯрпНроЯрпБро│рпНро│родрпБ."
		},
        {
			text: "роЗродрпБ роородро┐рокрпНрокрпАроЯрпНроЯрпБ роЕродро┐ро░рпНро╡рпЖрогрпНрогрпИроХрпН роХроЯрпНроЯрпБрокрпНрокроЯрпБродрпНродрпБроХро┐ро▒родрпБ.",
			explain: "роородро┐рокрпНрокрпАроЯрпНроЯрпБ роЕродро┐ро░рпНро╡рпЖрогрпН TrainingArguments-роЗро▓рпН роЙро│рпНро│ eval_strategy роорпВро▓роорпН роХроЯрпНроЯрпБрокрпНрокроЯрпБродрпНродрокрпНрокроЯрпБроХро┐ро▒родрпБ."
		}
	]}
/>

### 2. рокропро┐ро▒рпНроЪро┐ропро┐ройрпН рокрпЛродрпБ роородро┐рокрпНрокрпАроЯрпБ роОро╡рпНро╡ро│ро╡рпБ роЕроЯро┐роХрпНроХроЯро┐ роиро┐роХро┤рпНроХро┐ро▒родрпБ роОройрпНрокродрпИ роОроирпНрод TrainingArguments рокро╛ро░ро╛роорпАроЯрпНроЯро░рпН роХроЯрпНроЯрпБрокрпНрокроЯрпБродрпНродрпБроХро┐ро▒родрпБ?

<Question
	choices={[
		{
			text: "eval_frequency",
			explain: "TrainingArguments-роЗро▓рпН eval_frequency роОройрпНро▒ рокро╛ро░ро╛роорпАроЯрпНроЯро░рпН роЗро▓рпНро▓рпИ."
		},
		{
			text: "eval_strategy",
			explain: "роородро┐рокрпНрокрпАроЯрпНроЯрпБ роЕродро┐ро░рпНро╡рпЖрогрпНрогрпИроХрпН роХроЯрпНроЯрпБрокрпНрокроЯрпБродрпНрод `eval_strategy`-роР 'steps' роЕро▓рпНро▓родрпБ 'epoch' роОрой роЕроорпИроХрпНроХро▓ро╛роорпН.",
            correct: true
		},
		{
			text: "evaluation_steps",
			explain: "роЗродрпБ роЗрокрпНрокрпЛродрпБ `eval_steps` роЖроХрпБроорпН, роорпЗро▓рпБроорпН `eval_strategy` 'steps' роЖроХ роЗро░рпБроХрпНроХрпБроорпНрокрпЛродрпБ роороЯрпНроЯрпБроорпЗ роЗродрпБ роЪрпЖропро▓рпНрокроЯрпБроорпН."
		},
        {
			text: "do_eval",
			explain: "роиро╡рпАрой TrainingArguments-роЗро▓рпН do_eval роОройрпНро▒ рокро╛ро░ро╛роорпАроЯрпНроЯро░рпН роЗро▓рпНро▓рпИ."
		}
	]}
/>

### 3. TrainingArguments-роЗро▓рпН <code>fp16=True</code> роОродрпИ роЗропроХрпНроХрпБроХро┐ро▒родрпБ?

<Question
	choices={[
		{
			text: "ро╡рпЗроХрооро╛рой рокропро┐ро▒рпНроЪро┐роХрпНроХрпБ 16-рокро┐роЯрпН роорпБро┤рпБ роОрогрпН родрпБро▓рпНро▓ро┐ропроорпН.",
			explain: "fp16 роОройрпНрокродрпБ рооро┐родроХрпНроХрпБроорпН-рокрпБро│рпНро│ро┐ родрпБро▓рпНро▓ро┐ропродрпНродрпИроХрпН роХрпБро▒ро┐роХрпНроХро┐ро▒родрпБ, роорпБро┤рпБ роОрогрпН родрпБро▓рпНро▓ро┐ропродрпНродрпИ роЕро▓рпНро▓."
		},
		{
			text: "ро╡рпЗроХрооро╛рой рокропро┐ро▒рпНроЪро┐ рооро▒рпНро▒рпБроорпН роХрпБро▒рпИроирпНрод роиро┐ройрпИро╡роХ рокропройрпНрокро╛роЯрпНроЯро┐ро▒рпНроХрпБ 16-рокро┐роЯрпН рооро┐родроХрпНроХрпБроорпН-рокрпБро│рпНро│ро┐ роОрогрпНроХро│рпБроЯройрпН роХро▓рокрпНрокрпБ родрпБро▓рпНро▓ро┐роп рокропро┐ро▒рпНроЪро┐.",
			explain: "роХро▓рокрпНрокрпБ родрпБро▓рпНро▓ро┐роп рокропро┐ро▒рпНроЪро┐, роорпБройрпНройрпЛроХрпНроХро┐роп рокро╛ро╕рпН-роХрпНроХрпБ 16-рокро┐роЯрпН рооро┐родро╡рпИроХро│рпИропрпБроорпН, роХро┐ро░рпЗроЯро┐ропройрпНроЯрпНроХро│рпБроХрпНроХрпБ 32-рокро┐роЯрпН рооро┐родро╡рпИроХро│рпИропрпБроорпН рокропройрпНрокроЯрпБродрпНродрпБроХро┐ро▒родрпБ, роЗродрпБ ро╡рпЗроХродрпНродрпИ роорпЗроорпНрокроЯрпБродрпНродрпБроХро┐ро▒родрпБ рооро▒рпНро▒рпБроорпН роиро┐ройрпИро╡роХ рокропройрпНрокро╛роЯрпНроЯрпИроХрпН роХрпБро▒рпИроХрпНроХро┐ро▒родрпБ.",
            correct: true
		},
		{
			text: "роЪро░ро┐ропро╛роХ 16 роОрокрпЛроХрпНроХро│рпБроХрпНроХро╛рой рокропро┐ро▒рпНроЪро┐.",
			explain: "fp16-роХрпНроХрпБроорпН роОрокрпЛроХрпНроХро│ро┐ройрпН роОрогрпНрогро┐роХрпНроХрпИроХрпНроХрпБроорпН роОроирпНрод роЪроорпНрокроирпНродроорпБроорпН роЗро▓рпНро▓рпИ."
		},
        {
			text: "ро╡ро┐роиро┐ропрпЛроХро┐роХрпНроХрокрпНрокроЯрпНроЯ рокропро┐ро▒рпНроЪро┐роХрпНроХрпБ 16 GPU-роХро│рпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБродро▓рпН.",
			explain: "GPU-роХро│ро┐ройрпН роОрогрпНрогро┐роХрпНроХрпИ fp16 рокро╛ро░ро╛роорпАроЯрпНроЯро░ро╛ро▓рпН роХроЯрпНроЯрпБрокрпНрокроЯрпБродрпНродрокрпНрокроЯро╡ро┐ро▓рпНро▓рпИ."
		}
	]}
/>

### 4. Trainer-роЗро▓рпН <code>compute_metrics</code> роЪрпЖропро▓рпНрокро╛роЯрпНроЯро┐ройрпН рокроЩрпНроХрпБ роОройрпНрой?

<Question
	choices={[
		{
			text: "роЗродрпБ рокропро┐ро▒рпНроЪро┐ропро┐ройрпН рокрпЛродрпБ роЗро┤рокрпНрокрпИроХрпН роХрогроХрпНроХро┐роЯрпБроХро┐ро▒родрпБ.",
			explain: "роЗро┤рокрпНрокрпБ роХрогроХрпНроХрпАроЯрпБ рооро╛роЯро▓ро╛ро▓рпН родро╛ройро╛роХро╡рпЗ роХрпИропро╛ро│рокрпНрокроЯрпБроХро┐ро▒родрпБ, compute_metrics-роЖро▓рпН роЕро▓рпНро▓."
		},
		{
			text: "роЗродрпБ ро▓ро╛роЬро┐роЯрпНроХро│рпИ роХрогро┐рокрпНрокрпБроХро│ро╛роХ рооро╛ро▒рпНро▒ро┐, родрпБро▓рпНро▓ро┐ропроорпН рооро▒рпНро▒рпБроорпН F1 рокрпЛройрпНро▒ роородро┐рокрпНрокрпАроЯрпНроЯрпБ роорпЖроЯрпНро░ро┐роХрпНроХрпБроХро│рпИроХрпН роХрогроХрпНроХро┐роЯрпБроХро┐ро▒родрпБ.",
			explain: "compute_metrics роХрогро┐рокрпНрокрпБроХро│рпН рооро▒рпНро▒рпБроорпН ро▓рпЗрокро┐ро│рпНроХро│рпИ роОроЯрпБродрпНродрпБ, рокро┐ройрпНройро░рпН роородро┐рокрпНрокрпАроЯрпНроЯро┐ро▒рпНроХро╛рой роорпЖроЯрпНро░ро┐роХрпНроХрпБроХро│рпИродрпН родро┐ро░рпБрокрпНрокрпБроХро┐ро▒родрпБ.",
            correct: true
		},
		{
			text: "роЗродрпБ роОроирпНрод роЖрокрпНроЯро┐роорпИроЪро░рпИрокрпН рокропройрпНрокроЯрпБродрпНрод ро╡рпЗрогрпНроЯрпБроорпН роОройрпНрокродрпИродрпН родрпАро░рпНрооро╛ройро┐роХрпНроХро┐ро▒родрпБ.",
			explain: "роЖрокрпНроЯро┐роорпИроЪро░рпН родрпЗро░рпНро╡рпБ compute_metrics-роЖро▓рпН роХрпИропро╛ро│рокрпНрокроЯро╡ро┐ро▓рпНро▓рпИ."
		},
        {
			text: "роЗродрпБ рокропро┐ро▒рпНроЪро┐родрпН родро░ро╡рпИ роорпБройрпНродропро╛ро░ро┐рокрпНрокрпБ роЪрпЖропрпНроХро┐ро▒родрпБ.",
			explain: "родро░ро╡рпБ роорпБройрпНродропро╛ро░ро┐рокрпНрокрпБ рокропро┐ро▒рпНроЪро┐роХрпНроХрпБ роорпБройрпН роЪрпЖропрпНропрокрпНрокроЯрпБроХро┐ро▒родрпБ, роородро┐рокрпНрокрпАроЯрпНроЯро┐ройрпН рокрпЛродрпБ compute_metrics-роЖро▓рпН роЕро▓рпНро▓."
		}
	]}
/>

### 5. роирпАроЩрпНроХро│рпН Trainer-роХрпНроХрпБ <code>eval_dataset</code> ро╡ро┤роЩрпНроХро╛родрокрпЛродрпБ роОройрпНрой роироЯроХрпНроХрпБроорпН?

<Question
	choices={[
		{
			text: "рокропро┐ро▒рпНроЪро┐ роТро░рпБ рокро┐ро┤рпИропрпБроЯройрпН родрпЛро▓рпНро╡ро┐ропроЯрпИропрпБроорпН.",
			explain: "eval_dataset роЗро▓рпНро▓ро╛рооро▓рпН рокропро┐ро▒рпНроЪро┐ родрпКроЯро░ро▓ро╛роорпН, роЗро░рпБрокрпНрокро┐ройрпБроорпН роирпАроЩрпНроХро│рпН роородро┐рокрпНрокрпАроЯрпНроЯрпБ роорпЖроЯрпНро░ро┐роХрпНроХрпБроХро│рпИрокрпН рокрпЖро▒ рооро╛роЯрпНроЯрпАро░рпНроХро│рпН."
		},
		{
			text: "Trainer родро╛ройро╛роХро╡рпЗ роородро┐рокрпНрокрпАроЯрпНроЯро┐ро▒рпНроХро╛роХ рокропро┐ро▒рпНроЪро┐родрпН родро░ро╡рпИрокрпН рокро┐ро░ро┐роХрпНроХрпБроорпН.",
			explain: "Trainer родро╛ройро╛роХро╡рпЗ роЪро░ро┐рокро╛ро░рпНрокрпНрокрпБрокрпН рокро┐ро░ро┐ро╡рпБроХро│рпИ роЙро░рпБро╡ро╛роХрпНроХро╛родрпБ."
		},
		{
			text: "рокропро┐ро▒рпНроЪро┐ропро┐ройрпН рокрпЛродрпБ роирпАроЩрпНроХро│рпН роородро┐рокрпНрокрпАроЯрпНроЯрпБ роорпЖроЯрпНро░ро┐роХрпНроХрпБроХро│рпИрокрпН рокрпЖро▒ рооро╛роЯрпНроЯрпАро░рпНроХро│рпН, роЖройро╛ро▓рпН рокропро┐ро▒рпНроЪро┐ роЗройрпНройрпБроорпН ро╡рпЗро▓рпИ роЪрпЖропрпНропрпБроорпН.",
			explain: "роородро┐рокрпНрокрпАроЯрпБ ро╡ро┐ро░рпБрокрпНрокрооро╛ройродрпБ - роирпАроЩрпНроХро│рпН роЕродрпБ роЗро▓рпНро▓ро╛рооро▓рпБроорпН рокропро┐ро▒рпНроЪро┐ роЪрпЖропрпНропро▓ро╛роорпН, роЖройро╛ро▓рпН роирпАроЩрпНроХро│рпН роЪро░ро┐рокро╛ро░рпНрокрпНрокрпБ роорпЖроЯрпНро░ро┐роХрпНроХрпБроХро│рпИроХрпН роХро╛рог рооро╛роЯрпНроЯрпАро░рпНроХро│рпН.",
            correct: true
		},
        {
			text: "рооро╛роЯро▓рпН роородро┐рокрпНрокрпАроЯрпНроЯро┐ро▒рпНроХро╛роХ рокропро┐ро▒рпНроЪро┐родрпН родро░ро╡рпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБроорпН.",
			explain: "Trainer родро╛ройро╛роХро╡рпЗ роородро┐рокрпНрокрпАроЯрпНроЯро┐ро▒рпНроХро╛роХ рокропро┐ро▒рпНроЪро┐родрпН родро░ро╡рпИрокрпН рокропройрпНрокроЯрпБродрпНродро╛родрпБ - роЕродрпБ ро╡рпЖро▒рпБрооройрпЗ роородро┐рокрпНрокрпАроЯрпБ роЪрпЖропрпНропро╛родрпБ."
		}
	]}
/>

### 6. роХро┐ро░рпЗроЯро┐ропройрпНроЯрпН родро┐ро░роЯрпНроЯро▓рпН роОройрпНро▒ро╛ро▓рпН роОройрпНрой, роЕродрпИ роОрокрпНрокроЯро┐ роЗропроХрпНроХрпБро╡родрпБ?

<Question
	choices={[
		{
			text: "роЗродрпБ роХро┐ро░рпЗроЯро┐ропройрпНроЯрпНроХро│рпИ ро╡роЯрпНроЯро┐ро▓рпН роЪрпЗрооро┐роХрпНроХро┐ро▒родрпБ, save_gradients=True роЙроЯройрпН роЗропроХрпНроХрокрпНрокроЯрпНроЯродрпБ.",
			explain: "роХро┐ро░рпЗроЯро┐ропройрпНроЯрпН родро┐ро░роЯрпНроЯро▓рпН роХро┐ро░рпЗроЯро┐ропройрпНроЯрпНроХро│рпИ ро╡роЯрпНроЯро┐ро▓рпН роЪрпЗрооро┐рокрпНрокродрпИ роЙро│рпНро│роЯроХрпНроХро╛родрпБ."
		},
		{
			text: "роЗродрпБ рокрпБродрпБрокрпНрокро┐рокрпНрокродро▒рпНроХрпБ роорпБройрпН рокро▓ рокрпЗроЯрпНроЪрпНроХро│ро┐ро▓рпН роХро┐ро░рпЗроЯро┐ропройрпНроЯрпНроХро│рпИродрпН родро┐ро░роЯрпНроЯрпБроХро┐ро▒родрпБ, gradient_accumulation_steps роЙроЯройрпН роЗропроХрпНроХрокрпНрокроЯрпНроЯродрпБ.",
			explain: "роЗродрпБ рокро▓ роорпБройрпНройрпЛроХрпНроХро┐роп рокро╛ро╕рпНроХро│ро┐ро▓рпН роХро┐ро░рпЗроЯро┐ропройрпНроЯрпНроХро│рпИродрпН родро┐ро░роЯрпНроЯрпБро╡родройрпН роорпВро▓роорпН рокрпЖро░ро┐роп рокрпЗроЯрпНроЪрпН роЕро│ро╡рпБроХро│рпИ роЙро░рпБро╡роХрокрпНрокроЯрпБродрпНрод роЙроЩрпНроХро│рпИ роЕройрпБроородро┐роХрпНроХро┐ро▒родрпБ.",
            correct: true
		},
		{
			text: "роЗродрпБ роХро┐ро░рпЗроЯро┐ропройрпНроЯрпН роХрогроХрпНроХрпАроЯрпНроЯрпИ ро╡рпЗроХрокрпНрокроЯрпБродрпНродрпБроХро┐ро▒родрпБ, fp16 роЙроЯройрпН родро╛ройро╛роХро╡рпЗ роЗропроХрпНроХрокрпНрокроЯрпНроЯродрпБ.",
			explain: "fp16 рокропро┐ро▒рпНроЪро┐ропрпИ ро╡рпЗроХрокрпНрокроЯрпБродрпНрод роорпБроЯро┐ропрпБроорпН роОройрпНро▒ро╛ро▓рпБроорпН, роХро┐ро░рпЗроЯро┐ропройрпНроЯрпН родро┐ро░роЯрпНроЯро▓рпН роТро░рпБ родройро┐ роирпБроЯрпНрокрооро╛роХрпБроорпН."
		},
        {
			text: "роЗродрпБ роХро┐ро░рпЗроЯро┐ропройрпНроЯрпН ро╡ро┤ро┐родро▓рпИродрпН родроЯрпБроХрпНроХро┐ро▒родрпБ, gradient_clipping=True роЙроЯройрпН роЗропроХрпНроХрокрпНрокроЯрпНроЯродрпБ.",
			explain: "роЕродрпБ роХро┐ро░рпЗроЯро┐ропройрпНроЯрпН роХро┐ро│ро┐рокрпНрокро┐роЩрпНроХрпИ ро╡ро┐ро╡ро░ро┐роХрпНроХро┐ро▒родрпБ, роХро┐ро░рпЗроЯро┐ропройрпНроЯрпН родро┐ро░роЯрпНроЯро▓рпИ роЕро▓рпНро▓."
		}
	]}
/>

<Tip>

ЁЯТб **роорпБроХрпНроХро┐роп роХрпБро▒ро┐рокрпНрокрпБроХро│рпН (Key Takeaways):**
- `Trainer` API рокрпЖро░рпБроорпНрокро╛ро▓ро╛рой рокропро┐ро▒рпНроЪро┐ роЪро┐роХрпНроХро▓рпНроХро│рпИроХрпН роХрпИропро╛ро│рпБроорпН роТро░рпБ роЙропро░рпН-роиро┐ро▓рпИ роЗроЯрпИроорпБроХродрпНродрпИ ро╡ро┤роЩрпНроХрпБроХро┐ро▒родрпБ
- роЪро░ро┐ропро╛рой родро░ро╡рпБ роХрпИропро╛ро│рпБродро▓рпБроХрпНроХрпБ роЙроЩрпНроХро│рпН роЯрпЛроХрпНроХройрпИроЪро░рпИроХрпН роХрпБро▒ро┐рокрпНрокро┐роЯ `processing_class`-роРрокрпН рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН
- `TrainingArguments` рокропро┐ро▒рпНроЪро┐ропро┐ройрпН роЕройрпИродрпНродрпБ роЕроорпНроЪроЩрпНроХро│рпИропрпБроорпН роХроЯрпНроЯрпБрокрпНрокроЯрпБродрпНродрпБроХро┐ро▒родрпБ: роХро▒рпНро▒ро▓рпН ро╡ро┐роХро┐родроорпН, рокрпЗроЯрпНроЪрпН роЕро│ро╡рпБ, роородро┐рокрпНрокрпАроЯрпНроЯрпБ роЙродрпНродро┐, рооро▒рпНро▒рпБроорпН родрпЗро░рпНро╡рпБроорпБро▒рпИроХро│рпН
- `compute_metrics` рокропро┐ро▒рпНроЪро┐ роЗро┤рокрпНрокрпБроХрпНроХрпБ роЕрокрпНрокро╛ро▒рпНрокроЯрпНроЯ родройро┐рокрпНрокропройрпН роородро┐рокрпНрокрпАроЯрпНроЯрпБ роорпЖроЯрпНро░ро┐роХрпНроХрпБроХро│рпИ роЗропроХрпНроХрпБроХро┐ро▒родрпБ
- роХро▓рокрпНрокрпБ родрпБро▓рпНро▓ро┐ропроорпН (`fp16=True`) рооро▒рпНро▒рпБроорпН роХро┐ро░рпЗроЯро┐ропройрпНроЯрпН родро┐ро░роЯрпНроЯро▓рпН рокрпЛройрпНро▒ роиро╡рпАрой роЕроорпНроЪроЩрпНроХро│рпН рокропро┐ро▒рпНроЪро┐ роЪрпЖропро▓рпНродро┐ро▒ройрпИ роХрогро┐роЪрооро╛роХ роорпЗроорпНрокроЯрпБродрпНродрпБроорпН

</Tip>
