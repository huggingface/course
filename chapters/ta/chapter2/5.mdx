<FrameworkSwitchCourse {fw} />

# рокро▓ ро╡ро░ро┐роЪрпИроХро│рпИроХрпН роХрпИропро╛ро│рпБродро▓рпН[[handling-multiple-sequences]]

<CourseFloatingBanner chapter={2}
  classNames="absolute z-10 right-0 top-0"
  notebooks={[
    {label: "Google Colab", value: "https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/ta/chapter2/section5_pt.ipynb"},
    {label: "Aws Studio", value: "https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/ta/chapter2/section5_pt.ipynb"},
]} />

<Youtube id="M6adb1j2jPI"/>

роорпБроирпНродрпИроп рокро┐ро░ро┐ро╡ро┐ро▓рпН, рокропройрпНрокро╛роЯрпНроЯрпБ роиро┐роХро┤рпНро╡рпБроХро│ро┐ро▓рпН роОро│ро┐роорпИропро╛ройродрпИ роЖро░ро╛ропрпНроирпНродрпЛроорпН: роТро░рпБ роЪро┐ро▒ро┐роп роирпАро│роорпБро│рпНро│ роТро▒рпНро▒рпИ ро╡ро░ро┐роЪрпИропро┐ро▓рпН роЕройрпБрооро╛ройроорпН роЪрпЖропрпНродро▓рпН. роЗро░рпБрокрпНрокро┐ройрпБроорпН, роЪро┐ро▓ роХрпЗро│рпНро╡ро┐роХро│рпН роПро▒рпНроХройро╡рпЗ роОро┤рпБроХро┐ройрпНро▒рой:

- роиро╛роорпН рокро▓ ро╡ро░ро┐роЪрпИроХро│рпИ роОро╡рпНро╡ро╛ро▒рпБ роХрпИропро╛ро│рпНро╡родрпБ?
- *ро╡рпЖро╡рпНро╡рпЗро▒рпБ роирпАро│роЩрпНроХро│рпН* роХрпКрогрпНроЯ рокро▓ ро╡ро░ро┐роЪрпИроХро│рпИ роиро╛роорпН роОро╡рпНро╡ро╛ро▒рпБ роХрпИропро╛ро│рпНро╡родрпБ?
- роТро░рпБ рооро╛родро┐ро░ро┐ роиройрпНро▒ро╛роХ ро╡рпЗро▓рпИ роЪрпЖропрпНроп роЕройрпБроородро┐роХрпНроХрпБроорпН роТро░рпЗ роЙро│рпНро│рпАроЯрпБроХро│рпН роЪрпКро▓рпНро▓роХро░ро╛родро┐ роХрпБро▒ро┐ропрпАроЯрпБроХро│рпН роороЯрпНроЯрпБроорпНродро╛ройро╛?
- рооро┐роХ роирпАрогрпНроЯ ро╡ро░ро┐роЪрпИ роОройрпНро▒рпБ роТройрпНро▒рпБ роЙро│рпНро│родро╛?

роЗроирпНродроХрпН роХрпЗро│рпНро╡ро┐роХро│рпН роОройрпНрой ро╡роХрпИропро╛рой роЪро┐роХрпНроХро▓рпНроХро│рпИ роПро▒рпНрокроЯрпБродрпНродрпБроХро┐ройрпНро▒рой, роЕро╡ро▒рпНро▒рпИ ЁЯдЧ роЯро┐ро░ро╛ройрпНро╕рпНрокро╛ро░рпНрооро░рпНро╕рпН API роРрокрпН рокропройрпНрокроЯрпБродрпНродро┐ роОро╡рпНро╡ро╛ро▒рпБ родрпАро░рпНроХрпНроХро▓ро╛роорпН роОройрпНрокродрпИрокрпН рокро╛ро░рпНрокрпНрокрпЛроорпН.

## рооро╛родро┐ро░ро┐роХро│рпН роЙро│рпНро│рпАроЯрпБроХро│ро┐ройрпН роТро░рпБ родрпКроХрпБродро┐ропрпИ роОродро┐ро░рпНрокро╛ро░рпНроХрпНроХро┐ройрпНро▒рой[[models-expect-a-batch-of-inputs]]

роорпБроирпНродрпИроп рокропро┐ро▒рпНроЪро┐ропро┐ро▓рпН ро╡ро░ро┐роЪрпИроХро│рпН роОрогрпНроХро│ро┐ройрпН рокроЯрпНроЯро┐ропро▓рпНроХро│ро╛роХ роОро╡рпНро╡ро╛ро▒рпБ роорпКро┤ро┐рокрпЖропро░рпНроХрпНроХрокрпНрокроЯрпБроХро┐ройрпНро▒рой роОройрпНрокродрпИрокрпН рокро╛ро░рпНродрпНродрпАро░рпНроХро│рпН. роЗроирпНрод роОрогрпНроХро│ро┐ройрпН рокроЯрпНроЯро┐ропро▓рпИ роТро░рпБ роЯрпЖройрпНроЪро░ро╛роХ рооро╛ро▒рпНро▒ро┐ рооро╛родро┐ро░ро┐роХрпНроХрпБ роЕройрпБрокрпНрокрпБро╡рпЛроорпН:

```py
import torch
from transformers import AutoTokenizer, AutoModelForSequenceClassification

checkpoint = "distilbert-base-uncased-finetuned-sst-2-english"
tokenizer = AutoTokenizer.from_pretrained(checkpoint)
model = AutoModelForSequenceClassification.from_pretrained(checkpoint)

sequence = "I've been waiting for a HuggingFace course my whole life."

tokens = tokenizer.tokenize(sequence)
ids = tokenizer.convert_tokens_to_ids(tokens)
input_ids = torch.tensor(ids)
# роЗроирпНрод ро╡ро░ро┐ родрпЛро▓рпНро╡ро┐ропроЯрпИропрпБроорпН.
model(input_ids)
```

```python out
IndexError: Dimension out of range (expected to be in range of [-1, 0], but got 1)
```

роУ роЗро▓рпНро▓рпИ! роЗродрпБ роПройрпН родрпЛро▓рпНро╡ро┐ропроЯрпИроирпНродродрпБ? рокро┐ро░ро┐ро╡рпБ 2 роЗро▓рпН роЙро│рпНро│ рокрпИрокрпНро▓рпИройро┐ро▓рпН роЗро░рпБроирпНродрпБ рокроЯро┐роХро│рпИрокрпН рокро┐ройрпНрокро▒рпНро▒ро┐ройрпЛроорпН.

роЪро┐роХрпНроХро▓рпН роОройрпНройро╡рпЖройрпНро▒ро╛ро▓рпН, роиро╛роЩрпНроХро│рпН рооро╛родро┐ро░ро┐роХрпНроХрпБ роТро░рпБ роТро▒рпНро▒рпИ ро╡ро░ро┐роЪрпИропрпИ роЕройрпБрокрпНрокро┐ройрпЛроорпН, роЕродрпЗроЪрооропроорпН ЁЯдЧ роЯро┐ро░ро╛ройрпНро╕рпНрокро╛ро░рпНрооро░рпНро╕рпН рооро╛родро┐ро░ро┐роХро│рпН роорпБройрпНройро┐ро░рпБрокрпНрокро╛роХ рокро▓ ро╡ро╛роХрпНроХро┐ропроЩрпНроХро│рпИ роОродро┐ро░рпНрокро╛ро░рпНроХрпНроХро┐ройрпНро▒рой. роЗроЩрпНроХрпЗ роиро╛роорпН роТро░рпБ `sequence` роХрпНроХрпБ роЯрпЛроХрпНроХройрпИроЪро░рпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБроорпНрокрпЛродрпБ родро┐ро░рпИроХрпНроХрпБрокрпН рокро┐ройрпНройро╛ро▓рпН роЪрпЖропрпНрод роЕройрпИродрпНродрпИропрпБроорпН роЪрпЖропрпНроп роорпБропро▒рпНроЪро┐родрпНродрпЛроорпН. роЖройро╛ро▓рпН роирпАроЩрпНроХро│рпН роЙройрпНройро┐рокрпНрокро╛роХрокрпН рокро╛ро░рпНродрпНродро╛ро▓рпН, роЯрпЛроХрпНроХройрпИроЪро░рпН роЙро│рпНро│рпАроЯрпНроЯрпБ роРроЯро┐роХро│ро┐ройрпН рокроЯрпНроЯро┐ропро▓рпИ роТро░рпБ роЯрпЖройрпНроЪро░ро╛роХ рооро╛ро▒рпНро▒ро╡ро┐ро▓рпНро▓рпИ роОройрпНрокродрпИ роирпАроЩрпНроХро│рпН роХро╛рогрпНрокрпАро░рпНроХро│рпН, роЕродрпБ роЕродройрпН роорпЗро▓рпН роТро░рпБ рокро░ро┐рооро╛рогродрпНродрпИроЪрпН роЪрпЗро░рпНродрпНродродрпБ:

```py
tokenized_inputs = tokenizer(sequence, return_tensors="pt")
print(tokenized_inputs["input_ids"])
```

```python out
tensor([[  101,  1045,  1005,  2310,  2042,  3403,  2005,  1037, 17662, 12172,
          2607,  2026,  2878,  2166,  1012,   102]])
```

роорпАрогрпНроЯрпБроорпН роорпБропро▒рпНроЪро┐ роЪрпЖропрпНродрпБ роТро░рпБ рокрпБродро┐роп рокро░ро┐рооро╛рогродрпНродрпИроЪрпН роЪрпЗро░рпНрокрпНрокрпЛроорпН:

```py
import torch
from transformers import AutoTokenizer, AutoModelForSequenceClassification

checkpoint = "distilbert-base-uncased-finetuned-sst-2-english"
tokenizer = AutoTokenizer.from_pretrained(checkpoint)
model = AutoModelForSequenceClassification.from_pretrained(checkpoint)

sequence = "I've been waiting for a HuggingFace course my whole life."

tokens = tokenizer.tokenize(sequence)
ids = tokenizer.convert_tokens_to_ids(tokens)

input_ids = torch.tensor([ids])
print("Input IDs:", input_ids)

output = model(input_ids)
print("Logits:", output.logits)
```

роЙро│рпНро│рпАроЯрпНроЯрпБ роРроЯро┐роХро│рпИропрпБроорпН роЕродройрпН ро╡ро┐ро│рпИро╡ро╛роХ ро╡ро░рпБроорпН ро▓ро╛роЬро┐роЯрпНроХро│рпИропрпБроорпН роЕроЪрпНроЪро┐роЯрпБроХро┐ро▒рпЛроорпН тАФ роЗродрпЛ ро╡рпЖро│ро┐ропрпАроЯрпБ:

```python out
Input IDs: [[ 1045,  1005,  2310,  2042,  3403,  2005,  1037, 17662, 12172,  2607, 2026,  2878,  2166,  1012]]
Logits: [[-2.7276,  2.8789]]
```

*рокрпЗроЯрпНроЪро┐роЩрпН* роОройрпНрокродрпБ рокро▓ ро╡ро╛роХрпНроХро┐ропроЩрпНроХро│рпИ роТро░рпЗ роирпЗро░родрпНродро┐ро▓рпН рооро╛родро┐ро░ро┐ роорпВро▓роорпН роЕройрпБрокрпНрокрпБро╡родро╛роХрпБроорпН. роЙроЩрпНроХро│ро┐роЯроорпН роТро░рпЗ роТро░рпБ ро╡ро╛роХрпНроХро┐ропроорпН роороЯрпНроЯрпБроорпЗ роЗро░рпБроирпНродро╛ро▓рпН, роирпАроЩрпНроХро│рпН роТро░рпБ роТро▒рпНро▒рпИ ро╡ро░ро┐роЪрпИропрпБроЯройрпН роТро░рпБ родрпКроХрпБродро┐ропрпИ роЙро░рпБро╡ро╛роХрпНроХро▓ро╛роорпН:

```
batched_ids = [ids, ids]
```

роЗродрпБ роЗро░рогрпНроЯрпБ роТро░рпЗ рооро╛родро┐ро░ро┐ропро╛рой ро╡ро░ро┐роЪрпИроХро│ро┐ройрпН родрпКроХрпБродро┐!

<Tip>

тЬПя╕П **роорпБропро▒рпНроЪро┐ роЪрпЖропрпНродрпБ рокро╛ро░рпБроЩрпНроХро│рпН!** роЗроирпНрод `batched_ids` рокроЯрпНроЯро┐ропро▓рпИ роТро░рпБ роЯрпЖройрпНроЪро░ро╛роХ рооро╛ро▒рпНро▒ро┐ роЙроЩрпНроХро│рпН рооро╛родро┐ро░ро┐ роорпВро▓роорпН роЕройрпБрокрпНрокро╡рпБроорпН. роорпБройрпНрокрпБ роЗро░рпБроирпНрод роЕродрпЗ ро▓ро╛роЬро┐роЯрпНроХро│рпИ (роЖройро╛ро▓рпН роЗро░рогрпНроЯрпБ роорпБро▒рпИ) рокрпЖро▒рпБроХро┐ро▒рпАро░рпНроХро│ро╛ роОройрпНрокродрпИроЪрпН роЪро░ро┐рокро╛ро░рпНроХрпНроХро╡рпБроорпН!

</Tip>

роирпАроЩрпНроХро│рпН рокро▓ ро╡ро╛роХрпНроХро┐ропроЩрпНроХро│рпИ роКроЯрпНроЯрпБроорпНрокрпЛродрпБ рооро╛родро┐ро░ро┐ ро╡рпЗро▓рпИ роЪрпЖропрпНроп рокрпЗроЯрпНроЪро┐роЩрпН роЕройрпБроородро┐роХрпНроХро┐ро▒родрпБ. рокро▓ ро╡ро░ро┐роЪрпИроХро│рпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡родрпБ роТро░рпБ роТро▒рпНро▒рпИ ро╡ро░ро┐роЪрпИропрпБроЯройрпН роТро░рпБ родрпКроХрпБродро┐ропрпИ роЙро░рпБро╡ро╛роХрпНроХрпБро╡родрпБ рокрпЛро▓ роОро│ро┐роорпИропро╛ройродрпБ. роЗро░рпБрокрпНрокро┐ройрпБроорпН, роЗро░рогрпНроЯро╛ро╡родрпБ роЪро┐роХрпНроХро▓рпН роЙро│рпНро│родрпБ. роирпАроЩрпНроХро│рпН роЗро░рогрпНроЯрпБ (роЕро▓рпНро▓родрпБ роЕродро▒рпНроХрпБ роорпЗро▒рпНрокроЯрпНроЯ) ро╡ро╛роХрпНроХро┐ропроЩрпНроХро│рпИ роТройрпНро▒ро╛роХродрпН родрпКроХрпБроХрпНроХ роорпБропро▒рпНроЪро┐роХрпНроХрпБроорпНрокрпЛродрпБ, роЕро╡рпИ ро╡рпЖро╡рпНро╡рпЗро▒рпБ роирпАро│роЩрпНроХро│ро┐ро▓рпН роЗро░рпБроХрпНроХро▓ро╛роорпН. роирпАроЩрпНроХро│рпН роЗродро▒рпНроХрпБ роорпБройрпНрокрпБ роЯрпЖройрпНроЪро░рпНроХро│рпБроЯройрпН рокрогро┐рокрпБро░ро┐роирпНродро┐ро░рпБроирпНродро╛ро▓рпН, роЕро╡рпИ роЪрпЖро╡рпНро╡роХ ро╡роЯро┐ро╡родрпНродро┐ро▓рпН роЗро░рпБроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН роОройрпНрокродрпБ роЙроЩрпНроХро│рпБроХрпНроХрпБродрпН родрпЖро░ро┐ропрпБроорпН, роОройро╡рпЗ роЙро│рпНро│рпАроЯрпНроЯрпБ роРроЯро┐роХро│ро┐ройрпН рокроЯрпНроЯро┐ропро▓рпИ роирпЗро░роЯро┐ропро╛роХ роТро░рпБ роЯрпЖройрпНроЪро░ро╛роХ рооро╛ро▒рпНро▒ роорпБроЯро┐ропро╛родрпБ. роЗроирпНродроЪрпН роЪро┐роХрпНроХро▓рпИроЪрпН роЪрооро╛ро│ро┐роХрпНроХ, роиро╛роорпН ро╡ро┤роХрпНроХрооро╛роХ роЙро│рпНро│рпАроЯрпБроХро│рпИ *рокрпЗроЯрпН* роЪрпЖропрпНроХро┐ро▒рпЛроорпН.

## роЙро│рпНро│рпАроЯрпБроХро│рпИ рокрпЗроЯро┐роЩрпН роЪрпЖропрпНродро▓рпН[[padding-the-inputs]]

рокро┐ройрпНро╡ро░рпБроорпН рокроЯрпНроЯро┐ропро▓рпНроХро│ро┐ройрпН рокроЯрпНроЯро┐ропро▓рпИ роТро░рпБ роЯрпЖройрпНроЪро░ро╛роХ рооро╛ро▒рпНро▒ роорпБроЯро┐ропро╛родрпБ:

```py no-format
batched_ids = [
    [200, 200, 200],
    [200, 200]
]
```

роЗродрпИроЪрпН роЪрооро╛ро│ро┐роХрпНроХ, роироородрпБ роЯрпЖройрпНроЪро░рпНроХро│рпИ роЪрпЖро╡рпНро╡роХ ро╡роЯро┐ро╡родрпНродро┐ро▓рпН рооро╛ро▒рпНро▒ *рокрпЗроЯро┐роЩрпН* роРрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡рпЛроорпН. роХрпБро▒рпИро╡ро╛рой роородро┐рокрпНрокрпБроХро│рпН роХрпКрогрпНроЯ ро╡ро╛роХрпНроХро┐ропроЩрпНроХро│ро┐ро▓рпН *рокрпЗроЯро┐роЩрпН роЯрпЛроХрпНроХройрпН* роОройрокрпНрокроЯрпБроорпН роТро░рпБ роЪро┐ро▒рокрпНрокрпБ ро╡ро╛ро░рпНродрпНродрпИропрпИроЪрпН роЪрпЗро░рпНрокрпНрокродройрпН роорпВро▓роорпН роироородрпБ роОро▓рпНро▓ро╛ ро╡ро╛роХрпНроХро┐ропроЩрпНроХро│рпБроорпН роТро░рпЗ роирпАро│родрпНродрпИроХрпН роХрпКрогрпНроЯро┐ро░рпБрокрпНрокродрпИ рокрпЗроЯро┐роЩрпН роЙро▒рпБродро┐ роЪрпЖропрпНроХро┐ро▒родрпБ. роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯро╛роХ, роЙроЩрпНроХро│ро┐роЯроорпН 10 ро╡ро╛ро░рпНродрпНродрпИроХро│рпИроХрпН роХрпКрогрпНроЯ 10 ро╡ро╛роХрпНроХро┐ропроЩрпНроХро│рпБроорпН 20 ро╡ро╛ро░рпНродрпНродрпИроХро│рпИроХрпН роХрпКрогрпНроЯ 1 ро╡ро╛роХрпНроХро┐ропроорпБроорпН роЗро░рпБроирпНродро╛ро▓рпН, роОро▓рпНро▓ро╛ ро╡ро╛роХрпНроХро┐ропроЩрпНроХро│рпБроорпН 20 ро╡ро╛ро░рпНродрпНродрпИроХро│рпИроХрпН роХрпКрогрпНроЯро┐ро░рпБрокрпНрокродрпИ рокрпЗроЯро┐роЩрпН роЙро▒рпБродро┐ роЪрпЖропрпНропрпБроорпН. роироородрпБ роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯро┐ро▓рпН, роЗродройрпН ро╡ро┐ро│рпИро╡ро╛роХ ро╡ро░рпБроорпН роЯрпЖройрпНроЪро░рпН роЗродрпБрокрпЛро▓рпН родрпЖро░ро┐роХро┐ро▒родрпБ:

```py no-format
padding_id = 100

batched_ids = [
    [200, 200, 200],
    [200, 200, padding_id],
]
```

рокрпЗроЯро┐роЩрпН роЯрпЛроХрпНроХройрпН роРроЯро┐ропрпИ `tokenizer.pad_token_id` роЗро▓рпН роХро╛рогро▓ро╛роорпН. роЕродрпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ роироородрпБ роЗро░рогрпНроЯрпБ ро╡ро╛роХрпНроХро┐ропроЩрпНроХро│рпИропрпБроорпН родройро┐родрпНродройро┐ропро╛роХро╡рпБроорпН родрпКроХрпБродро┐ропро╛роХро╡рпБроорпН рооро╛родро┐ро░ро┐ роорпВро▓роорпН роЕройрпБрокрпНрокрпБро╡рпЛроорпН:

```py no-format
model = AutoModelForSequenceClassification.from_pretrained(checkpoint)

sequence1_ids = [[200, 200, 200]]
sequence2_ids = [[200, 200]]
batched_ids = [
    [200, 200, 200],
    [200, 200, tokenizer.pad_token_id],
]

print(model(torch.tensor(sequence1_ids)).logits)
print(model(torch.tensor(sequence2_ids)).logits)
print(model(torch.tensor(batched_ids)).logits)
```

```python out
tensor([[ 1.5694, -1.3895]], grad_fn=<AddmmBackward>)
tensor([[ 0.5803, -0.4125]], grad_fn=<AddmmBackward>)
tensor([[ 1.5694, -1.3895],
        [ 1.3373, -1.2163]], grad_fn=<AddmmBackward>)
```

роироородрпБ родрпКроХрпБроХрпНроХрокрпНрокроЯрпНроЯ роХрогро┐рокрпНрокрпБроХро│ро┐ро▓рпН роЙро│рпНро│ ро▓ро╛роЬро┐роЯрпНроХро│ро┐ро▓рпН роПродрпЛ родро╡ро▒рпБ роЗро░рпБроХрпНроХро┐ро▒родрпБ: роЗро░рогрпНроЯро╛ро╡родрпБ ро╡ро░ро┐роЪрпИ роЗро░рогрпНроЯро╛ро╡родрпБ ро╡ро╛роХрпНроХро┐ропродрпНродро┐ро▒рпНроХро╛рой ро▓ро╛роЬро┐роЯрпНроХро│рпИрокрпН рокрпЛро▓ро╡рпЗ роЗро░рпБроХрпНроХ ро╡рпЗрогрпНроЯрпБроорпН, роЖройро╛ро▓рпН роиро╛роорпН роорпБро▒рпНро▒ро┐ро▓рпБроорпН рооро╛ро▒рпБрокроЯрпНроЯ роородро┐рокрпНрокрпБроХро│рпИрокрпН рокрпЖро▒рпНро▒рпБро│рпНро│рпЛроорпН!

роЯро┐ро░ро╛ройрпНро╕рпНрокро╛ро░рпНрооро░рпН рооро╛родро┐ро░ро┐роХро│ро┐ройрпН роорпБроХрпНроХро┐роп роЕроорпНроЪроорпН роТро╡рпНро╡рпКро░рпБ роЯрпЛроХрпНроХройрпИропрпБроорпН *роЪрпВро┤ро▓рпНрооропрооро╛роХрпНроХрпБроорпН* роХро╡рой роЕроЯрпБроХрпНроХрпБроХро│ро╛роХрпБроорпН. роТро░рпБ ро╡ро░ро┐роЪрпИропро┐ройрпН роЕройрпИродрпНродрпБ роЯрпЛроХрпНроХройрпНроХро│рпИропрпБроорпН роЕро╡рпИ роХро╡ройро┐рокрпНрокродро╛ро▓рпН, роЗроирпНрод рокрпЗроЯро┐роЩрпН роЯрпЛроХрпНроХройрпНроХро│рпИ роЕро╡рпИ роХрогроХрпНроХро┐ро▓рпН роОроЯрпБродрпНродрпБроХрпНроХрпКро│рпНро│рпБроорпН. ро╡рпЖро╡рпНро╡рпЗро▒рпБ роирпАро│роорпБро│рпНро│ родройро┐рокрпНрокроЯрпНроЯ ро╡ро╛роХрпНроХро┐ропроЩрпНроХро│рпИ рооро╛родро┐ро░ро┐ роорпВро▓роорпН роЕройрпБрокрпНрокрпБроорпНрокрпЛродрпБ роЕро▓рпНро▓родрпБ роЕродрпЗ ро╡ро╛роХрпНроХро┐ропроЩрпНроХро│рпН рооро▒рпНро▒рпБроорпН рокрпЗроЯро┐роЩрпН рокропройрпНрокроЯрпБродрпНродрокрпНрокроЯрпНроЯ роТро░рпБ родрпКроХрпБродро┐ропрпИ роЕройрпБрокрпНрокрпБроорпНрокрпЛродрпБ роЕродрпЗ роорпБроЯро┐ро╡рпИрокрпН рокрпЖро▒, роЕроирпНрод роХро╡рой роЕроЯрпБроХрпНроХрпБроХро│рпБроХрпНроХрпБ рокрпЗроЯро┐роЩрпН роЯрпЛроХрпНроХройрпНроХро│рпИрокрпН рокрпБро▒роХрпНроХрогро┐роХрпНроХроЪрпН роЪрпКро▓рпНро▓ ро╡рпЗрогрпНроЯрпБроорпН. роЗродрпБ роТро░рпБ роХро╡рой роорпБроХроорпВроЯро┐ропрпИрокрпН рокропройрпНрокроЯрпБродрпНродрпБро╡родройрпН роорпВро▓роорпН роЪрпЖропрпНропрокрпНрокроЯрпБроХро┐ро▒родрпБ.

## роХро╡рой роорпБроХроорпВроЯро┐роХро│рпН[[attention-masks]]

*роХро╡рой роорпБроХроорпВроЯро┐роХро│рпН* роЙро│рпНро│рпАроЯрпНроЯрпБ роРроЯро┐роХро│рпН роЯрпЖройрпНроЪро░ро┐ройрпН роЕродрпЗ ро╡роЯро┐ро╡родрпНродрпИроХрпН роХрпКрогрпНроЯ роЯрпЖройрпНроЪро░рпНроХро│рпН, 0роХро│рпН рооро▒рпНро▒рпБроорпН 1роХро│ро╛ро▓рпН роиро┐ро░рокрпНрокрокрпНрокроЯрпНроЯро╡рпИ: 1роХро│рпН родрпКроЯро░рпНрокрпБроЯрпИроп роЯрпЛроХрпНроХройрпНроХро│рпН роХро╡ройро┐роХрпНроХрокрпНрокроЯ ро╡рпЗрогрпНроЯрпБроорпН роОройрпНрокродрпИроХрпН роХрпБро▒ро┐роХрпНроХро┐ройрпНро▒рой, роорпЗро▓рпБроорпН 0роХро│рпН родрпКроЯро░рпНрокрпБроЯрпИроп роЯрпЛроХрпНроХройрпНроХро│рпН роХро╡ройро┐роХрпНроХрокрпНрокроЯроХрпНроХрпВроЯро╛родрпБ роОройрпНрокродрпИроХрпН роХрпБро▒ро┐роХрпНроХро┐ройрпНро▒рой (роЕродро╛ро╡родрпБ, роЕро╡рпИ рооро╛родро┐ро░ро┐ропро┐ройрпН роХро╡рой роЕроЯрпБроХрпНроХрпБроХро│ро╛ро▓рпН рокрпБро▒роХрпНроХрогро┐роХрпНроХрокрпНрокроЯ ро╡рпЗрогрпНроЯрпБроорпН).

роорпБроирпНродрпИроп роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпИ роТро░рпБ роХро╡рой роорпБроХроорпВроЯро┐ропрпБроЯройрпН р░кр▒Вр░░р▒Нр░др░┐ р░Ър▒Зр░жр▒Нр░жр░╛р░В:

```py no-format
batched_ids = [
    [200, 200, 200],
    [200, 200, tokenizer.pad_token_id],
]

attention_mask = [
    [1, 1, 1],
    [1, 1, 0],
]

outputs = model(torch.tensor(batched_ids), attention_mask=torch.tensor(attention_mask))
print(outputs.logits)
```

```python out
tensor([[ 1.5694, -1.3895],
        [ 0.5803, -0.4125]], grad_fn=<AddmmBackward>)
```

роЗрокрпНрокрпЛродрпБ родрпКроХрпБрокрпНрокро┐ро▓рпН роЙро│рпНро│ роЗро░рогрпНроЯро╛ро╡родрпБ ро╡ро╛роХрпНроХро┐ропродрпНродро┐ро▒рпНроХрпБ роЕродрпЗ ро▓ро╛роЬро┐роЯрпНроХро│рпИрокрпН рокрпЖро▒рпБроХро┐ро▒рпЛроорпН.

роЗро░рогрпНроЯро╛ро╡родрпБ ро╡ро░ро┐роЪрпИропро┐ройрпН роХроЯрпИроЪро┐ роородро┐рокрпНрокрпБ роТро░рпБ рокрпЗроЯро┐роЩрпН роРроЯро┐ роОройрпНрокродрпИ роХро╡ройро┐ропрпБроЩрпНроХро│рпН, роЗродрпБ роХро╡рой роорпБроХроорпВроЯро┐ропро┐ро▓рпН 0 роородро┐рокрпНрокро╛роХрпБроорпН.

<Tip>

тЬПя╕П **роорпБропро▒рпНроЪро┐ роЪрпЖропрпНродрпБ рокро╛ро░рпБроЩрпНроХро│рпН!** рокро┐ро░ро┐ро╡рпБ 2 роЗро▓рпН рокропройрпНрокроЯрпБродрпНродрокрпНрокроЯрпНроЯ роЗро░рогрпНроЯрпБ ро╡ро╛роХрпНроХро┐ропроЩрпНроХро│ро┐ро▓рпН ("I've been waiting for a HuggingFace course my whole life." рооро▒рпНро▒рпБроорпН "I hate this so much!") роЯрпЛроХрпНроХройрпИроЪрпЗро╖ройрпИ роХрпИроорпБро▒рпИропро╛роХрокрпН рокропройрпНрокроЯрпБродрпНродрпБроЩрпНроХро│рпН. роЕро╡ро▒рпНро▒рпИ рооро╛родро┐ро░ро┐ роорпВро▓роорпН роЕройрпБрокрпНрокро┐, рокро┐ро░ро┐ро╡рпБ 2 роЗро▓рпН роЙро│рпНро│ роЕродрпЗ ро▓ро╛роЬро┐роЯрпНроХро│рпИрокрпН рокрпЖро▒рпБроХро┐ро▒рпАро░рпНроХро│ро╛ роОройрпНрокродрпИроЪрпН роЪро░ро┐рокро╛ро░рпНроХрпНроХро╡рпБроорпН. роЗрокрпНрокрпЛродрпБ рокрпЗроЯро┐роЩрпН роЯрпЛроХрпНроХройрпИрокрпН рокропройрпНрокроЯрпБродрпНродро┐ роЕро╡ро▒рпНро▒рпИ роТройрпНро▒ро╛роХродрпН родрпКроХрпБроХрпНроХро╡рпБроорпН, рокро┐ройрпНройро░рпН роЪро░ро┐ропро╛рой роХро╡рой роорпБроХроорпВроЯро┐ропрпИ роЙро░рпБро╡ро╛роХрпНроХро╡рпБроорпН. рооро╛родро┐ро░ро┐ роорпВро▓роорпН роЪрпЖро▓рпНро▓рпБроорпНрокрпЛродрпБ роЕродрпЗ роорпБроЯро┐ро╡рпБроХро│рпИрокрпН рокрпЖро▒рпБроХро┐ро▒рпАро░рпНроХро│ро╛ роОройрпНрокродрпИроЪрпН роЪро░ро┐рокро╛ро░рпНроХрпНроХро╡рпБроорпН!

</Tip>

## роирпАрогрпНроЯ ро╡ро░ро┐роЪрпИроХро│рпН[[longer-sequences]]

роЯро┐ро░ро╛ройрпНро╕рпНрокро╛ро░рпНрооро░рпН рооро╛родро┐ро░ро┐роХро│рпБроЯройрпН, роиро╛роорпН рооро╛родро┐ро░ро┐роХро│рпБроХрпНроХрпБ роЕройрпБрокрпНрокроХрпНроХрпВроЯро┐роп ро╡ро░ро┐роЪрпИроХро│ро┐ройрпН роирпАро│родрпНродро┐ро▒рпНроХрпБ роТро░рпБ ро╡ро░роорпНрокрпБ роЙро│рпНро│родрпБ. рокрпЖро░рпБроорпНрокро╛ро▓ро╛рой рооро╛родро┐ро░ро┐роХро│рпН 512 роЕро▓рпНро▓родрпБ 1024 роЯрпЛроХрпНроХройрпНроХро│рпН ро╡ро░рпИропро┐ро▓ро╛рой ро╡ро░ро┐роЪрпИроХро│рпИроХрпН роХрпИропро╛ро│рпБроХро┐ройрпНро▒рой, роорпЗро▓рпБроорпН роирпАрогрпНроЯ ро╡ро░ро┐роЪрпИроХро│рпИроЪрпН роЪрпЖропро▓ро╛роХрпНроХроХрпН роХрпЗроЯрпНроЯро╛ро▓рпН роЪрпЖропро▓ро┐ро┤роирпНродрпБро╡ро┐роЯрпБроорпН. роЗроирпНродроЪрпН роЪро┐роХрпНроХро▓рпБроХрпНроХрпБ роЗро░рогрпНроЯрпБ родрпАро░рпНро╡рпБроХро│рпН роЙро│рпНро│рой:

- роирпАрогрпНроЯ роЖродро░ро╡ро│ро┐роХрпНроХрокрпНрокроЯрпНроЯ ро╡ро░ро┐роЪрпИ роирпАро│родрпНродрпБроЯройрпН роТро░рпБ рооро╛родро┐ро░ро┐ропрпИрокрпН рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН.
- роЙроЩрпНроХро│рпН ро╡ро░ро┐роЪрпИроХро│рпИроЪрпН роЪрпБро░рпБроХрпНроХро╡рпБроорпН.

рооро╛родро┐ро░ро┐роХро│рпН ро╡рпЖро╡рпНро╡рпЗро▒рпБ роЖродро░ро╡ро│ро┐роХрпНроХрокрпНрокроЯрпНроЯ ро╡ро░ро┐роЪрпИ роирпАро│роЩрпНроХро│рпИроХрпН роХрпКрогрпНроЯрпБро│рпНро│рой, роорпЗро▓рпБроорпН роЪро┐ро▓ рооро┐роХ роирпАрогрпНроЯ ро╡ро░ро┐роЪрпИроХро│рпИроХрпН роХрпИропро╛ро│рпНро╡родро┐ро▓рпН роиро┐рокрпБрогродрпНродрпБро╡роорпН рокрпЖро▒рпНро▒ро╡рпИ. [Longformer](https://huggingface.co/docs/transformers/model_doc/longformer) роТро░рпБ роОроЯрпБродрпНродрпБроХрпНроХро╛роЯрпНроЯрпБ, рооро▒рпНро▒рпКройрпНро▒рпБ [LED](https://huggingface.co/docs/transformers/model_doc/led). роирпАроЩрпНроХро│рпН рооро┐роХ роирпАрогрпНроЯ ро╡ро░ро┐роЪрпИроХро│рпН родрпЗро╡рпИрокрпНрокроЯрпБроорпН роТро░рпБ рокрогро┐ропро┐ро▓рпН рокрогро┐рокрпБро░ро┐роХро┐ро▒рпАро░рпНроХро│рпН роОройрпНро▒ро╛ро▓рпН, роЕроирпНрод рооро╛родро┐ро░ро┐роХро│рпИрокрпН рокро╛ро░рпНроХрпНроХ роиро╛роЩрпНроХро│рпН рокро░ро┐роирпНродрпБро░рпИроХрпНроХро┐ро▒рпЛроорпН.

роЗро▓рпНро▓рпИропрпЖройро┐ро▓рпН, `max_sequence_length` роЕро│ро╡рпБро░рпБро╡рпИроХрпН роХрпБро▒ро┐рокрпНрокро┐роЯрпБро╡родройрпН роорпВро▓роорпН роЙроЩрпНроХро│рпН ро╡ро░ро┐роЪрпИроХро│рпИроЪрпН роЪрпБро░рпБроХрпНроХ роиро╛роЩрпНроХро│рпН рокро░ро┐роирпНродрпБро░рпИроХрпНроХро┐ро▒рпЛроорпН:

```py
sequence = sequence[:max_sequence_length]
```
