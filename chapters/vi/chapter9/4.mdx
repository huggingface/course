# Chia sáº» cÃ¡c báº£n demo vá»›i ngÆ°á»i khÃ¡c

<DocNotebookDropdown
  classNames="absolute z-10 right-0 top-0"
  options={[
    {label: "Google Colab", value: "https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/vi/chapter9/section4.ipynb"},
    {label: "Aws Studio", value: "https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/vi/chapter9/section4.ipynb"},
]} />

BÃ¢y giá» báº¡n Ä‘Ã£ xÃ¢y dá»±ng má»™t báº£n demo, cÃ³ thá»ƒ báº¡n sáº½ muá»‘n chia sáº» nÃ³ vá»›i nhá»¯ng ngÆ°á»i khÃ¡c. CÃ¡c báº£n demo Gradio cÃ³ thá»ƒ Ä‘Æ°á»£c chia sáº» theo hai cÃ¡ch: sá»­ dá»¥ng má»™t ***Ä‘Æ°á»ng dáº«n chia sáº» táº¡m thá»i*** hoáº·c ***lÆ°u trá»¯ vÄ©nh viá»…n trÃªn Spaces***.

ChÃºng tÃ´i sáº½ Ä‘á» cáº­p Ä‘áº¿n cáº£ hai cÃ¡ch tiáº¿p cáº­n nÃ y ngay sau Ä‘Ã¢y. NhÆ°ng trÆ°á»›c khi chia sáº» báº£n demo cá»§a mÃ¬nh, báº¡n cÃ³ thá»ƒ muá»‘n Ä‘Ã¡nh bÃ³ng nÃ³ ğŸ’….

### ÄÃ¡nh bÃ³ng Gradio demo cá»§a báº¡n:

<div class="flex justify-center">
<img class="block dark:hidden" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter9/gradio-demo-overview.png" alt="Overview of a gradio interface">
<img class="hidden dark:block" src="https://huggingface.co/datasets/huggingface-course/documentation-images/resolve/main/en/chapter9/gradio-demo-overview-dark.png" alt="Overview of a gradio interface">
</div>

Äá»ƒ thÃªm ná»™i dung bá»• sung vÃ o báº£n demo cá»§a báº¡n, lá»›p `Interface` há»— trá»£ má»™t sá»‘ tham sá»‘ tÃ¹y chá»n:
    - `title`: báº¡n cÃ³ thá»ƒ Ä‘áº·t tiÃªu Ä‘á» cho báº£n demo cá»§a mÃ¬nh, xuáº¥t hiá»‡n _phÃ­a trÃªn_ cÃ¡c thÃ nh pháº§n Ä‘áº§u vÃ o vÃ  Ä‘áº§u ra.
    - `description`: báº¡n cÃ³ thá»ƒ Ä‘Æ°a ra mÃ´ táº£ (báº±ng vÄƒn báº£n, Markdown hoáº·c HTML) cho giao diá»‡n, xuáº¥t hiá»‡n phÃ­a trÃªn cÃ¡c thÃ nh pháº§n Ä‘áº§u vÃ o vÃ  Ä‘áº§u ra vÃ  bÃªn dÆ°á»›i tiÃªu Ä‘á».
    - `article`: báº¡n cÅ©ng cÃ³ thá»ƒ viáº¿t má»™t bÃ i bÃ¡o má»Ÿ rá»™ng (báº±ng vÄƒn báº£n, Markdown hoáº·c HTML) giáº£i thÃ­ch vá» giao diá»‡n. Náº¿u Ä‘Æ°á»£c cung cáº¥p, nÃ³ sáº½ xuáº¥t hiá»‡n _bÃªn dÆ°á»›i_ cÃ¡c thÃ nh pháº§n Ä‘áº§u vÃ o vÃ  Ä‘áº§u ra.
    - `theme`: báº¡n khÃ´ng thÃ­ch mÃ u máº·c Ä‘á»‹nh? Äáº·t chá»§ Ä‘á» Ä‘á»ƒ sá»­ dá»¥ng má»™t trong cÃ¡c `default`, `huggingface`, `grass`, `peach`. Báº¡n cÅ©ng cÃ³ thá»ƒ thÃªm tiá»n tá»‘ `dark-`, vÃ­ dá»¥: `dark-peach` cho chá»§ Ä‘á» tá»‘i (hoáº·c chá»‰ `dark` cho chá»§ Ä‘á» tá»‘i máº·c Ä‘á»‹nh).
    - `examples`: Ä‘á»ƒ lÃ m cho báº£n demo cá»§a báº¡n *dá»… sá»­ dá»¥ng hÆ¡n*, báº¡n cÃ³ thá»ƒ cung cáº¥p má»™t sá»‘ Ä‘áº§u vÃ o vÃ­ dá»¥ cho hÃ m. ChÃºng xuáº¥t hiá»‡n bÃªn dÆ°á»›i cÃ¡c thÃ nh pháº§n giao diá»‡n ngÆ°á»i dÃ¹ng vÃ  cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ Ä‘iá»n vÃ o giao diá»‡n. ChÃºng pháº£i Ä‘Æ°á»£c cung cáº¥p dÆ°á»›i dáº¡ng danh sÃ¡ch lá»“ng nhau, trong Ä‘Ã³ danh sÃ¡ch bÃªn ngoÃ i bao gá»“m cÃ¡c máº«u vÃ  má»—i danh sÃ¡ch bÃªn trong bao gá»“m má»™t Ä‘áº§u vÃ o tÆ°Æ¡ng á»©ng vá»›i má»—i thÃ nh pháº§n Ä‘áº§u vÃ o.
    - `live`: náº¿u báº¡n muá»‘n lÃ m cho báº£n demo cá»§a mÃ¬nh "sá»‘ng Ä‘á»™ng", nghÄ©a lÃ  mÃ´ hÃ¬nh cá»§a báº¡n cháº¡y láº¡i má»—i khi Ä‘áº§u vÃ o thay Ä‘á»•i, báº¡n cÃ³ thá»ƒ Ä‘áº·t `live=True`. Äiá»u nÃ y há»£p lÃ½ khi sá»­ dá»¥ng vá»›i cÃ¡c mÃ´ hÃ¬nh nhanh (chÃºng ta sáº½ xem má»™t vÃ­ dá»¥ á»Ÿ cuá»‘i pháº§n nÃ y)
Sá»­ dá»¥ng cÃ¡c tÃ¹y chá»n á»Ÿ trÃªn, chÃºng ta káº¿t thÃºc vá»›i má»™t giao diá»‡n hoÃ n chá»‰nh hÆ¡n. Cháº¡y Ä‘oáº¡n mÃ£ dÆ°á»›i Ä‘Ã¢y Ä‘á»ƒ báº¡n cÃ³ thá»ƒ trÃ² chuyá»‡n vá»›i Rick vÃ  Morty:

```py
title = "Ask Rick a Question"
description = """
The bot was trained to answer questions based on Rick and Morty dialogues. Ask Rick anything!
<img src="https://huggingface.co/spaces/course-demos/Rick_and_Morty_QA/resolve/main/rick.png" width=200px>
"""

article = "Check out [the original Rick and Morty Bot](https://huggingface.co/spaces/kingabzpro/Rick_and_Morty_Bot) that this demo is based off of."

gr.Interface(
    fn=predict,
    inputs="textbox",
    outputs="text",
    title=title,
    description=description,
    article=article,
    examples=[["What are you doing?"], ["Where should we time travel to?"]],
).launch()
```

Sá»­ dá»¥ng cÃ¡c tÃ¹y chá»n á»Ÿ trÃªn, chÃºng ta káº¿t thÃºc vá»›i má»™t giao diá»‡n hoÃ n chá»‰nh hÆ¡n. HÃ£y thá»­ giao diá»‡n bÃªn dÆ°á»›i:

<iframe src="https://course-demos-Rick-and-Morty-QA.hf.space" frameBorder="0" height="800" title="Gradio app" class="container p-0 flex-grow space-iframe" allow="accelerometer; ambient-light-sensor; autoplay; battery; camera; document-domain; encrypted-media; fullscreen; geolocation; gyroscope; layout-animations; legacy-image-formats; magnetometer; microphone; midi; oversized-images; payment; picture-in-picture; publickey-credentials-get; sync-xhr; usb; vr ; wake-lock; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-downloads"></iframe>

### Chia sáº» báº£n demo cá»§a báº¡n vá»›i cÃ¡c liÃªn káº¿t táº¡m thá»i

BÃ¢y giá» chÃºng ta Ä‘Ã£ cÃ³ báº£n demo hoáº¡t Ä‘á»™ng cá»§a mÃ´ hÃ¬nh há»c mÃ¡y cá»§a mÃ¬nh, hÃ£y tÃ¬m hiá»ƒu cÃ¡ch dá»… dÃ ng chia sáº» liÃªn káº¿t Ä‘áº¿n giao diá»‡n cá»§a chÃºng ta.
CÃ¡c giao diá»‡n cÃ³ thá»ƒ dá»… dÃ ng Ä‘Æ°á»£c chia sáº» cÃ´ng khai báº±ng cÃ¡ch Ä‘áº·t `share=True` trong phÆ°Æ¡ng thá»©c `launch()`:

```python
gr.Interface(classify_image, "image", "label").launch(share=True)
```

Äiá»u nÃ y táº¡o ra má»™t liÃªn káº¿t cÃ´ng khai, cÃ³ thá»ƒ chia sáº» mÃ  báº¡n cÃ³ thá»ƒ gá»­i cho báº¥t ká»³ ai! Khi báº¡n gá»­i liÃªn káº¿t nÃ y, ngÆ°á»i dÃ¹ng á»Ÿ phÃ­a bÃªn kia cÃ³ thá»ƒ dÃ¹ng thá»­ mÃ´ hÃ¬nh trong trÃ¬nh duyá»‡t cá»§a há» trong tá»‘i Ä‘a 72 giá». VÃ¬ quÃ¡ trÃ¬nh xá»­ lÃ½ diá»…n ra trÃªn thiáº¿t bá»‹ cá»§a báº¡n (miá»…n lÃ  thiáº¿t bá»‹ cá»§a báº¡n váº«n báº­t!), Báº¡n khÃ´ng pháº£i lo láº¯ng vá» viá»‡c Ä‘Ã³ng gÃ³i báº¥t ká»³ thÆ° viá»‡n phá»¥ thuá»™c nÃ o. Náº¿u báº¡n Ä‘ang lÃ m viá»‡c vá»›i notebook Google Colab, liÃªn káº¿t chia sáº» luÃ´n Ä‘Æ°á»£c táº¡o tá»± Ä‘á»™ng. NÃ³ thÆ°á»ng trÃ´ng giá»‘ng nhÆ° sau: **XXXXX.gradio.app**. Máº·c dÃ¹ liÃªn káº¿t Ä‘Æ°á»£c cung cáº¥p thÃ´ng qua liÃªn káº¿t Gradio, ta chá»‰ lÃ  má»™t proxy cho mÃ¡y chá»§ cá»¥c bá»™ cá»§a mÃ¬nh vÃ  khÃ´ng lÆ°u trá»¯ báº¥t ká»³ dá»¯ liá»‡u nÃ o Ä‘Æ°á»£c gá»­i qua cÃ¡c giao diá»‡n.

Tuy nhiÃªn, hÃ£y nhá»› ráº±ng cÃ¡c liÃªn káº¿t nÃ y cÃ³ thá»ƒ truy cáº­p cÃ´ng khai, cÃ³ nghÄ©a lÃ  báº¥t ká»³ ai cÅ©ng cÃ³ thá»ƒ sá»­ dá»¥ng mÃ´ hÃ¬nh cá»§a báº¡n Ä‘á»ƒ dá»± Ä‘oÃ¡n! Do Ä‘Ã³, hÃ£y Ä‘áº£m báº£o khÃ´ng Ä‘á»ƒ lá»™ báº¥t ká»³ thÃ´ng tin nháº¡y cáº£m nÃ o thÃ´ng qua cÃ¡c hÃ m báº¡n viáº¿t hoáº·c cho phÃ©p báº¥t ká»³ thay Ä‘á»•i quan trá»ng nÃ o xáº£y ra trÃªn thiáº¿t bá»‹ cá»§a báº¡n. Náº¿u báº¡n Ä‘áº·t `share=False` (máº·c Ä‘á»‹nh), chá»‰ má»™t liÃªn káº¿t cá»¥c bá»™ Ä‘Æ°á»£c táº¡o.

### LÆ°u trá»¯ báº£n demo cá»§a báº¡n trÃªn Hugging Face Spaces

Má»™t Ä‘Æ°á»ng dáº«n liÃªn káº¿t mÃ  báº¡n cÃ³ thá»ƒ chia sáº» cho cÃ¡c Ä‘á»“ng nghiá»‡p tháº­t tuyá»‡t, nhÆ°ng lÃ m tháº¿ nÃ o báº¡n cÃ³ thá»ƒ lÆ°u trá»¯ vÄ©nh viá»…n báº£n demo cá»§a mÃ¬nh vÃ  Ä‘á»ƒ báº£n demo tá»“n táº¡i trong "khÃ´ng gian" riÃªng cá»§a nÃ³ trÃªn internet?

Hugging Face Space cung cáº¥p cÆ¡ sá»Ÿ háº¡ táº§ng Ä‘á»ƒ lÆ°u trá»¯ vÄ©nh viá»…n mÃ´ hÃ¬nh Gradio cá»§a báº¡n trÃªn internet, **miá»…n phÃ­**! Spaces cho phÃ©p báº¡n táº¡o vÃ  Ä‘áº©y lÃªn kho (cÃ´ng khai hoáº·c riÃªng tÆ°), nÆ¡i giao diá»‡n Gradio cá»§a báº¡n sáº½ tá»“n táº¡i trong tá»‡p `app.py`. [Äá»c hÆ°á»›ng dáº«n tá»«ng bÆ°á»›c](https://huggingface.co/blog/gradio-spaces) Ä‘á»ƒ báº¯t Ä‘áº§u hoáº·c xem video vÃ­ dá»¥ bÃªn dÆ°á»›i.

<Youtube id="LS9Y2wDVI0k" />

## âœï¸ CÃ¹ng Ã¡p dá»¥ng nhÃ©!

Sá»­ dá»¥ng nhá»¯ng gÃ¬ chÃºng ta vá»«a há»c Ä‘Æ°á»£c trong cÃ¡c pháº§n cho Ä‘áº¿n nay, hÃ£y táº¡o báº£n demo nháº­n dáº¡ng phÃ¡c tháº£o mÃ  ta Ä‘Ã£ tháº¥y trong [pháº§n má»™t cá»§a chÆ°Æ¡ng nÃ y](/course/chapter9/1). HÃ£y thÃªm má»™t sá»‘ tÃ¹y chá»‰nh vÃ o giao diá»‡n vÃ  Ä‘áº·t `share=True` Ä‘á»ƒ táº¡o má»™t liÃªn káº¿t cÃ´ng khai mÃ  ta cÃ³ thá»ƒ chia sáº».

ChÃºng ra cÃ³ thá»ƒ táº£i cÃ¡c nhÃ£n tá»« [class_names.txt](https://huggingface.co/spaces/dawood/Sketch-Recognition/blob/main/class_names.txt) vÃ  táº£i mÃ´ hÃ¬nh pytorch Ä‘Æ°á»£c huáº¥n luyá»‡n trÆ°á»›c tá»« [pytorch_model.bin] (https://huggingface.co/spaces/dawood/Sketch-Recognition/blob/main/pytorch_model.bin). Táº£i xuá»‘ng cÃ¡c tá»‡p nÃ y báº±ng cÃ¡ch nháº¥p vÃ o liÃªn káº¿t vÃ  nháº¥p vÃ o táº£i xuá»‘ng á»Ÿ gÃ³c trÃªn cÃ¹ng bÃªn trÃ¡i cá»§a báº£n xem trÆ°á»›c tá»‡p. HÃ£y xem Ä‘oáº¡n mÃ£ bÃªn dÆ°á»›i Ä‘á»ƒ biáº¿t cÃ¡ch chÃºng ta sá»­ dá»¥ng cÃ¡c tá»‡p nÃ y Ä‘á»ƒ táº£i mÃ´ hÃ¬nh cá»§a mÃ¬nh vÃ  táº¡o hÃ m `predict()`:

```py
from pathlib import Path
import torch
import gradio as gr
from torch import nn

LABELS = Path("class_names.txt").read_text().splitlines()

model = nn.Sequential(
    nn.Conv2d(1, 32, 3, padding="same"),
    nn.ReLU(),
    nn.MaxPool2d(2),
    nn.Conv2d(32, 64, 3, padding="same"),
    nn.ReLU(),
    nn.MaxPool2d(2),
    nn.Conv2d(64, 128, 3, padding="same"),
    nn.ReLU(),
    nn.MaxPool2d(2),
    nn.Flatten(),
    nn.Linear(1152, 256),
    nn.ReLU(),
    nn.Linear(256, len(LABELS)),
)
state_dict = torch.load("pytorch_model.bin", map_location="cpu")
model.load_state_dict(state_dict, strict=False)
model.eval()


def predict(im):
    x = torch.tensor(im, dtype=torch.float32).unsqueeze(0).unsqueeze(0) / 255.0
    with torch.no_grad():
        out = model(x)
    probabilities = torch.nn.functional.softmax(out[0], dim=0)
    values, indices = torch.topk(probabilities, 5)
    return {LABELS[i]: v.item() for i, v in zip(indices, values)}
```

Giá» ta Ä‘Ã£ cÃ³ hÃ m `predict()`. BÆ°á»›c tiáº¿p theo lÃ  Ä‘á»‹nh nghá»‰a vÃ  khá»Ÿi cháº¡y giao diá»‡n gradio:

```py
interface = gr.Interface(
    predict,
    inputs="sketchpad",
    outputs="label",
    theme="huggingface",
    title="Sketch Recognition",
    description="Who wants to play Pictionary? Draw a common object like a shovel or a laptop, and the algorithm will guess in real time!",
    article="<p style='text-align: center'>Sketch Recognition | Demo Model</p>",
    live=True,
)
interface.launch(share=True)
```

<iframe src="https://course-demos-Sketch-Recognition.hf.space" frameBorder="0" height="650" title="Gradio app" class="container p-0 flex-grow space-iframe" allow="accelerometer; ambient-light-sensor; autoplay; battery; camera; document-domain; encrypted-media; fullscreen; geolocation; gyroscope; layout-animations; legacy-image-formats; magnetometer; microphone; midi; oversized-images; payment; picture-in-picture; publickey-credentials-get; sync-xhr; usb; vr ; wake-lock; xr-spatial-tracking" sandbox="allow-forms allow-modals allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-downloads"></iframe>

LÆ°u Ã½ tham sá»‘ `live=True` trong `Interface`, cÃ³ nghÄ©a lÃ  báº£n demo phÃ¡c tháº£o táº¡o ra dá»± Ä‘oÃ¡n má»—i khi ai Ä‘Ã³ váº½ trÃªn sketchpad (khÃ´ng cÃ³ nÃºt gá»­i!).

HÆ¡n ná»¯a, chÃºng ta cÅ©ng Ä‘áº·t tham sá»‘ `share=True` trong phÆ°Æ¡ng thá»©c `launch()`.
Äiá»u nÃ y sáº½ táº¡o ra má»™t liÃªn káº¿t cÃ´ng khai mÃ  báº¡n cÃ³ thá»ƒ
gá»­i cho báº¥t cá»© ai! Khi báº¡n gá»­i liÃªn káº¿t nÃ y, ngÆ°á»i dÃ¹ng á»Ÿ phÃ­a bÃªn kia cÃ³ thá»ƒ thá»­ mÃ´ hÃ¬nh nháº­n dáº¡ng phÃ¡c tháº£o. Äá»ƒ nháº¯c láº¡i, báº¡n cÅ©ng cÃ³ thá»ƒ tá»• chá»©c mÃ´ hÃ¬nh trÃªn Hugging Face Spaces, Ä‘Ã³ lÃ  cÃ¡ch chÃºng ta cÃ³ thá»ƒ nhÃºng báº£n demo á»Ÿ trÃªn.

Tiáº¿p theo, chÃºng tÃ´i sáº½ Ä‘á» cáº­p Ä‘áº¿n cÃ¡c cÃ¡ch khÃ¡c mÃ  Gradio cÃ³ thá»ƒ Ä‘Æ°á»£c sá»­ dá»¥ng vá»›i há»‡ sinh thÃ¡i Hugging Face!
